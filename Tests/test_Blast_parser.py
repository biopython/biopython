# Copyright 2005 by Michiel de Hoon.  All rights reserved.
# This code is part of the Biopython distribution and governed by its
# license.  Please see the LICENSE file that should have been included
# as part of this package.
"""Test the Blast XML parser."""

import os
import unittest

import numpy as np

from Bio import Blast
from Bio.SeqRecord import SeqRecord


class TestBlastp(unittest.TestCase):
    """Test the Blast XML parser for blastp output."""

    def test_xml_2218_blastp_002(self):
        """Parsing BLASTP 2.2.18+ (xml_2218_blastp_002.xml)."""
        filename = "xml_2218_blastp_002.xml"
        datafile = os.path.join("Blast", filename)
        with open(datafile, "rb") as handle:
            records = Blast.parse(handle)
            self.assertEqual(records.program, "blastp")
            self.assertEqual(records.version, "BLASTP 2.2.18+")
            self.assertEqual(
                records.reference,
                'Altschul, Stephen F., Thomas L. Madden, Alejandro A. SchÃ¤ffer, Jinghui Zhang, Zheng Zhang, Webb Miller, and David J. Lipman (1997), "Gapped BLAST and PSI-BLAST: a new generation of protein database search programs", Nucleic Acids Res. 25:3389-3402.',
            )
            self.assertEqual(records.db, "gpipe/9606/Previous/protein")
            self.assertIsInstance(records.query, SeqRecord)
            self.assertEqual(records.query.id, "gi|585505|sp|Q08386|MOPB_RHOCA")
            self.assertEqual(
                records.query.description,
                "Molybdenum-pterin-binding protein mopB >gi|310278|gb|AAA71913.1| molybdenum-pterin-binding protein",
            )
            self.assertEqual(repr(records.query.seq), "Seq(None, length=270)")
            self.assertEqual(len(records.param), 5)
            self.assertEqual(records.param["matrix"], "BLOSUM62")
            self.assertAlmostEqual(records.param["expect"], 0.01)
            self.assertEqual(records.param["gap-open"], 11)
            self.assertEqual(records.param["gap-extend"], 1)
            self.assertEqual(records.param["filter"], "m L; R -d repeat/repeat_9606;")
            record = next(records)
            self.assertIsInstance(record.query, SeqRecord)
            self.assertEqual(record.query.id, "gi|585505|sp|Q08386|MOPB_RHOCA")
            self.assertEqual(
                record.query.description,
                "Molybdenum-pterin-binding protein mopB >gi|310278|gb|AAA71913.1| molybdenum-pterin-binding protein",
            )
            self.assertEqual(repr(record.query.seq), "Seq(None, length=270)")

            self.assertEqual(len(record.stat), 7)
            self.assertEqual(record.stat["db-num"], 27252)
            self.assertEqual(record.stat["db-len"], 13958303)
            self.assertEqual(record.stat["hsp-len"], 0)
            self.assertAlmostEqual(record.stat["eff-space"], 0.0)
            self.assertAlmostEqual(record.stat["kappa"], 0.041)
            self.assertAlmostEqual(record.stat["lambda"], 0.267)
            self.assertAlmostEqual(record.stat["entropy"], 0.14)
            self.assertEqual(len(record), 0)
            record = next(records)
            self.assertIsInstance(record.query, SeqRecord)
            self.assertEqual(record.query.id, "gi|129628|sp|P07175.1|PARA_AGRTU")
            self.assertEqual(record.query.description, "Protein parA")
            self.assertEqual(repr(record.query.seq), "Seq(None, length=222)")

            self.assertEqual(len(record.stat), 7)
            self.assertEqual(record.stat["db-num"], 27252)
            self.assertEqual(record.stat["db-len"], 13958303)
            self.assertEqual(record.stat["hsp-len"], 0)
            self.assertAlmostEqual(record.stat["eff-space"], 0.0)
            self.assertAlmostEqual(record.stat["kappa"], 0.041)
            self.assertAlmostEqual(record.stat["lambda"], 0.267)
            self.assertAlmostEqual(record.stat["entropy"], 0.14)
            self.assertEqual(len(record), 0)

    def test_xml_2218L_blastp_001(self):
        """Parsing blastp 2.2.18 [Mar-02-2008] (xml_2218L_blastp_001.xml)."""
        filename = "xml_2218L_blastp_001.xml"
        datafile = os.path.join("Blast", filename)
        with open(datafile, "rb") as handle:
            records = Blast.parse(handle)
            self.check_xml_2218L_blastp_001_records(records)

        with Blast.parse(datafile) as records:
            self.check_xml_2218L_blastp_001_records(records)

        with open(datafile, "rb") as handle:
            record = Blast.read(handle)
        self.check_xml_2218L_blastp_001_record(record)

        record = Blast.read(datafile)
        self.check_xml_2218L_blastp_001_record(record)

    def check_xml_2218L_blastp_001_records(self, records):
        self.assertEqual(records.program, "blastp")
        self.assertEqual(records.version, "blastp 2.2.18 [Mar-02-2008]")
        self.assertEqual(
            records.reference,
            '~Reference: Altschul, Stephen F., Thomas L. Madden, Alejandro A. Schaffer, ~Jinghui Zhang, Zheng Zhang, Webb Miller, and David J. Lipman (1997), ~"Gapped BLAST and PSI-BLAST: a new generation of protein database search~programs",  Nucleic Acids Res. 25:3389-3402.',
        )
        self.assertEqual(
            records.db, "/Users/pjcock/Downloads/Software/blast-2.2.18/data/nr"
        )
        self.assertIsInstance(records.query, SeqRecord)
        self.assertEqual(records.query.id, "lcl|1_0")
        self.assertEqual(records.query.description, "Fake")
        self.assertEqual(repr(records.query.seq), "Seq(None, length=9)")
        self.assertEqual(len(records.param), 5)
        self.assertEqual(records.param["matrix"], "BLOSUM62")
        self.assertAlmostEqual(records.param["expect"], 1e-05)
        self.assertEqual(records.param["gap-open"], 11)
        self.assertEqual(records.param["gap-extend"], 1)
        self.assertEqual(records.param["filter"], "F")
        record = next(records)
        self.assertRaises(StopIteration, next, records)
        self.check_xml_2218L_blastp_001_record(record)

    def check_xml_2218L_blastp_001_record(self, record):
        self.assertEqual(record.num, 1)
        self.assertIsNone(record.query)
        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 6589360)
        self.assertEqual(record.stat["db-len"], 2253133281)
        self.assertEqual(record.stat["hsp-len"], 0)
        self.assertAlmostEqual(record.stat["eff-space"], 20278200000.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.041)
        self.assertAlmostEqual(record.stat["lambda"], 0.267)
        self.assertAlmostEqual(record.stat["entropy"], 0.14)
        self.assertEqual(len(record), 0)

    def test_xml_2222_blastp_001(self):
        """Parsing BLASTP 2.2.22+ (xml_2222_blastp_001.xml)."""
        filename = "xml_2222_blastp_001.xml"
        datafile = os.path.join("Blast", filename)
        with open(datafile, "rb") as handle:
            records = Blast.parse(handle)
            self.check_xml_2222_blastp_001(records)
        with Blast.parse(datafile) as records:
            self.check_xml_2222_blastp_001(records)

    def check_xml_2222_blastp_001(self, records):
        self.assertEqual(records.program, "blastp")
        self.assertEqual(records.version, "BLASTP 2.2.22+")
        self.assertEqual(
            records.reference,
            'Stephen F. Altschul, Thomas L. Madden, Alejandro A. Sch&auml;ffer, Jinghui Zhang, Zheng Zhang, Webb Miller, and David J. Lipman (1997), "Gapped BLAST and PSI-BLAST: a new generation of protein database search programs", Nucleic Acids Res. 25:3389-3402.',
        )
        self.assertEqual(records.db, "nr")
        self.assertIsInstance(records.query, SeqRecord)
        self.assertEqual(records.query.id, "1")
        self.assertEqual(records.query.description, "gi|3298468|dbj|BAA31520.1| SAMIPF")
        self.assertEqual(repr(records.query.seq), "Seq(None, length=107)")
        self.assertEqual(len(records.param), 5)
        self.assertEqual(records.param["matrix"], "BLOSUM62")
        self.assertAlmostEqual(records.param["expect"], 1e-06)
        self.assertEqual(records.param["gap-open"], 11)
        self.assertEqual(records.param["gap-extend"], 1)
        self.assertEqual(records.param["filter"], "F")
        record = next(records)
        self.assertIsInstance(record.query, SeqRecord)
        self.assertEqual(record.query.id, "1")
        self.assertEqual(record.query.description, "gi|3298468|dbj|BAA31520.1| SAMIPF")
        self.assertEqual(repr(record.query.seq), "Seq(None, length=107)")

        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 8994603)
        self.assertEqual(record.stat["db-len"], -1216159329)
        self.assertEqual(record.stat["hsp-len"], 0)
        self.assertAlmostEqual(record.stat["eff-space"], 76934807744.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.041)
        self.assertAlmostEqual(record.stat["lambda"], 0.267)
        self.assertAlmostEqual(record.stat["entropy"], 0.14)
        self.assertEqual(len(record), 10)
        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|3298468|dbj|BAA31520.1|")
        self.assertEqual(hit.target.name, "BAA31520")
        self.assertEqual(hit.target.description, "SAMIPF [Aster tripolium]")
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=107)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 520.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 204.912011757068)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.77242652875017e-51)
        self.assertEqual(hsp.annotations["identity"], 107)
        self.assertEqual(hsp.annotations["positive"], 107)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 107],
                              [  0, 107]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFS...ANI')",
        )
        self.assertEqual(hsp.query.id, "1")
        self.assertEqual(hsp.query.description, "gi|3298468|dbj|BAA31520.1| SAMIPF")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFS...ANI')",
        )
        self.assertEqual(hsp.target.id, "gi|3298468|dbj|BAA31520.1|")
        self.assertEqual(hsp.target.name, "BAA31520")
        self.assertEqual(hsp.target.description, "SAMIPF [Aster tripolium]")
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVGVTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|329846         0 GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
1                 0 GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG

gi|329846        60 VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI 107
                 60 ||||||||||||||||||||||||||||||||||||||||||||||| 107
1                60 VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI 107
""",
        )
        hit = record[1]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|227434194|gb|ACP28878.1|")
        self.assertEqual(hit.target.name, "ACP28878")
        self.assertEqual(
            hit.target.description, "tonoplast intrinsic protein [Gossypium hirsutum]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=251)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 473.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 186.807631688952)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.63358243494088e-46)
        self.assertEqual(hsp.annotations["identity"], 95)
        self.assertEqual(hsp.annotations["positive"], 101)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 80, 187],
                              [  0, 107]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFS...ANI')",
        )
        self.assertEqual(hsp.query.id, "1")
        self.assertEqual(hsp.query.description, "gi|3298468|dbj|BAA31520.1| SAMIPF")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({80: 'GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSTVACLLLKFATGDLAVPAFG...ANI'}, length=251)",
        )
        self.assertEqual(hsp.target.id, "gi|227434194|gb|ACP28878.1|")
        self.assertEqual(hsp.target.name, "ACP28878")
        self.assertEqual(
            hsp.target.description, "tonoplast intrinsic protein [Gossypium hirsutum]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "GGHVNPAVTFGAFVGGNITLLRGI+Y IAQLLGSTVACLLLKF T D+AV  F LS+GVGV+NALVFEIVMTFGLVYTVYATA+DPKKGSLGTIAP+AIGFIVGANI",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|227434        80 GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSTVACLLLKFATGDLAVPAFGLSSGVG
                  0 ||||||||||||||||||||||||.|.||||||||||||||||.|.|.||..|.||.|||
1                 0 GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG

gi|227434       140 VSNALVFEIVMTFGLVYTVYATAVDPKKGSLGTIAPLAIGFIVGANI 187
                 60 |.|||||||||||||||||||||.||||||||||||.|||||||||| 107
1                60 VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI 107
""",
        )
        hit = record[2]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|223541319|gb|EEF42870.1|")
        self.assertEqual(hit.target.name, "EEF42870")
        self.assertEqual(
            hit.target.description,
            "tonoplast intrinsic protein, putative [Ricinus communis]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=251)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 456.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 180.259238898357)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.44682952949506e-44)
        self.assertEqual(hsp.annotations["identity"], 92)
        self.assertEqual(hsp.annotations["positive"], 97)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 80, 187],
                              [  0, 107]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFS...ANI')",
        )
        self.assertEqual(hsp.query.id, "1")
        self.assertEqual(hsp.query.description, "gi|3298468|dbj|BAA31520.1| SAMIPF")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({80: 'GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSTVACLLLKFSTGGLTTSAFA...ANI'}, length=251)",
        )
        self.assertEqual(hsp.target.id, "gi|223541319|gb|EEF42870.1|")
        self.assertEqual(hsp.target.name, "EEF42870")
        self.assertEqual(
            hsp.target.description,
            "tonoplast intrinsic protein, putative [Ricinus communis]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "GGHVNPAVTFGAFVGGNITLLRGI+Y IAQLLGSTVACLLLKF T  +    F+LS+GVGV NA VFEIVMTFGLVYTVYATA+DPKKGSLGTIAPIAIGFIVGANI",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|223541        80 GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSTVACLLLKFSTGGLTTSAFALSSGVG
                  0 ||||||||||||||||||||||||.|.||||||||||||||||.|.......|.||.|||
1                 0 GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG

gi|223541       140 VWNAFVFEIVMTFGLVYTVYATAVDPKKGSLGTIAPIAIGFIVGANI 187
                 60 |.||.||||||||||||||||||.||||||||||||||||||||||| 107
1                60 VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI 107
""",
        )
        hit = record[3]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|225441155|ref|XP_002267788.1|")
        self.assertEqual(hit.target.name, "XP_002267788")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: hypothetical protein [Vitis vinifera] >gi|157356804|emb|CAO63006.1| unnamed protein product [Vitis vinifera]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=251)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 454.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 179.488839746522)
        self.assertAlmostEqual(hsp.annotations["evalue"], 6.47313235743007e-44)
        self.assertEqual(hsp.annotations["identity"], 93)
        self.assertEqual(hsp.annotations["positive"], 96)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 80, 187],
                              [  0, 107]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFS...ANI')",
        )
        self.assertEqual(hsp.query.id, "1")
        self.assertEqual(hsp.query.description, "gi|3298468|dbj|BAA31520.1| SAMIPF")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({80: 'GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSTVACLLLKFSTNGMTTSAFS...ANI'}, length=251)",
        )
        self.assertEqual(hsp.target.id, "gi|225441155|ref|XP_002267788.1|")
        self.assertEqual(hsp.target.name, "XP_002267788")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: hypothetical protein [Vitis vinifera] >gi|157356804|emb|CAO63006.1| unnamed protein product [Vitis vinifera]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "GGHVNPAVTFGAFVGGNITLLRGI+Y IAQLLGSTVACLLLKF TN M    FSLS+GV V NA VFEIVMTFGLVYTVYATAIDPKKG+LG IAPIAIGFIVGANI",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|225441        80 GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSTVACLLLKFSTNGMTTSAFSLSSGVT
                  0 ||||||||||||||||||||||||.|.||||||||||||||||.||.|....||||.||.
1                 0 GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG

gi|225441       140 VWNAFVFEIVMTFGLVYTVYATAIDPKKGNLGIIAPIAIGFIVGANI 187
                 60 |.||.||||||||||||||||||||||||.||.|||||||||||||| 107
1                60 VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI 107
""",
        )
        hit = record[4]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|209892837|gb|ACI95283.1|")
        self.assertEqual(hit.target.name, "ACI95283")
        self.assertEqual(
            hit.target.description, "tonoplast intrinsic protein [Sinapis arvensis]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=251)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 454.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 179.488839746522)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.21475963444848e-44)
        self.assertEqual(hsp.annotations["identity"], 93)
        self.assertEqual(hsp.annotations["positive"], 97)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 80, 187],
                              [  0, 107]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFS...ANI')",
        )
        self.assertEqual(hsp.query.id, "1")
        self.assertEqual(hsp.query.description, "gi|3298468|dbj|BAA31520.1| SAMIPF")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({80: 'GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSVVACLLLKFATGGLVVPAFG...ANI'}, length=251)",
        )
        self.assertEqual(hsp.target.id, "gi|209892837|gb|ACI95283.1|")
        self.assertEqual(hsp.target.name, "ACI95283")
        self.assertEqual(
            hsp.target.description, "tonoplast intrinsic protein [Sinapis arvensis]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "GGHVNPAVTFGAFVGGNITLLRGI+Y IAQLLGS VACLLLKF T  + V  F LSAGVGV+NALVFEIVMTFGLVYTVYATA+DPK GSLGTIAPIAIGFIVGANI",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|209892        80 GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSVVACLLLKFATGGLVVPAFGLSAGVG
                  0 ||||||||||||||||||||||||.|.|||||||.||||||||.|....|..|.||||||
1                 0 GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG

gi|209892       140 VSNALVFEIVMTFGLVYTVYATAVDPKNGSLGTIAPIAIGFIVGANI 187
                 60 |.|||||||||||||||||||||.|||.||||||||||||||||||| 107
1                60 VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI 107
""",
        )
        hit = record[5]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|21284370|gb|AAB51393.2|")
        self.assertEqual(hit.target.name, "AAB51393")
        self.assertEqual(
            hit.target.description,
            "tonoplast intrinsic protein bobTIP26-1 [Brassica oleracea var. botrytis]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=251)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 454.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 179.488839746522)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.27520962424864e-44)
        self.assertEqual(hsp.annotations["identity"], 93)
        self.assertEqual(hsp.annotations["positive"], 97)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 80, 187],
                              [  0, 107]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFS...ANI')",
        )
        self.assertEqual(hsp.query.id, "1")
        self.assertEqual(hsp.query.description, "gi|3298468|dbj|BAA31520.1| SAMIPF")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({80: 'GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSVVACLLLKFATGGLVVPAFG...ANI'}, length=251)",
        )
        self.assertEqual(hsp.target.id, "gi|21284370|gb|AAB51393.2|")
        self.assertEqual(hsp.target.name, "AAB51393")
        self.assertEqual(
            hsp.target.description,
            "tonoplast intrinsic protein bobTIP26-1 [Brassica oleracea var. botrytis]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "GGHVNPAVTFGAFVGGNITLLRGI+Y IAQLLGS VACLLLKF T  + V  F LSAGVGV+NALVFEIVMTFGLVYTVYATA+DPK GSLGTIAPIAIGFIVGANI",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|212843        80 GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSVVACLLLKFATGGLVVPAFGLSAGVG
                  0 ||||||||||||||||||||||||.|.|||||||.||||||||.|....|..|.||||||
1                 0 GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG

gi|212843       140 VSNALVFEIVMTFGLVYTVYATAVDPKNGSLGTIAPIAIGFIVGANI 187
                 60 |.|||||||||||||||||||||.|||.||||||||||||||||||| 107
1                60 VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI 107
""",
        )
        hit = record[6]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|22858917|gb|AAN05780.1|")
        self.assertEqual(hit.target.name, "AAN05780")
        self.assertEqual(
            hit.target.description,
            "tonoplast intrinsic protein bobTIP26-2 [Brassica oleracea var. botrytis]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=251)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 453.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 179.103640170605)
        self.assertAlmostEqual(hsp.annotations["evalue"], 8.24518074030088e-44)
        self.assertEqual(hsp.annotations["identity"], 93)
        self.assertEqual(hsp.annotations["positive"], 97)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 80, 187],
                              [  0, 107]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFS...ANI')",
        )
        self.assertEqual(hsp.query.id, "1")
        self.assertEqual(hsp.query.description, "gi|3298468|dbj|BAA31520.1| SAMIPF")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({80: 'GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSVVACLLLKFATGGLVVPAFG...ANI'}, length=251)",
        )
        self.assertEqual(hsp.target.id, "gi|22858917|gb|AAN05780.1|")
        self.assertEqual(hsp.target.name, "AAN05780")
        self.assertEqual(
            hsp.target.description,
            "tonoplast intrinsic protein bobTIP26-2 [Brassica oleracea var. botrytis]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "GGHVNPAVTFGAFVGGNITLLRGI+Y IAQLLGS VACLLLKF T  + V  F LSAGVGV+NALVFEIVMTFGLVYTVYATA+DPK GSLGTIAPIAIGFIVGANI",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|228589        80 GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSVVACLLLKFATGGLVVPAFGLSAGVG
                  0 ||||||||||||||||||||||||.|.|||||||.||||||||.|....|..|.||||||
1                 0 GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG

gi|228589       140 VSNALVFEIVMTFGLVYTVYATAVDPKNGSLGTIAPIAIGFIVGANI 187
                 60 |.|||||||||||||||||||||.|||.||||||||||||||||||| 107
1                60 VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI 107
""",
        )
        hit = record[7]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|21284372|gb|AAB51394.2|")
        self.assertEqual(hit.target.name, "AAB51394")
        self.assertEqual(
            hit.target.description,
            "tonoplast intrinsic protein bobTIP26-2 [Brassica oleracea var. botrytis]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=175)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 452.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 178.718440594688)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.26184512406631e-43)
        self.assertEqual(hsp.annotations["identity"], 93)
        self.assertEqual(hsp.annotations["positive"], 97)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  4, 111],
                              [  0, 107]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFS...ANI')",
        )
        self.assertEqual(hsp.query.id, "1")
        self.assertEqual(hsp.query.description, "gi|3298468|dbj|BAA31520.1| SAMIPF")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({4: 'GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSVVACLLLKFATGGLVVPAFG...ANI'}, length=175)",
        )
        self.assertEqual(hsp.target.id, "gi|21284372|gb|AAB51394.2|")
        self.assertEqual(hsp.target.name, "AAB51394")
        self.assertEqual(
            hsp.target.description,
            "tonoplast intrinsic protein bobTIP26-2 [Brassica oleracea var. botrytis]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "GGHVNPAVTFGAFVGGNITLLRGI+Y IAQLLGS VACLLLKF T  + V  F LSAGVGV+NALVFEIVMTFGLVYTVYATA+DPK GSLGTIAPIAIGFIVGANI",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|212843         4 GGHVNPAVTFGAFVGGNITLLRGILYWIAQLLGSVVACLLLKFATGGLVVPAFGLSAGVG
                  0 ||||||||||||||||||||||||.|.|||||||.||||||||.|....|..|.||||||
1                 0 GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG

gi|212843        64 VSNALVFEIVMTFGLVYTVYATAVDPKNGSLGTIAPIAIGFIVGANI 111
                 60 |.|||||||||||||||||||||.|||.||||||||||||||||||| 107
1                60 VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI 107
""",
        )
        hit = record[8]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|38198150|emb|CAE53881.1|")
        self.assertEqual(hit.target.name, "CAE53881")
        self.assertEqual(hit.target.description, "aquaporin [Ricinus communis]")
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=251)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 452.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 178.718440594688)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.39472886444582e-43)
        self.assertEqual(hsp.annotations["identity"], 91)
        self.assertEqual(hsp.annotations["positive"], 96)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 80, 187],
                              [  0, 107]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFS...ANI')",
        )
        self.assertEqual(hsp.query.id, "1")
        self.assertEqual(hsp.query.description, "gi|3298468|dbj|BAA31520.1| SAMIPF")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({80: 'GGHVNPAVTFGAFVGGNITLLRGILYWFAQLLGSTVACLLLKFSTGGLTTSAFA...ANI'}, length=251)",
        )
        self.assertEqual(hsp.target.id, "gi|38198150|emb|CAE53881.1|")
        self.assertEqual(hsp.target.name, "CAE53881")
        self.assertEqual(hsp.target.description, "aquaporin [Ricinus communis]")
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "GGHVNPAVTFGAFVGGNITLLRGI+Y  AQLLGSTVACLLLKF T  +    F+LS+GVGV NA VFEIVMTFGLVYTVYATA+DPKKGSLGTIAPIAIGFIVGANI",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|381981        80 GGHVNPAVTFGAFVGGNITLLRGILYWFAQLLGSTVACLLLKFSTGGLTTSAFALSSGVG
                  0 ||||||||||||||||||||||||.|..|||||||||||||||.|.......|.||.|||
1                 0 GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG

gi|381981       140 VWNAFVFEIVMTFGLVYTVYATAVDPKKGSLGTIAPIAIGFIVGANI 187
                 60 |.||.||||||||||||||||||.||||||||||||||||||||||| 107
1                60 VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI 107
""",
        )
        hit = record[9]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|162809290|dbj|BAF95576.1|")
        self.assertEqual(hit.target.name, "BAF95576")
        self.assertEqual(
            hit.target.description, "tonoplast intrinsic protein [Nicotiana tabacum]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=251)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 450.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 177.948041442853)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.0302699895292e-43)
        self.assertEqual(hsp.annotations["identity"], 91)
        self.assertEqual(hsp.annotations["positive"], 95)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 80, 187],
                              [  0, 107]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFS...ANI')",
        )
        self.assertEqual(hsp.query.id, "1")
        self.assertEqual(hsp.query.description, "gi|3298468|dbj|BAA31520.1| SAMIPF")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({80: 'GGHVNPAVTFGAFVGGNITLFRGILYIIAQLLGSTVACFLLEFATGGMSTGAFA...ANI'}, length=251)",
        )
        self.assertEqual(hsp.target.id, "gi|162809290|dbj|BAF95576.1|")
        self.assertEqual(hsp.target.name, "BAF95576")
        self.assertEqual(
            hsp.target.description, "tonoplast intrinsic protein [Nicotiana tabacum]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "GGHVNPAVTFGAFVGGNITL RGI+YIIAQLLGSTVAC LL+F T  M+ G F+LSAGV V NA VFEIVMTFGLVYTVYATAIDPKKG LG IAPIAIGFIVGANI",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|162809        80 GGHVNPAVTFGAFVGGNITLFRGILYIIAQLLGSTVACFLLEFATGGMSTGAFALSAGVS
                  0 ||||||||||||||||||||.|||.|||||||||||||.||.|.|..|..|.|.|||||.
1                 0 GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG

gi|162809       140 VWNAFVFEIVMTFGLVYTVYATAIDPKKGDLGVIAPIAIGFIVGANI 187
                 60 |.||.||||||||||||||||||||||||.||.|||||||||||||| 107
1                60 VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI 107
""",
        )
        record = next(records)
        self.assertIsInstance(record.query, SeqRecord)
        self.assertEqual(record.query.id, "2")
        self.assertEqual(
            record.query.description,
            "gi|2781234|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(repr(record.query.seq), "Seq(None, length=304)")

        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 8994603)
        self.assertEqual(record.stat["db-len"], -1216159329)
        self.assertEqual(record.stat["hsp-len"], 0)
        self.assertAlmostEqual(record.stat["eff-space"], 315106678978.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.041)
        self.assertAlmostEqual(record.stat["lambda"], 0.267)
        self.assertAlmostEqual(record.stat["entropy"], 0.14)
        self.assertEqual(len(record), 10)
        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|157878523|pdb|1JLX|A")
        self.assertEqual(hit.target.name, "1JLX-A")
        self.assertEqual(
            hit.target.description,
            "Chain A, Agglutinin In Complex With T-Disaccharide >gi|157878524|pdb|1JLX|B Chain B, Agglutinin In Complex With T-Disaccharide >gi|157878525|pdb|1JLY|A Chain A, Crystal Structure Of Amaranthus Caudatus Agglutinin >gi|157878526|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=303)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1638.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 635.565137632669)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.61027401233368e-180)
        self.assertEqual(hsp.annotations["identity"], 303)
        self.assertEqual(hsp.annotations["positive"], 303)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 303],
                              [  1, 304]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 303))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({1: 'AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYD...QNN'}, length=304)",
        )
        self.assertEqual(hsp.query.id, "2")
        self.assertEqual(
            hsp.query.description,
            "gi|2781234|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYD...QNN')",
        )
        self.assertEqual(hsp.target.id, "gi|157878523|pdb|1JLX|A")
        self.assertEqual(hsp.target.name, "1JLX-A")
        self.assertEqual(
            hsp.target.description,
            "Chain A, Agglutinin In Complex With T-Disaccharide >gi|157878524|pdb|1JLX|B Chain B, Agglutinin In Complex With T-Disaccharide >gi|157878525|pdb|1JLY|A Chain A, Crystal Structure Of Amaranthus Caudatus Agglutinin >gi|157878526|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIKSRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHYTQNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKGYVTFKGNNGKYLGVITINQLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDDWILVDGNDPRETNEAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIELGQNN",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|157878         0 AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIK
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                 1 AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIK

gi|157878        60 SRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHY
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                61 SRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHY

gi|157878       120 TQNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKGYVTFKGNNGKYLGVITI
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2               121 TQNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKGYVTFKGNNGKYLGVITI

gi|157878       180 NQLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDDWILVDGNDPRETN
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2               181 NQLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDDWILVDGNDPRETN

gi|157878       240 EAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIELG
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2               241 EAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIELG

gi|157878       300 QNN 303
                300 ||| 303
2               301 QNN 304
""",
        )
        hit = record[1]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|33308026|gb|AAQ03084.1|AF401479_1")
        self.assertEqual(hit.target.name, "AAQ03084")
        self.assertEqual(hit.target.description, "agglutinin [Amaranthus caudatus]")
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=304)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1611.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 625.1647490829)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.12254922203683e-177)
        self.assertEqual(hsp.annotations["identity"], 298)
        self.assertEqual(hsp.annotations["positive"], 300)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  1, 304],
                              [  1, 304]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 303))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({1: 'AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYD...QNN'}, length=304)",
        )
        self.assertEqual(hsp.query.id, "2")
        self.assertEqual(
            hsp.query.description,
            "gi|2781234|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({1: 'AGLPVIMCLKSNNNQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYD...SNN'}, length=304)",
        )
        self.assertEqual(hsp.target.id, "gi|33308026|gb|AAQ03084.1|AF401479_1")
        self.assertEqual(hsp.target.name, "AAQ03084")
        self.assertEqual(hsp.target.description, "agglutinin [Amaranthus caudatus]")
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "AGLPVIMCLKSNN+QKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIKSRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHYTQNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPK YVTFKGNNGKYLGVITINQLPCLQFGYDNLNDPKVAH+MFVTSNGTICIKS YMNKFWRLSTDDWILVDGNDPRETNEAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIELG NN",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|333080         1 AGLPVIMCLKSNNNQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIK
                  0 |||||||||||||.||||||||||||||||||||||||||||||||||||||||||||||
2                 1 AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIK

gi|333080        61 SRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHY
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                61 SRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHY

gi|333080       121 TQNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKRYVTFKGNNGKYLGVITI
                120 ||||||||||||||||||||||||||||||||||||||||||.|||||||||||||||||
2               121 TQNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKGYVTFKGNNGKYLGVITI

gi|333080       181 NQLPCLQFGYDNLNDPKVAHEMFVTSNGTICIKSTYMNKFWRLSTDDWILVDGNDPRETN
                180 ||||||||||||||||||||.|||||||||||||.|||||||||||||||||||||||||
2               181 NQLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDDWILVDGNDPRETN

gi|333080       241 EAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIELG
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2               241 EAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIELG

gi|333080       301 SNN 304
                300 .|| 303
2               301 QNN 304
""",
        )
        hit = record[2]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|37359170|gb|AAL05954.1|")
        self.assertEqual(hit.target.name, "AAL05954")
        self.assertEqual(hit.target.description, "agglutinin [Amaranthus caudatus]")
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=304)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1603.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 622.083152475561)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.66685561532459e-176)
        self.assertEqual(hsp.annotations["identity"], 297)
        self.assertEqual(hsp.annotations["positive"], 299)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  1, 304],
                              [  1, 304]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 303))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({1: 'AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYD...QNN'}, length=304)",
        )
        self.assertEqual(hsp.query.id, "2")
        self.assertEqual(
            hsp.query.description,
            "gi|2781234|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({1: 'AGLPVIMCLKSNNNQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYD...SNN'}, length=304)",
        )
        self.assertEqual(hsp.target.id, "gi|37359170|gb|AAL05954.1|")
        self.assertEqual(hsp.target.name, "AAL05954")
        self.assertEqual(hsp.target.description, "agglutinin [Amaranthus caudatus]")
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "AGLPVIMCLKSNN+QKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIKSRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHYTQNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPK YVTFKGNNGKYLGVITINQLPCLQFGYDNLNDPKVAH+MFVTSNGTICIKS YMNKFWRLSTDDWILVDGNDPRETNEAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEII LG NN",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|373591         1 AGLPVIMCLKSNNNQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIK
                  0 |||||||||||||.||||||||||||||||||||||||||||||||||||||||||||||
2                 1 AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIK

gi|373591        61 SRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHY
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                61 SRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHY

gi|373591       121 TQNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKRYVTFKGNNGKYLGVITI
                120 ||||||||||||||||||||||||||||||||||||||||||.|||||||||||||||||
2               121 TQNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKGYVTFKGNNGKYLGVITI

gi|373591       181 NQLPCLQFGYDNLNDPKVAHEMFVTSNGTICIKSTYMNKFWRLSTDDWILVDGNDPRETN
                180 ||||||||||||||||||||.|||||||||||||.|||||||||||||||||||||||||
2               181 NQLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDDWILVDGNDPRETN

gi|373591       241 EAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIGLG
                240 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||.||
2               241 EAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIELG

gi|373591       301 SNN 304
                300 .|| 303
2               301 QNN 304
""",
        )
        hit = record[3]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|4929263|gb|AAD33922.1|AF143954_1")
        self.assertEqual(hit.target.name, "AAD33922")
        self.assertEqual(
            hit.target.description,
            "agglutinin [Amaranthus hypochondriacus] >gi|15999|emb|CAA77664.1| seed specific protein of balanced nutritional quality [Amaranthus hypochondriacus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=304)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1596.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 619.38675544414)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.10781005546209e-175)
        self.assertEqual(hsp.annotations["identity"], 296)
        self.assertEqual(hsp.annotations["positive"], 299)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  1, 304],
                              [  1, 304]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 303))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({1: 'AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYD...QNN'}, length=304)",
        )
        self.assertEqual(hsp.query.id, "2")
        self.assertEqual(
            hsp.query.description,
            "gi|2781234|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({1: 'AGLPVIMCLKSNNNQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYD...SNN'}, length=304)",
        )
        self.assertEqual(hsp.target.id, "gi|4929263|gb|AAD33922.1|AF143954_1")
        self.assertEqual(hsp.target.name, "AAD33922")
        self.assertEqual(
            hsp.target.description,
            "agglutinin [Amaranthus hypochondriacus] >gi|15999|emb|CAA77664.1| seed specific protein of balanced nutritional quality [Amaranthus hypochondriacus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "AGLPVIMCLKSNN+QKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIKSRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHYT+NYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPK YVTFKGNNGKYLGVITINQLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTD+WILVDGNDPRETNEAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKP FINCMNAATQ VDETAILEIIELG NN",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|492926         1 AGLPVIMCLKSNNNQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIK
                  0 |||||||||||||.||||||||||||||||||||||||||||||||||||||||||||||
2                 1 AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIK

gi|492926        61 SRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHY
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                61 SRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHY

gi|492926       121 TENYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKTYVTFKGNNGKYLGVITI
                120 |.||||||||||||||||||||||||||||||||||||||||.|||||||||||||||||
2               121 TQNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKGYVTFKGNNGKYLGVITI

gi|492926       181 NQLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDNWILVDGNDPRETN
                180 ||||||||||||||||||||||||||||||||||||||||||||||.|||||||||||||
2               181 NQLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDDWILVDGNDPRETN

gi|492926       241 EAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPEFINCMNAATQIVDETAILEIIELG
                240 |||||||||||||||||||||||||||||||||||.||||||||||.|||||||||||||
2               241 EAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIELG

gi|492926       301 SNN 304
                300 .|| 303
2               301 QNN 304
""",
        )
        hit = record[4]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|20067185|gb|AAM09540.1|AF491291_1")
        self.assertEqual(hit.target.name, "AAM09540")
        self.assertEqual(
            hit.target.description, "seed protein AmA1 [Amaranthus hypochondriacus]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=304)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1592.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 617.84595714047)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.27747281942883e-175)
        self.assertEqual(hsp.annotations["identity"], 295)
        self.assertEqual(hsp.annotations["positive"], 299)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  1, 304],
                              [  1, 304]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 303))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({1: 'AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYD...QNN'}, length=304)",
        )
        self.assertEqual(hsp.query.id, "2")
        self.assertEqual(
            hsp.query.description,
            "gi|2781234|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({1: 'AGLPVIMCLKSNNNQEYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYD...SNN'}, length=304)",
        )
        self.assertEqual(hsp.target.id, "gi|20067185|gb|AAM09540.1|AF491291_1")
        self.assertEqual(hsp.target.name, "AAM09540")
        self.assertEqual(
            hsp.target.description, "seed protein AmA1 [Amaranthus hypochondriacus]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "AGLPVIMCLKSNN+Q+YLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIKSRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHYT+NYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPK YVTFKGNNGKYLGVITINQLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTD+WILVDGNDPRETNEAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKP FINCMNAATQ VDETAILEIIELG NN",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|200671         1 AGLPVIMCLKSNNNQEYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIK
                  0 |||||||||||||.|.||||||||||||||||||||||||||||||||||||||||||||
2                 1 AGLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIK

gi|200671        61 SRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHY
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                61 SRYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHY

gi|200671       121 TENYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKTYVTFKGNNGKYLGVITI
                120 |.||||||||||||||||||||||||||||||||||||||||.|||||||||||||||||
2               121 TQNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKGYVTFKGNNGKYLGVITI

gi|200671       181 NQLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDNWILVDGNDPRETN
                180 ||||||||||||||||||||||||||||||||||||||||||||||.|||||||||||||
2               181 NQLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDDWILVDGNDPRETN

gi|200671       241 EAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPEFINCMNAATQIVDETAILEIIELG
                240 |||||||||||||||||||||||||||||||||||.||||||||||.|||||||||||||
2               241 EAAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIELG

gi|200671       301 SNN 304
                300 .|| 303
2               301 QNN 304
""",
        )
        hit = record[5]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|225465425|ref|XP_002264858.1|")
        self.assertEqual(hit.target.name, "XP_002264858")
        self.assertEqual(
            hit.target.description, "PREDICTED: hypothetical protein [Vitis vinifera]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=465)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 623.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 244.587568076555)
        self.assertAlmostEqual(hsp.annotations["evalue"], 6.71087757255643e-63)
        self.assertEqual(hsp.annotations["identity"], 126)
        self.assertEqual(hsp.annotations["positive"], 187)
        self.assertEqual(hsp.annotations["gaps"], 6)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  1, 102, 102, 161, 161, 223, 223, 233, 233, 268, 268, 293],
                              [  2, 103, 104, 163, 164, 226, 227, 237, 238, 273, 275, 300]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 298))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({2: 'GLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDG...IEL'}, length=304)",
        )
        self.assertEqual(hsp.query.id, "2")
        self.assertEqual(
            hsp.query.description,
            "gi|2781234|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({1: 'ALPRYVVLKSKYNNKYLRYIHEDVQIHGFLQFSGEEVVTPYSKYQVERAKNGGG...AEL'}, length=465)",
        )
        self.assertEqual(hsp.target.id, "gi|225465425|ref|XP_002264858.1|")
        self.assertEqual(hsp.target.name, "XP_002264858")
        self.assertEqual(
            hsp.target.description, "PREDICTED: hypothetical protein [Vitis vinifera]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            " LP  + LKS  + KYLRY  +++Q +G LQFS ++++ P ++++VE +K   GLVHI+  Y NKY VRWS NH+WI A A+EPDE++S+W+CTLF+P++V +G+ + +R  HVQLGHY   + +   + S LFA S+  D    DV  +IDW+S+   PK ++ FKG+NG YL    I   P L+F   ++ DP V +++F T +G++ IKS+Y  +FWR S  +WI  D +D   TN +  LF     D NV++L N+    F KR T+   G  +C+NAA   +   A LE+ EL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|225465         1 ALPRYVVLKSKYNNKYLRYIHEDVQIHGFLQFSGEEVVTPYSKYQVERAKNGGGLVHIRC
                  0 .||....|||....|||||.....|..|.||||......|.....||..|...|||||..
2                 2 GLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIKS

gi|225465        61 CYNNKYWVRWSKNHWWIVAGADEPDEDQSSWSCTLFEPVHV-DGDAQTLRFRHVQLGHYA
                 60 .|.|||.||||.||.||.|.|.||||..|.|.||||.|..|-.|.....|..|||||||.
2                62 RYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHYT

gi|225465       120 CLWRLPPPYGSCLFAGSTSADNDLCDVCTIIDWESLLILPK-HIAFKGDNGHYLSARKIE
                120 ..........|.|||.|...|....||...|||.|....||-...|||.||.||....|.
2               122 QNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKGYVTFKGNNGKYLGVITIN

gi|225465       179 GHPYLEFASSDIGDPTVGNEVFTTHDGSVRIKSDYFGRFWRRSP-NWIWADSDDS-TTNN
                180 ..|.|.|......||.|....|.|..|...|||.|...|||.|.-.||..|..|.-.||.
2               182 QLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDDWILVDGNDPRETNE

gi|225465       237 SDTLFWPVRVDNNVVALRNLGNNNFCKRLTT--EGKTSCLNAAVSTISREARLEVAEL
                240 ...||.....|.||..|.|.....|.||.|.--.|...|.|||.......|.||..||
2               242 AAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIEL

gi|225465       293
                298
2               300
""",
        )
        hit = record[6]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|225465427|ref|XP_002264911.1|")
        self.assertEqual(hit.target.name, "XP_002264911")
        self.assertEqual(
            hit.target.description, "PREDICTED: hypothetical protein [Vitis vinifera]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=465)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 620.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 243.431969348803)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.66631297328129e-62)
        self.assertEqual(hsp.annotations["identity"], 126)
        self.assertEqual(hsp.annotations["positive"], 187)
        self.assertEqual(hsp.annotations["gaps"], 6)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  1, 102, 102, 161, 161, 223, 223, 232, 232, 268, 268, 293],
                              [  2, 103, 104, 163, 164, 226, 227, 236, 237, 273, 275, 300]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 298))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({2: 'GLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDG...IEL'}, length=304)",
        )
        self.assertEqual(hsp.query.id, "2")
        self.assertEqual(
            hsp.query.description,
            "gi|2781234|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({1: 'ALPRYVVLKSKYNNKYLRYIHEDVQIHGFLQFSGEEVVTPYSKYQVEMAKNGKG...AEL'}, length=465)",
        )
        self.assertEqual(hsp.target.id, "gi|225465427|ref|XP_002264911.1|")
        self.assertEqual(hsp.target.name, "XP_002264911")
        self.assertEqual(
            hsp.target.description, "PREDICTED: hypothetical protein [Vitis vinifera]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            " LP  + LKS  + KYLRY  +++Q +G LQFS ++++ P ++++VE +K   GLVHI+  Y NKY VRWS NH+WI A A+EPDE++S+W+CTLF+P+YV +G+ + ++  HVQLGHY   + +   + S LFA S+  D    DV  +IDW+S+   PK ++ FKG+NG +L   TI   P L+F   ++ DP V +++F T +G++ IKS+Y  +FWR S  +WI  D +D   TN    LF     D NV++L N+    F KR T+   G I+C+NA    +   A LE+ EL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|225465         1 ALPRYVVLKSKYNNKYLRYIHEDVQIHGFLQFSGEEVVTPYSKYQVEMAKNGKGLVHIRC
                  0 .||....|||....|||||.....|..|.||||......|.....||..|...|||||..
2                 2 GLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIKS

gi|225465        61 CYNNKYWVRWSKNHWWIVAGADEPDEDQSSWSCTLFEPVYV-DGDAQTLQFRHVQLGHYA
                 60 .|.|||.||||.||.||.|.|.||||..|.|.||||.|.||-.|........|||||||.
2                62 RYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHYT

gi|225465       120 CLWRLPPPYGSCLFAGSTSPDNDLCDVCTIIDWESLLLLPK-HIAFKGDNGYFLSARTIE
                120 ..........|.|||.|...|....||...|||.|....||-...|||.||..|...||.
2               122 QNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKGYVTFKGNNGKYLGVITIN

gi|225465       179 GHPYLEFASSDIGDPTVGNEVFTTHDGSVHIKSDYFGRFWRRSP-NWIWADSDD-STTNN
                180 ..|.|.|......||.|....|.|..|...|||.|...|||.|.-.||..|..|-..||.
2               182 QLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDDWILVDGNDPRETNE

gi|225465       237 PDTLFWPVRVDKNVVALRNLGNNNFCKRLTT--EGKISCLNAGVSTISREARLEVAEL
                240 ...||.....|.||..|.|.....|.||.|.--.|.|.|.||........|.||..||
2               242 AAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIEL

gi|225465       293
                298
2               300
""",
        )
        hit = record[7]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|147838248|emb|CAN71829.1|")
        self.assertEqual(hit.target.name, "CAN71829")
        self.assertEqual(
            hit.target.description, "hypothetical protein [Vitis vinifera]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=468)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 606.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 238.03917528596)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.00082705100501e-61)
        self.assertEqual(hsp.annotations["identity"], 124)
        self.assertEqual(hsp.annotations["positive"], 181)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  2, 102, 102, 161, 161, 234, 234, 269, 269, 294],
                              [  3, 103, 104, 163, 164, 237, 238, 273, 275, 300]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 297))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({3: 'LPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGL...IEL'}, length=304)",
        )
        self.assertEqual(hsp.query.id, "2")
        self.assertEqual(
            hsp.query.description,
            "gi|2781234|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({2: 'LPRYVVFKSKYNNKXLRYIHEDGEIHGFLQFSGEEVMTPYSKYHVEMAKNGKGL...AEL'}, length=468)",
        )
        self.assertEqual(hsp.target.id, "gi|147838248|emb|CAN71829.1|")
        self.assertEqual(hsp.target.name, "CAN71829")
        self.assertEqual(
            hsp.target.description, "hypothetical protein [Vitis vinifera]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "LP  +  KS  + K LRY  ++ + +G LQFS ++++ P +++ VE +K   GLVHI+  Y NKY VRWS NH+WI A A+E DE++S W CTLF+P+YV +G+ + +R  HVQLGHY   + +   + S LFA S+  D    DVF +IDW+S+   PK ++ FKG+N  YL   TI   P L+F   ++ DP V +++F T +G+  IKS+Y  +FWR S+ +WIL D +D   TN +  LF     D NV++L N+    F KR T+   G  +C+NA    +   A LE+ EL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|147838         2 LPRYVVFKSKYNNKXLRYIHEDGEIHGFLQFSGEEVMTPYSKYHVEMAKNGKGLVHIRCC
                  0 ||.....||....|.|||........|.||||......|.....||..|...|||||...
2                 3 LPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIKSR

gi|147838        62 YNNKYWVRWSENHWWIVAGADETDEDQSLWTCTLFEPVYV-DGDAQTLRFRHVQLGHYAC
                 60 |.|||.||||.||.||.|.|.|.||..|.|.||||.|.||-.|.....|..|||||||..
2                63 YTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHYTQ

gi|147838       121 LWRLPPPYGSCLFAGSASPDKDLYDVFTIIDWESLLILPK-HIAFKGDNDYYLSARTIEG
                120 .........|.|||.|...|....|||..|||.|....||-...|||.|..||...||..
2               123 NYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKGYVTFKGNNGKYLGVITINQ

gi|147838       180 RPYLEFASTDIGDPTVGNEVFTTQDGSARIKSDYFGRFWRRSSPNWILADSDDS-TTNNS
                180 .|.|.|......||.|....|.|..|...|||.|...|||.|...|||.|..|.-.||..
2               183 LPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDDWILVDGNDPRETNEA

gi|147838       239 NTLFWPVRVDKNVVALRNLGNNNFCKRLTT--EGKTSCLNAGVSTISREARLEVAEL 294
                240 ..||.....|.||..|.|.....|.||.|.--.|...|.||........|.||..|| 297
2               243 AALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIEL 300
""",
        )
        hit = record[8]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|225465417|ref|XP_002264098.1|")
        self.assertEqual(hit.target.name, "XP_002264098")
        self.assertEqual(
            hit.target.description, "PREDICTED: hypothetical protein [Vitis vinifera]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=465)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 602.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 236.498376982291)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.30850343103547e-60)
        self.assertEqual(hsp.annotations["identity"], 124)
        self.assertEqual(hsp.annotations["positive"], 184)
        self.assertEqual(hsp.annotations["gaps"], 6)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  1, 102, 102, 161, 161, 223, 223, 233, 233, 268, 268, 293],
                              [  2, 103, 104, 163, 164, 226, 227, 237, 238, 273, 275, 300]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 298))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({2: 'GLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDG...IEL'}, length=304)",
        )
        self.assertEqual(hsp.query.id, "2")
        self.assertEqual(
            hsp.query.description,
            "gi|2781234|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({1: 'ALPRYVVLKSKYNDKYLRYIHEDVQIHGFLQFSGEEVVTPYSKYQVERAKNGKG...AEL'}, length=465)",
        )
        self.assertEqual(hsp.target.id, "gi|225465417|ref|XP_002264098.1|")
        self.assertEqual(hsp.target.name, "XP_002264098")
        self.assertEqual(
            hsp.target.description, "PREDICTED: hypothetical protein [Vitis vinifera]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            " LP  + LKS  + KYLRY  +++Q +G LQFS ++++ P ++++VE +K   GLVHI+  Y NKY VRWS NH+WI A A+EPDE++S+W+CTLF+P++V +GN + +R  HVQLGHY   + +   + S LFA S+  +    DV  +IDW+S+   PK +V FKG+NG YL   TI   P L+F   ++ DP V +++F T + ++ IKS++  +FWR S  +WI  D +D   TN +  LF     D NV++L N     F  R T+   G  +C+NA    +   A LE+ EL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|225465         1 ALPRYVVLKSKYNDKYLRYIHEDVQIHGFLQFSGEEVVTPYSKYQVERAKNGKGLVHIRC
                  0 .||....|||....|||||.....|..|.||||......|.....||..|...|||||..
2                 2 GLPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIKS

gi|225465        61 CYNNKYWVRWSKNHWWIVAGADEPDEDQSSWSCTLFEPVHV-DGNAQTLRFRHVQLGHYA
                 60 .|.|||.||||.||.||.|.|.||||..|.|.||||.|..|-.||....|..|||||||.
2                62 RYTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHYT

gi|225465       120 CLWRLPPPYGSCLFAGSASPNKDLCDVCTIIDWESLLILPK-HVAFKGDNGNYLSARTIE
                120 ..........|.|||.|........||...|||.|....||-.|.|||.||.||...||.
2               122 QNYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKGYVTFKGNNGKYLGVITIN

gi|225465       179 GHPYLEFASSDIGDPTVGNEVFTTHDRSVRIKSHHFGRFWRRSP-NWIWADSDDS-TTNN
                180 ..|.|.|......||.|....|.|......|||.....|||.|.-.||..|..|.-.||.
2               182 QLPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDDWILVDGNDPRETNE

gi|225465       237 SDTLFWPVRVDKNVVALRNFGNNNFCMRLTT--EGKTSCLNAGVSTISREARLEVAEL
                240 ...||.....|.||..|.|.....|..|.|.--.|...|.||........|.||..||
2               242 AAALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIEL

gi|225465       293
                298
2               300
""",
        )
        hit = record[9]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|225465423|ref|XP_002264775.1|")
        self.assertEqual(hit.target.name, "XP_002264775")
        self.assertEqual(
            hit.target.description, "PREDICTED: hypothetical protein [Vitis vinifera]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=467)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 587.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 230.72038334353)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.14603053551379e-58)
        self.assertEqual(hsp.annotations["identity"], 123)
        self.assertEqual(hsp.annotations["positive"], 179)
        self.assertEqual(hsp.annotations["gaps"], 6)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  2, 102, 102, 161, 161, 223, 223, 233, 233, 268, 268, 293],
                              [  3, 103, 104, 163, 164, 226, 227, 237, 238, 273, 275, 300]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 297))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({3: 'LPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGL...IEL'}, length=304)",
        )
        self.assertEqual(hsp.query.id, "2")
        self.assertEqual(
            hsp.query.description,
            "gi|2781234|pdb|1JLY|B Chain B, Crystal Structure Of Amaranthus Caudatus Agglutinin",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({2: 'LPRYVVFKSKYNNKCLRYIHEDGEIHGFLQFSGEEVMTPYSKYHVEMAKNGKGL...AEL'}, length=467)",
        )
        self.assertEqual(hsp.target.id, "gi|225465423|ref|XP_002264775.1|")
        self.assertEqual(hsp.target.name, "XP_002264775")
        self.assertEqual(
            hsp.target.description, "PREDICTED: hypothetical protein [Vitis vinifera]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "LP  +  KS  + K LRY  ++ + +G LQFS ++++ P +++ VE +K   GLVHI+  Y NKY VRWS NH+WI A A+E DE++S W CTLF+P+YV +G+ + +R  HVQLGHY   + +   + S LFA S+  D    DVF +IDW+S+   PK ++ FKG+N  YL   TI   P L+F   ++ DP V +++F T +G+  IKS+Y  +FWR S  +WIL D +D    N +  LF     D NV++L N+    F KR T+   G  +C+NA    +   A LE+ EL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|225465         2 LPRYVVFKSKYNNKCLRYIHEDGEIHGFLQFSGEEVMTPYSKYHVEMAKNGKGLVHIRCC
                  0 ||.....||....|.|||........|.||||......|.....||..|...|||||...
2                 3 LPVIMCLKSNNHQKYLRYQSDNIQQYGLLQFSADKILDPLAQFEVEPSKTYDGLVHIKSR

gi|225465        62 YNNKYWVRWSENHWWIVAGADETDEDQSLWTCTLFEPVYV-DGDAQTLRFRHVQLGHYAC
                 60 |.|||.||||.||.||.|.|.|.||..|.|.||||.|.||-.|.....|..|||||||..
2                63 YTNKYLVRWSPNHYWITASANEPDENKSNWACTLFKPLYVEEGNMKKVRLLHVQLGHYTQ

gi|225465       121 LWRLPPPYGSCLFAGSASPDKDLYDVFTIIDWESLLILPK-HIAFKGDNDYYLSARTIEG
                120 .........|.|||.|...|....|||..|||.|....||-...|||.|..||...||..
2               123 NYTVGGSFVSYLFAESSQIDTGSKDVFHVIDWKSIFQFPKGYVTFKGNNGKYLGVITINQ

gi|225465       180 RPYLEFASTDIGDPTVGNEVFTTQDGSARIKSDYFGRFWRRSP-NWILADSDDS-TNNNS
                180 .|.|.|......||.|....|.|..|...|||.|...|||.|.-.|||.|..|.-..|..
2               183 LPCLQFGYDNLNDPKVAHQMFVTSNGTICIKSNYMNKFWRLSTDDWILVDGNDPRETNEA

gi|225465       238 NTLFWPVRVDKNVVALRNLGNNNFCKRLTT--EGKTSCLNAGVSTISREARLEVAEL 293
                240 ..||.....|.||..|.|.....|.||.|.--.|...|.||........|.||..|| 297
2               243 AALFRSDVHDFNVISLLNMQKTWFIKRFTSGKPGFINCMNAATQNVDETAILEIIEL 300
""",
        )
        record = next(records)
        self.assertIsInstance(record.query, SeqRecord)
        self.assertEqual(record.query.id, "3")
        self.assertEqual(
            record.query.description,
            "gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein",
        )
        self.assertEqual(repr(record.query.seq), "Seq(None, length=600)")

        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 8994603)
        self.assertEqual(record.stat["db-len"], -1216159329)
        self.assertEqual(record.stat["hsp-len"], 0)
        self.assertAlmostEqual(record.stat["eff-space"], 825121048178.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.041)
        self.assertAlmostEqual(record.stat["lambda"], 0.267)
        self.assertAlmostEqual(record.stat["entropy"], 0.14)
        self.assertEqual(len(record), 10)
        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|13124535|sp|Q9WTV7.1|RNF12_MOUSE")
        self.assertEqual(hit.target.name, "Q9WTV7")
        self.assertEqual(
            hit.target.description,
            "RecName: Full=E3 ubiquitin-protein ligase RNF12; AltName: Full=RING finger protein 12; AltName: Full=LIM domain-interacting RING finger protein; AltName: Full=RING finger LIM domain-binding protein; Short=R-LIM >gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein [Mus musculus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=600)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3103.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1199.88251635159)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 600)
        self.assertEqual(hsp.annotations["positive"], 600)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 600],
                              [  0, 600]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 600))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.query.id, "3")
        self.assertEqual(
            hsp.query.description,
            "gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.target.id, "gi|13124535|sp|Q9WTV7.1|RNF12_MOUSE")
        self.assertEqual(hsp.target.name, "Q9WTV7")
        self.assertEqual(
            hsp.target.description,
            "RecName: Full=E3 ubiquitin-protein ligase RNF12; AltName: Full=RING finger protein 12; AltName: Full=LIM domain-interacting RING finger protein; AltName: Full=RING finger LIM domain-binding protein; Short=R-LIM >gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein [Mus musculus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTEEELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSRQRGNQSWRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSASESASARPSRAERNSTEAVTEVPTTRAQRRARSRSPEHRRTRARAERSMSPLQPTSEIPRRAPTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNSESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESERGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSEPSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSKMFEGSSEGGSSGPSRKDGRHRAPVTFDESGSLPFFSLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGENDALKTCSVCITEYTEGDKLRKLPCSHEFHVHCIDRWLSENSTCPICRRAVLSSGNRESVV",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|131245         0 MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3                 0 MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTE

gi|131245        60 EELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSRQRGNQS
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3                60 EELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSRQRGNQS

gi|131245       120 WRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSAS
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               120 WRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSAS

gi|131245       180 ESASARPSRAERNSTEAVTEVPTTRAQRRARSRSPEHRRTRARAERSMSPLQPTSEIPRR
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               180 ESASARPSRAERNSTEAVTEVPTTRAQRRARSRSPEHRRTRARAERSMSPLQPTSEIPRR

gi|131245       240 APTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNS
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               240 APTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNS

gi|131245       300 ESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESERGGFRRTF
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               300 ESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESERGGFRRTF

gi|131245       360 SRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSE
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               360 SRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSE

gi|131245       420 PSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSKMFEGSSEGGS
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               420 PSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSKMFEGSSEGGS

gi|131245       480 SGPSRKDGRHRAPVTFDESGSLPFFSLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGEN
                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               480 SGPSRKDGRHRAPVTFDESGSLPFFSLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGEN

gi|131245       540 DALKTCSVCITEYTEGDKLRKLPCSHEFHVHCIDRWLSENSTCPICRRAVLSSGNRESVV
                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               540 DALKTCSVCITEYTEGDKLRKLPCSHEFHVHCIDRWLSENSTCPICRRAVLSSGNRESVV

gi|131245       600 
                600 
3               600 
""",
        )
        hit = record[1]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|47078289|ref|NP_035406.3|")
        self.assertEqual(hit.target.name, "NP_035406")
        self.assertEqual(
            hit.target.description,
            "ring finger protein, LIM domain interacting [Mus musculus] >gi|15277964|gb|AAH12960.1| Ring finger protein, LIM domain interacting [Mus musculus] >gi|123229168|emb|CAM26768.1| ring finger protein 12 [Mus musculus] >gi|148682142|gb|EDL14089.1| ring finger protein 12, isoform CRA_a [Mus musculus] >gi|148682143|gb|EDL14090.1| ring finger protein 12, isoform CRA_a [Mus musculus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=600)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3058.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1182.54853543531)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 592)
        self.assertEqual(hsp.annotations["positive"], 596)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 600],
                              [  0, 600]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 600))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.query.id, "3")
        self.assertEqual(
            hsp.query.description,
            "gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.target.id, "gi|47078289|ref|NP_035406.3|")
        self.assertEqual(hsp.target.name, "NP_035406")
        self.assertEqual(
            hsp.target.description,
            "ring finger protein, LIM domain interacting [Mus musculus] >gi|15277964|gb|AAH12960.1| Ring finger protein, LIM domain interacting [Mus musculus] >gi|123229168|emb|CAM26768.1| ring finger protein 12 [Mus musculus] >gi|148682142|gb|EDL14089.1| ring finger protein 12, isoform CRA_a [Mus musculus] >gi|148682143|gb|EDL14090.1| ring finger protein 12, isoform CRA_a [Mus musculus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTEEELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRS QRGNQSWRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSASESASARPSRAERNS EAVTEVPTTRAQRRARSRSPEHRRTRARAERS SPLQPTSEIPRRAPTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNSESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESERGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSEPSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSS+MFEGSSEGGSSGPSR+DGRHRAPVTFDESGSLPF SLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGENDALKTCSVCITEYTEG+KLRKLPCSHE+HVHCIDRWLSENSTCPICRRAVLSSGNRESVV",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|470782         0 MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3                 0 MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTE

gi|470782        60 EELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSGQRGNQS
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||.||||||
3                60 EELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSRQRGNQS

gi|470782       120 WRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSAS
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               120 WRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSAS

gi|470782       180 ESASARPSRAERNSAEAVTEVPTTRAQRRARSRSPEHRRTRARAERSRSPLQPTSEIPRR
                180 ||||||||||||||.||||||||||||||||||||||||||||||||.||||||||||||
3               180 ESASARPSRAERNSTEAVTEVPTTRAQRRARSRSPEHRRTRARAERSMSPLQPTSEIPRR

gi|470782       240 APTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNS
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               240 APTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNS

gi|470782       300 ESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESERGGFRRTF
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               300 ESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESERGGFRRTF

gi|470782       360 SRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSE
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               360 SRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSE

gi|470782       420 PSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSEMFEGSSEGGS
                420 |||||||||||||||||||||||||||||||||||||||||||||||||.||||||||||
3               420 PSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSKMFEGSSEGGS

gi|470782       480 SGPSRRDGRHRAPVTFDESGSLPFLSLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGEN
                480 |||||.||||||||||||||||||.|||||||||||||||||||||||||||||||||||
3               480 SGPSRKDGRHRAPVTFDESGSLPFFSLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGEN

gi|470782       540 DALKTCSVCITEYTEGNKLRKLPCSHEYHVHCIDRWLSENSTCPICRRAVLSSGNRESVV
                540 ||||||||||||||||.||||||||||.||||||||||||||||||||||||||||||||
3               540 DALKTCSVCITEYTEGDKLRKLPCSHEFHVHCIDRWLSENSTCPICRRAVLSSGNRESVV

gi|470782       600 
                600 
3               600 
""",
        )
        hit = record[2]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|12850423|dbj|BAB28712.1|")
        self.assertEqual(hit.target.name, "BAB28712")
        self.assertEqual(
            hit.target.description, "unnamed protein product [Mus musculus]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=600)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3054.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1181.00773713164)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 591)
        self.assertEqual(hsp.annotations["positive"], 595)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 600],
                              [  0, 600]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 600))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.query.id, "3")
        self.assertEqual(
            hsp.query.description,
            "gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.target.id, "gi|12850423|dbj|BAB28712.1|")
        self.assertEqual(hsp.target.name, "BAB28712")
        self.assertEqual(
            hsp.target.description, "unnamed protein product [Mus musculus]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTEEELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRS QRGNQSWRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSASESASARPSRAERNS EAVTEVPTTRAQRRARSRSPEHRRTRARAERS SPLQPTSEIPRRAPTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNSESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESERGGFRRTFS SERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSEPSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSS+MFEGSSEGGSSGPSR+DGRHRAPVTFDESGSLPF SLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGENDALKTCSVCITEYTEG+KLRKLPCSHE+HVHCIDRWLSENSTCPICRRAVLSSGNRESVV",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|128504         0 MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3                 0 MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTE

gi|128504        60 EELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSGQRGNQS
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||.||||||
3                60 EELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSRQRGNQS

gi|128504       120 WRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSAS
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               120 WRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSAS

gi|128504       180 ESASARPSRAERNSAEAVTEVPTTRAQRRARSRSPEHRRTRARAERSRSPLQPTSEIPRR
                180 ||||||||||||||.||||||||||||||||||||||||||||||||.||||||||||||
3               180 ESASARPSRAERNSTEAVTEVPTTRAQRRARSRSPEHRRTRARAERSMSPLQPTSEIPRR

gi|128504       240 APTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNS
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               240 APTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNS

gi|128504       300 ESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESERGGFRRTF
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               300 ESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESERGGFRRTF

gi|128504       360 SSSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSE
                360 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               360 SRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSE

gi|128504       420 PSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSEMFEGSSEGGS
                420 |||||||||||||||||||||||||||||||||||||||||||||||||.||||||||||
3               420 PSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSKMFEGSSEGGS

gi|128504       480 SGPSRRDGRHRAPVTFDESGSLPFLSLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGEN
                480 |||||.||||||||||||||||||.|||||||||||||||||||||||||||||||||||
3               480 SGPSRKDGRHRAPVTFDESGSLPFFSLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGEN

gi|128504       540 DALKTCSVCITEYTEGNKLRKLPCSHEYHVHCIDRWLSENSTCPICRRAVLSSGNRESVV
                540 ||||||||||||||||.||||||||||.||||||||||||||||||||||||||||||||
3               540 DALKTCSVCITEYTEGDKLRKLPCSHEFHVHCIDRWLSENSTCPICRRAVLSSGNRESVV

gi|128504       600 
                600 
3               600 
""",
        )
        hit = record[3]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|26325250|dbj|BAC26379.1|")
        self.assertEqual(hit.target.name, "BAC26379")
        self.assertEqual(
            hit.target.description, "unnamed protein product [Mus musculus]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=600)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3047.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1178.31134010022)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 590)
        self.assertEqual(hsp.annotations["positive"], 595)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 600],
                              [  0, 600]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 600))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.query.id, "3")
        self.assertEqual(
            hsp.query.description,
            "gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.target.id, "gi|26325250|dbj|BAC26379.1|")
        self.assertEqual(hsp.target.name, "BAC26379")
        self.assertEqual(
            hsp.target.description, "unnamed protein product [Mus musculus]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTEEELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRS QRGNQSWRAVSRTNPNSGDFRFSLEINVNRN+GSQTSENESEPSTRRLSVENMESSSQRQMENSASESASARPSRAERNS EAVTEVPTTRAQRRARSRSPEHRRTRARAERS SPLQPTSEIPRRAPTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNSESSGSGQRPPTIVLDLQVR VRPGEYRQRDSIASRTRSRSQAPNNTVTYESERGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSEPSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSS+MFEGSSEGGSSGPSR+DGRHRAPVTFDESGSLPF SLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGENDALKTCSVCITEYTEG+KLRKLPCSHE+HVHCIDRWLSENSTCPICRRAVLSSGNRESVV",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|263252         0 MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3                 0 MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTE

gi|263252        60 EELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSGQRGNQS
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||.||||||
3                60 EELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSRQRGNQS

gi|263252       120 WRAVSRTNPNSGDFRFSLEINVNRNSGSQTSENESEPSTRRLSVENMESSSQRQMENSAS
                120 |||||||||||||||||||||||||.||||||||||||||||||||||||||||||||||
3               120 WRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSAS

gi|263252       180 ESASARPSRAERNSAEAVTEVPTTRAQRRARSRSPEHRRTRARAERSRSPLQPTSEIPRR
                180 ||||||||||||||.||||||||||||||||||||||||||||||||.||||||||||||
3               180 ESASARPSRAERNSTEAVTEVPTTRAQRRARSRSPEHRRTRARAERSMSPLQPTSEIPRR

gi|263252       240 APTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNS
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               240 APTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNS

gi|263252       300 ESSGSGQRPPTIVLDLQVRGVRPGEYRQRDSIASRTRSRSQAPNNTVTYESERGGFRRTF
                300 |||||||||||||||||||.||||||||||||||||||||||||||||||||||||||||
3               300 ESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESERGGFRRTF

gi|263252       360 SRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSE
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               360 SRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSE

gi|263252       420 PSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSEMFEGSSEGGS
                420 |||||||||||||||||||||||||||||||||||||||||||||||||.||||||||||
3               420 PSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSKMFEGSSEGGS

gi|263252       480 SGPSRRDGRHRAPVTFDESGSLPFLSLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGEN
                480 |||||.||||||||||||||||||.|||||||||||||||||||||||||||||||||||
3               480 SGPSRKDGRHRAPVTFDESGSLPFFSLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGEN

gi|263252       540 DALKTCSVCITEYTEGNKLRKLPCSHEYHVHCIDRWLSENSTCPICRRAVLSSGNRESVV
                540 ||||||||||||||||.||||||||||.||||||||||||||||||||||||||||||||
3               540 DALKTCSVCITEYTEGDKLRKLPCSHEFHVHCIDRWLSENSTCPICRRAVLSSGNRESVV

gi|263252       600 
                600 
3               600 
""",
        )
        hit = record[4]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|67846064|ref|NP_001020063.1|")
        self.assertEqual(hit.target.name, "NP_001020063")
        self.assertEqual(
            hit.target.description,
            "ring finger protein, LIM domain interacting [Rattus norvegicus] >gi|66910661|gb|AAH97491.1| Ring finger protein 12 [Rattus norvegicus] >gi|149055585|gb|EDM07169.1| ring finger protein 12, isoform CRA_b [Rattus norvegicus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=603)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2644.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1023.07591100553)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 561)
        self.assertEqual(hsp.annotations["positive"], 575)
        self.assertEqual(hsp.annotations["gaps"], 9)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 198, 198, 240, 246, 447, 447, 603],
                              [  0, 198, 199, 241, 241, 442, 444, 600]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 606))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.query.id, "3")
        self.assertEqual(
            hsp.query.description,
            "gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.target.id, "gi|67846064|ref|NP_001020063.1|")
        self.assertEqual(hsp.target.name, "NP_001020063")
        self.assertEqual(
            hsp.target.description,
            "ring finger protein, LIM domain interacting [Rattus norvegicus] >gi|66910661|gb|AAH97491.1| Ring finger protein 12 [Rattus norvegicus] >gi|149055585|gb|EDM07169.1| ring finger protein 12, isoform CRA_b [Rattus norvegicus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTEEELLRRLQQIKEGPPPQS DENRAGESSDDV+NSDSIIDWLNSVRQ+GNTTRS QRGNQSWRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENE+EPSTRRLSVE+MESSSQRQME+ ASES SARPSRAERNSTEA+ EVP TR QRRARSRSPEHRRTRARAERS SPL PT EIPRRA       TLEQ  ENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSSDTGSNSESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQ PNNTVTYESERGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSEPSASVSSRN ER ESRNGRGSS  G  + S+SSSSPSPSS+GESSESSS +FEG+SEGG SGPSR+DGRHRAPV FDESGSLPF SLAQFFLLNEDDEDQPRGLTKEQIDNLAMRSFGENDALKTCSVCITEYTEG+KLRKLPCSHE+HVHCIDRWLSENSTCPICRRAVLSSGNRESVV",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|678460         0 MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3                 0 MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTE

gi|678460        60 EELLRRLQQIKEGPPPQSSDENRAGESSDDVSNSDSIIDWLNSVRQSGNTTRSGQRGNQS
                 60 ||||||||||||||||||.||||||||||||.||||||||||||||.||||||.||||||
3                60 EELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSRQRGNQS

gi|678460       120 WRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENENEPSTRRLSVESMESSSQRQMESHAS
                120 ||||||||||||||||||||||||||||||||||.||||||||||.||||||||||..||
3               120 WRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSAS

gi|678460       180 ESTSARPSRAERNSTEAL-EVPLTRGQRRARSRSPEHRRTRARAERSRSPLHPTIEIPRR
                180 ||.||||||||||||||.-|||.||.|||||||||||||||||||||.|||.||.|||||
3               180 ESASARPSRAERNSTEAVTEVPTTRAQRRARSRSPEHRRTRARAERSMSPLQPTSEIPRR

gi|678460       239 AHHNISPQTLEQPLENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSS
                240 |------.||||..||||||||||||||||||||||||||||||||||||||||||||||
3               240 A------PTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSSS

gi|678460       299 DTGSNSESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQTPNNTVTYESERG
                300 |||||||||||||||||||||||||||||||||||||||||||||||.||||||||||||
3               294 DTGSNSESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESERG

gi|678460       359 GFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMY
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               354 GFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMY

gi|678460       419 SDSDSEPSASVSSRNTERAESRNGRGSS--GAGNSSASSSSPSPSSNGESSESSSDLFEG
                420 |||||||||||||||.||.|||||||||--|....|.|||||||||.||||||||..|||
3               414 SDSDSEPSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSKMFEG

gi|678460       477 TSEGGPSGPSRRDGRHRAPVAFDESGSLPFLSLAQFFLLNEDDEDQPRGLTKEQIDNLAM
                480 .||||.|||||.||||||||.|||||||||.|||||||||||||||||||||||||||||
3               474 SSEGGSSGPSRKDGRHRAPVTFDESGSLPFFSLAQFFLLNEDDEDQPRGLTKEQIDNLAM

gi|678460       537 RSFGENDALKTCSVCITEYTEGNKLRKLPCSHEYHVHCIDRWLSENSTCPICRRAVLSSG
                540 ||||||||||||||||||||||.||||||||||.||||||||||||||||||||||||||
3               534 RSFGENDALKTCSVCITEYTEGDKLRKLPCSHEFHVHCIDRWLSENSTCPICRRAVLSSG

gi|678460       597 NRESVV 603
                600 |||||| 606
3               594 NRESVV 600
""",
        )
        hit = record[5]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|74007742|ref|XP_849701.1|")
        self.assertEqual(hit.target.name, "XP_849701")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: similar to ring finger protein 12 isoform 2 [Canis familiaris]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=599)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2497.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 966.451573345675)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 502)
        self.assertEqual(hsp.annotations["positive"], 526)
        self.assertEqual(hsp.annotations["gaps"], 17)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0,  11,  12, 200, 201, 243, 249, 478, 478, 599],
                              [  0,  11,  11, 199, 199, 241, 241, 470, 479, 600]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 608))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.query.id, "3")
        self.assertEqual(
            hsp.query.description,
            "gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MESSDSNDKGSGDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLG...SVV')",
        )
        self.assertEqual(hsp.target.id, "gi|74007742|ref|XP_849701.1|")
        self.assertEqual(hsp.target.name, "XP_849701")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: similar to ring finger protein 12 isoform 2 [Canis familiaris]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "ME+SDSNDKGS DQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTEEELLRRLQQIKEGPPPQ+ DENR G+SSDDV+N DSIIDWLNSVRQTGNTTRS QRGNQSWRAVSRTNPNSGDFRFSLEINVNRNNGSQ  ENE+EPS RR   EN ++SSQRQ+EN  SE  S RPSR+ERNSTEA+T EV  TR QRRARSRSP+HRRTRARAERS SPL P SEIPRR+       T E    NE EGSSRTRHHVTLRQQISGP+LL RGLFAASG+RN SQG  SSDT S+ ES+GSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQ PNNTVTYESERGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSEPS SVSSRNVER ESRNGRG S             P     G +  SSS           S  +R++GRHRAPVTFDESGSLPF SLAQFFLLNEDD+DQPRGLTKEQIDNLAMRSFGENDALKTCSVCITEYTEG+KLRKLPCSHE+HVHCIDRWLSENSTCPICRRAVL+SGNRESVV",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|740077         0 MESSDSNDKGSGDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGEST
                  0 ||.||||||||-||||||||||||||||||||||||||||||||||||||||||||||||
3                 0 MENSDSNDKGS-DQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGEST

gi|740077        60 EEELLRRLQQIKEGPPPQNSDENRGGDSSDDVSNGDSIIDWLNSVRQTGNTTRSGQRGNQ
                 60 ||||||||||||||||||..||||.|.|||||.|.|||||||||||||||||||.|||||
3                59 EEELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSRQRGNQ

gi|740077       120 SWRAVSRTNPNSGDFRFSLEINVNRNNGSQNPENENEPSARRSGGENTDNSSQRQVENPR
                120 ||||||||||||||||||||||||||||||..|||.|||.||...||...|||||.||..
3               119 SWRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSA

gi|740077       180 SEPTSTRPSRSERNSTEALTGEVAPTRGQRRARSRSPDHRRTRARAERSRSPLHPMSEIP
                180 ||..|.||||.|||||||.|-||..||.|||||||||.|||||||||||.|||.|.||||
3               179 SESASARPSRAERNSTEAVT-EVPTTRAQRRARSRSPEHRRTRARAERSMSPLQPTSEIP

gi|740077       240 RRSHHSISSQTFEHPLVNETEGSSRTRHHVTLRQQISGPDLLSRGLFAASGTRNASQGAG
                240 ||.------.|.|....||.|||||||||||||||||||.||.||||||||.||.|||..
3               238 RRA------PTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTS

gi|740077       300 SSDTASSGESTGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQTPNNTVTYESE
                300 ||||.|..||.||||||||||||||||||||||||||||||||||||||.||||||||||
3               292 SSDTGSNSESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESE

gi|740077       360 RGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYF
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               352 RGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYF

gi|740077       420 MYSDSDSEPSGSVSSRNVERAESRNGRGGSVRVPVQAPVLVPVPVLVFEGSNEGSSSS--
                420 ||||||||||.|||||||||.|||||||.|.............|.....|....|||.--
3               412 MYSDSDSEPSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSKMF

gi|740077       478 -------GSSGARREGRHRAPVTFDESGSLPFLSLAQFFLLNEDDDDQPRGLTKEQIDNL
                480 -------.|...|..|||||||||||||||||.||||||||||||.||||||||||||||
3               472 EGSSEGGSSGPSRKDGRHRAPVTFDESGSLPFFSLAQFFLLNEDDEDQPRGLTKEQIDNL

gi|740077       531 AMRSFGENDALKTCSVCITEYTEGNKLRKLPCSHEYHVHCIDRWLSENSTCPICRRAVLA
                540 ||||||||||||||||||||||||.||||||||||.|||||||||||||||||||||||.
3               532 AMRSFGENDALKTCSVCITEYTEGDKLRKLPCSHEFHVHCIDRWLSENSTCPICRRAVLS

gi|740077       591 SGNRESVV 599
                600 |||||||| 608
3               592 SGNRESVV 600
""",
        )
        hit = record[6]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|149757523|ref|XP_001505028.1|")
        self.assertEqual(hit.target.name, "XP_001505028")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: similar to E3 ubiquitin-protein ligase RNF12 (RING finger protein 12) (LIM domain-interacting RING finger protein) (RING finger LIM domain-binding protein) (R-LIM) (Renal carcinoma antigen NY-REN-43) isoform 2 [Equus caballus] >gi|149757525|ref|XP_001505027.1| PREDICTED: similar to E3 ubiquitin-protein ligase RNF12 (RING finger protein 12) (LIM domain-interacting RING finger protein) (RING finger LIM domain-binding protein) (R-LIM) (Renal carcinoma antigen NY-REN-43) isoform 1 [Equus caballus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=616)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2481.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 960.288380130997)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 517)
        self.assertEqual(hsp.annotations["positive"], 547)
        self.assertEqual(hsp.annotations["gaps"], 16)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0,  11,  12, 241, 247, 441, 447, 485, 488, 616],
                              [  0,  11,  11, 240, 240, 434, 434, 472, 472, 600]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 616))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.query.id, "3")
        self.assertEqual(
            hsp.query.description,
            "gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MESSDSNDKGSGDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLG...SVV')",
        )
        self.assertEqual(hsp.target.id, "gi|149757523|ref|XP_001505028.1|")
        self.assertEqual(hsp.target.name, "XP_001505028")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: similar to E3 ubiquitin-protein ligase RNF12 (RING finger protein 12) (LIM domain-interacting RING finger protein) (RING finger LIM domain-binding protein) (R-LIM) (Renal carcinoma antigen NY-REN-43) isoform 2 [Equus caballus] >gi|149757525|ref|XP_001505027.1| PREDICTED: similar to E3 ubiquitin-protein ligase RNF12 (RING finger protein 12) (LIM domain-interacting RING finger protein) (RING finger LIM domain-binding protein) (R-LIM) (Renal carcinoma antigen NY-REN-43) isoform 1 [Equus caballus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "ME+SDSNDKGS DQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTEEELLRRLQQIKEGPPPQ+ DENR G+SSDDV+N DSIIDWLNSVRQTGNTTRS QRGNQSWRAVSRTNPNSGDFRFSLEINVNRNNGSQ  ENE+EPS RR S ENM+++SQRQ+EN+ SESA ARPSR+ERNSTEA+TEV  TR QRRARSRSP+HRRTRARAERS SPL P SEIPRR      + T E    NE EGSSRTRHHVTLRQQISGP+LL RGLFAASG+RN SQGT SSDT  + ES+GSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQ PNNTVTYESERGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSEP  SVSSRN+ER E         G  SSG  +SS SSSSSSPS SSSGESSE+SS++F      S    S  +R++GRHRAPVTFDESGSLPF SLAQFFLLNEDD+DQPRGLTKEQIDNLAMRSFGENDALKTCSVCITEYTEG+KLRKLPCSHE+HVHCIDRWLSENSTCPICRRAVL+SGNRESVV",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|149757         0 MESSDSNDKGSGDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGEST
                  0 ||.||||||||-||||||||||||||||||||||||||||||||||||||||||||||||
3                 0 MENSDSNDKGS-DQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGEST

gi|149757        60 EEELLRRLQQIKEGPPPQNSDENRGGDSSDDVSNGDSIIDWLNSVRQTGNTTRSGQRGNQ
                 60 ||||||||||||||||||..||||.|.|||||.|.|||||||||||||||||||.|||||
3                59 EEELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSRQRGNQ

gi|149757       120 SWRAVSRTNPNSGDFRFSLEINVNRNNGSQNPENENEPSARRSSGENMDNNSQRQVENAQ
                120 ||||||||||||||||||||||||||||||..|||.|||.||.|.|||...||||.||..
3               119 SWRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSA

gi|149757       180 SESAPARPSRSERNSTEALTEVAPTRGQRRARSRSPDHRRTRARAERSRSPLHPMSEIPR
                180 ||||.|||||.|||||||.|||..||.|||||||||.|||||||||||.|||.|.|||||
3               179 SESASARPSRAERNSTEAVTEVPTTRAQRRARSRSPEHRRTRARAERSMSPLQPTSEIPR

gi|149757       240 RSHHSISSQTFEHPLVNETEGSSRTRHHVTLRQQISGPDLLSRGLFAASGTRNASQGTGS
                240 |------..|.|....||.|||||||||||||||||||.||.||||||||.||.||||.|
3               239 R------APTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTSS

gi|149757       300 SDTAGSGESTGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQTPNNTVTYESER
                300 |||....||.||||||||||||||||||||||||||||||||||||||.|||||||||||
3               293 SDTGSNSESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESER

gi|149757       360 GGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFM
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               353 GGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFM

gi|149757       420 YSDSDSEPGGSVSSRNMERAESRNGRGGSGGGSSSGSSSSSNSSSSSSPSSSSSGESSET
                420 ||||||||..||||||.||.|------...|..|||...||.||||||||.||||||||.
3               413 YSDSDSEPSASVSSRNVERVE------SRNGRGSSGGGNSSGSSSSSSPSPSSSGESSES

gi|149757       480 SSEVFEGSNEGSSSSGSAGARREGRHRAPVTFDESGSLPFLSLAQFFLLNEDDDDQPRGL
                480 ||..|---...|....|...|..|||||||||||||||||.||||||||||||.||||||
3               467 SSKMF---EGSSEGGSSGPSRKDGRHRAPVTFDESGSLPFFSLAQFFLLNEDDEDQPRGL

gi|149757       540 TKEQIDNLAMRSFGENDALKTCSVCITEYTEGNKLRKLPCSHEYHVHCIDRWLSENSTCP
                540 ||||||||||||||||||||||||||||||||.||||||||||.||||||||||||||||
3               524 TKEQIDNLAMRSFGENDALKTCSVCITEYTEGDKLRKLPCSHEFHVHCIDRWLSENSTCP

gi|149757       600 ICRRAVLASGNRESVV 616
                600 |||||||.|||||||| 616
3               584 ICRRAVLSSGNRESVV 600
""",
        )
        hit = record[7]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|74007736|ref|XP_859444.1|")
        self.assertEqual(hit.target.name, "XP_859444")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: similar to ring finger protein 12 isoform 3 [Canis familiaris]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=605)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2480.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 959.90318055508)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 502)
        self.assertEqual(hsp.annotations["positive"], 526)
        self.assertEqual(hsp.annotations["gaps"], 23)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0,  11,  12,  85,  91, 206, 207, 249, 255, 484, 484, 605],
                              [  0,  11,  11,  84,  84, 199, 199, 241, 241, 470, 479, 600]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 614))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.query.id, "3")
        self.assertEqual(
            hsp.query.description,
            "gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MESSDSNDKGSGDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLG...SVV')",
        )
        self.assertEqual(hsp.target.id, "gi|74007736|ref|XP_859444.1|")
        self.assertEqual(hsp.target.name, "XP_859444")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: similar to ring finger protein 12 isoform 3 [Canis familiaris]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "ME+SDSNDKGS DQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTEEELLRRLQQIKEGPPPQ+ DENR       G+SSDDV+N DSIIDWLNSVRQTGNTTRS QRGNQSWRAVSRTNPNSGDFRFSLEINVNRNNGSQ  ENE+EPS RR   EN ++SSQRQ+EN  SE  S RPSR+ERNSTEA+T EV  TR QRRARSRSP+HRRTRARAERS SPL P SEIPRR+       T E    NE EGSSRTRHHVTLRQQISGP+LL RGLFAASG+RN SQG  SSDT S+ ES+GSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQ PNNTVTYESERGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSEPS SVSSRNVER ESRNGRG S             P     G +  SSS           S  +R++GRHRAPVTFDESGSLPF SLAQFFLLNEDD+DQPRGLTKEQIDNLAMRSFGENDALKTCSVCITEYTEG+KLRKLPCSHE+HVHCIDRWLSENSTCPICRRAVL+SGNRESVV",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|740077         0 MESSDSNDKGSGDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGEST
                  0 ||.||||||||-||||||||||||||||||||||||||||||||||||||||||||||||
3                 0 MENSDSNDKGS-DQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGEST

gi|740077        60 EEELLRRLQQIKEGPPPQNSDENRGANCSFGGDSSDDVSNGDSIIDWLNSVRQTGNTTRS
                 60 ||||||||||||||||||..||||.------|.|||||.|.|||||||||||||||||||
3                59 EEELLRRLQQIKEGPPPQSPDENRA------GESSDDVTNSDSIIDWLNSVRQTGNTTRS

gi|740077       120 GQRGNQSWRAVSRTNPNSGDFRFSLEINVNRNNGSQNPENENEPSARRSGGENTDNSSQR
                120 .|||||||||||||||||||||||||||||||||||..|||.|||.||...||...||||
3               113 RQRGNQSWRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQR

gi|740077       180 QVENPRSEPTSTRPSRSERNSTEALTGEVAPTRGQRRARSRSPDHRRTRARAERSRSPLH
                180 |.||..||..|.||||.|||||||.|-||..||.|||||||||.|||||||||||.|||.
3               173 QMENSASESASARPSRAERNSTEAVT-EVPTTRAQRRARSRSPEHRRTRARAERSMSPLQ

gi|740077       240 PMSEIPRRSHHSISSQTFEHPLVNETEGSSRTRHHVTLRQQISGPDLLSRGLFAASGTRN
                240 |.||||||.------.|.|....||.|||||||||||||||||||.||.||||||||.||
3               232 PTSEIPRRA------PTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRN

gi|740077       300 ASQGAGSSDTASSGESTGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQTPNNT
                300 .|||..||||.|..||.||||||||||||||||||||||||||||||||||||||.||||
3               286 PSQGTSSSDTGSNSESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNT

gi|740077       360 VTYESERGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGF
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               346 VTYESERGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGF

gi|740077       420 GELSYFMYSDSDSEPSGSVSSRNVERAESRNGRGGSVRVPVQAPVLVPVPVLVFEGSNEG
                420 ||||||||||||||||.|||||||||.|||||||.|.............|.....|....
3               406 GELSYFMYSDSDSEPSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSE

gi|740077       480 SSSS---------GSSGARREGRHRAPVTFDESGSLPFLSLAQFFLLNEDDDDQPRGLTK
                480 |||.---------.|...|..|||||||||||||||||.||||||||||||.||||||||
3               466 SSSKMFEGSSEGGSSGPSRKDGRHRAPVTFDESGSLPFFSLAQFFLLNEDDEDQPRGLTK

gi|740077       531 EQIDNLAMRSFGENDALKTCSVCITEYTEGNKLRKLPCSHEYHVHCIDRWLSENSTCPIC
                540 ||||||||||||||||||||||||||||||.||||||||||.||||||||||||||||||
3               526 EQIDNLAMRSFGENDALKTCSVCITEYTEGDKLRKLPCSHEFHVHCIDRWLSENSTCPIC

gi|740077       591 RRAVLASGNRESVV 605
                600 |||||.|||||||| 614
3               586 RRAVLSSGNRESVV 600
""",
        )
        hit = record[8]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|76659189|ref|XP_589983.2|")
        self.assertEqual(hit.target.name, "XP_589983")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: similar to E3 ubiquitin-protein ligase RNF12 (RING finger protein 12) (LIM domain-interacting RING finger protein) (RING finger LIM domain-binding protein) (R-LIM) (Renal carcinoma antigen NY-REN-43) isoform 1 [Bos taurus] >gi|119920248|ref|XP_001251830.1| PREDICTED: similar to E3 ubiquitin-protein ligase RNF12 (RING finger protein 12) (LIM domain-interacting RING finger protein) (RING finger LIM domain-binding protein) (R-LIM) (Renal carcinoma antigen NY-REN-43) [Bos taurus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=611)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2473.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 957.206783523659)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 519)
        self.assertEqual(hsp.annotations["positive"], 550)
        self.assertEqual(hsp.annotations["gaps"], 11)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0,  11,  12, 200, 201, 243, 249, 480, 483, 611],
                              [  0,  11,  11, 199, 199, 241, 241, 472, 472, 600]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 611))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.query.id, "3")
        self.assertEqual(
            hsp.query.description,
            "gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MESSDCNDKGSGDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLG...SIV')",
        )
        self.assertEqual(hsp.target.id, "gi|76659189|ref|XP_589983.2|")
        self.assertEqual(hsp.target.name, "XP_589983")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: similar to E3 ubiquitin-protein ligase RNF12 (RING finger protein 12) (LIM domain-interacting RING finger protein) (RING finger LIM domain-binding protein) (R-LIM) (Renal carcinoma antigen NY-REN-43) isoform 1 [Bos taurus] >gi|119920248|ref|XP_001251830.1| PREDICTED: similar to E3 ubiquitin-protein ligase RNF12 (RING finger protein 12) (LIM domain-interacting RING finger protein) (RING finger LIM domain-binding protein) (R-LIM) (Renal carcinoma antigen NY-REN-43) [Bos taurus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "ME+SD NDKGS DQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTEEELLRRLQQIKEGPPPQ+ DENR G+SSDDV+N DSIIDWLNSVRQTGNTTRS QRGNQSWRAVSRTNPNSGDFRFSLEINVNRNNGSQ  ENE+EPS RR S E+M+++SQRQMEN  SE+ SARP R+ERNSTEA+T E P TR QRRARSRSP+HRRTRARAERS SPL P SEIPRR+       T E    NE EGSSRTRHHVTLRQQISGP+LL RGLFAASG+RN SQG  SSDT  N ES+GSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQ PNNTVTYESERGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSEPS SVSSRN+ER ESRNGRG SGG +SSGSSSSSSPS SS+GESSE+SS++F      S    S  +R++GRHRAPVTFDESGSLPF SLAQFFLLNEDD+DQPRGLTKEQIDNLAMRSFGENDALKTCSVCITEYTEG+KLRKLPCSHE+HVHCIDRWLSENSTCPICRRAVL+SGNRES+V",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|766591         0 MESSDCNDKGSGDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGEST
                  0 ||.||.|||||-||||||||||||||||||||||||||||||||||||||||||||||||
3                 0 MENSDSNDKGS-DQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGEST

gi|766591        60 EEELLRRLQQIKEGPPPQNSDENRGGDSSDDVSNGDSIIDWLNSVRQTGNTTRSGQRGNQ
                 60 ||||||||||||||||||..||||.|.|||||.|.|||||||||||||||||||.|||||
3                59 EEELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSRQRGNQ

gi|766591       120 SWRAVSRTNPNSGDFRFSLEINVNRNNGSQNPENENEPSARRSSGESMDNNSQRQMENPR
                120 ||||||||||||||||||||||||||||||..|||.|||.||.|.|.|...|||||||..
3               119 SWRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSA

gi|766591       180 SETTSARPPRSERNSTEALTGEAPPTRGQRRARSRSPDHRRTRARAERSRSPLHPMSEIP
                180 ||..||||.|.|||||||.|-|.|.||.|||||||||.|||||||||||.|||.|.||||
3               179 SESASARPSRAERNSTEAVT-EVPTTRAQRRARSRSPEHRRTRARAERSMSPLQPTSEIP

gi|766591       240 RRSHHSISSQTFEHPLVNETEGSSRTRHHVTLRQQISGPDLLTRGLFAASGTRNASQGAG
                240 ||.------.|.|....||.|||||||||||||||||||.||.||||||||.||.|||..
3               238 RRA------PTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTS

gi|766591       300 SSDTTGNGESTGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQTPNNTVTYESE
                300 ||||..|.||.||||||||||||||||||||||||||||||||||||||.||||||||||
3               292 SSDTGSNSESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESE

gi|766591       360 RGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYF
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               352 RGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYF

gi|766591       420 MYSDSDSEPSGSVSSRNMERSESRNGRGGSGGSSSSGSSSSSSPSSSSNGESSETSSEVF
                420 ||||||||||.||||||.||.|||||||.|||..|||||||||||.||.|||||.||..|
3               412 MYSDSDSEPSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSKMF

gi|766591       480 EGSNEGSSSSGSSGARREGRHRAPVTFDESGSLPFLSLAQFFLLNEDDDDQPRGLTKEQI
                480 ---...|....|...|..|||||||||||||||||.||||||||||||.|||||||||||
3               472 ---EGSSEGGSSGPSRKDGRHRAPVTFDESGSLPFFSLAQFFLLNEDDEDQPRGLTKEQI

gi|766591       540 DNLAMRSFGENDALKTCSVCITEYTEGNKLRKLPCSHEYHVHCIDRWLSENSTCPICRRA
                540 |||||||||||||||||||||||||||.||||||||||.|||||||||||||||||||||
3               529 DNLAMRSFGENDALKTCSVCITEYTEGDKLRKLPCSHEFHVHCIDRWLSENSTCPICRRA

gi|766591       600 VLASGNRESIV 611
                600 ||.||||||.| 611
3               589 VLSSGNRESVV 600
""",
        )
        hit = record[9]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|74007740|ref|XP_859515.1|")
        self.assertEqual(hit.target.name, "XP_859515")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: similar to ring finger protein 12 isoform 5 [Canis familiaris]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=594)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2464.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 953.739987340402)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 497)
        self.assertEqual(hsp.annotations["positive"], 523)
        self.assertEqual(hsp.annotations["gaps"], 22)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0,  11,  12, 200, 201, 243, 249, 443, 443, 594],
                              [  0,  11,  11, 199, 199, 241, 241, 435, 449, 600]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 608))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MENSDSNDKGSDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGT...SVV')",
        )
        self.assertEqual(hsp.query.id, "3")
        self.assertEqual(
            hsp.query.description,
            "gi|4959044|gb|AAD34209.1|AF069992_1 LIM domain interacting RING finger protein",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MESSDSNDKGSGDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLG...SVV')",
        )
        self.assertEqual(hsp.target.id, "gi|74007740|ref|XP_859515.1|")
        self.assertEqual(hsp.target.name, "XP_859515")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: similar to ring finger protein 12 isoform 5 [Canis familiaris]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "ME+SDSNDKGS DQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGESTEEELLRRLQQIKEGPPPQ+ DENR G+SSDDV+N DSIIDWLNSVRQTGNTTRS QRGNQSWRAVSRTNPNSGDFRFSLEINVNRNNGSQ  ENE+EPS RR   EN ++SSQRQ+EN  SE  S RPSR+ERNSTEA+T EV  TR QRRARSRSP+HRRTRARAERS SPL P SEIPRR+       T E    NE EGSSRTRHHVTLRQQISGP+LL RGLFAASG+RN SQG  SSDT S+ ES+GSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQ PNNTVTYESERGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYFMYSDSDSEPS SVSSRNVER ES               +       SSS E+S    +     S    S  +R++GRHRAPVTFDESGSLPF SLAQFFLLNEDD+DQPRGLTKEQIDNLAMRSFGENDALKTCSVCITEYTEG+KLRKLPCSHE+HVHCIDRWLSENSTCPICRRAVL+SGNRESVV",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|740077         0 MESSDSNDKGSGDQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGEST
                  0 ||.||||||||-||||||||||||||||||||||||||||||||||||||||||||||||
3                 0 MENSDSNDKGS-DQSAAQRRSQMDRLDREEAFYQFVNNLSEEDYRLMRDNNLLGTPGEST

gi|740077        60 EEELLRRLQQIKEGPPPQNSDENRGGDSSDDVSNGDSIIDWLNSVRQTGNTTRSGQRGNQ
                 60 ||||||||||||||||||..||||.|.|||||.|.|||||||||||||||||||.|||||
3                59 EEELLRRLQQIKEGPPPQSPDENRAGESSDDVTNSDSIIDWLNSVRQTGNTTRSRQRGNQ

gi|740077       120 SWRAVSRTNPNSGDFRFSLEINVNRNNGSQNPENENEPSARRSGGENTDNSSQRQVENPR
                120 ||||||||||||||||||||||||||||||..|||.|||.||...||...|||||.||..
3               119 SWRAVSRTNPNSGDFRFSLEINVNRNNGSQTSENESEPSTRRLSVENMESSSQRQMENSA

gi|740077       180 SEPTSTRPSRSERNSTEALTGEVAPTRGQRRARSRSPDHRRTRARAERSRSPLHPMSEIP
                180 ||..|.||||.|||||||.|-||..||.|||||||||.|||||||||||.|||.|.||||
3               179 SESASARPSRAERNSTEAVT-EVPTTRAQRRARSRSPEHRRTRARAERSMSPLQPTSEIP

gi|740077       240 RRSHHSISSQTFEHPLVNETEGSSRTRHHVTLRQQISGPDLLSRGLFAASGTRNASQGAG
                240 ||.------.|.|....||.|||||||||||||||||||.||.||||||||.||.|||..
3               238 RRA------PTLEQSSENEPEGSSRTRHHVTLRQQISGPELLGRGLFAASGSRNPSQGTS

gi|740077       300 SSDTASSGESTGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQTPNNTVTYESE
                300 ||||.|..||.||||||||||||||||||||||||||||||||||||||.||||||||||
3               292 SSDTGSNSESSGSGQRPPTIVLDLQVRRVRPGEYRQRDSIASRTRSRSQAPNNTVTYESE

gi|740077       360 RGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYF
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
3               352 RGGFRRTFSRSERAGVRTYVSTIRIPIRRILNTGLSETTSVAIQTMLRQIMTGFGELSYF

gi|740077       420 MYSDSDSEPSGSVSSRNVERAES--------------RNGRGGSGGSSSSETSSEVFEGS
                420 ||||||||||.|||||||||.||--------------.........|||.|.|.......
3               412 MYSDSDSEPSASVSSRNVERVESRNGRGSSGGGNSSGSSSSSSPSPSSSGESSESSSKMF

gi|740077       466 NEGSSSSGSSGARREGRHRAPVTFDESGSLPFLSLAQFFLLNEDDDDQPRGLTKEQIDNL
                480 ...|....|...|..|||||||||||||||||.||||||||||||.||||||||||||||
3               472 EGSSEGGSSGPSRKDGRHRAPVTFDESGSLPFFSLAQFFLLNEDDEDQPRGLTKEQIDNL

gi|740077       526 AMRSFGENDALKTCSVCITEYTEGNKLRKLPCSHEYHVHCIDRWLSENSTCPICRRAVLA
                540 ||||||||||||||||||||||||.||||||||||.|||||||||||||||||||||||.
3               532 AMRSFGENDALKTCSVCITEYTEGDKLRKLPCSHEFHVHCIDRWLSENSTCPICRRAVLS

gi|740077       586 SGNRESVV 594
                600 |||||||| 608
3               592 SGNRESVV 600
""",
        )
        record = next(records)
        self.assertIsInstance(record.query, SeqRecord)
        self.assertEqual(record.query.id, "4")
        self.assertEqual(
            record.query.description, "gi|671626|emb|CAA85685.1| rubisco large subunit"
        )
        self.assertEqual(repr(record.query.seq), "Seq(None, length=473)")

        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 8994603)
        self.assertEqual(record.stat["db-len"], -1216159329)
        self.assertEqual(record.stat["hsp-len"], 0)
        self.assertAlmostEqual(record.stat["eff-space"], 605914661151.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.041)
        self.assertAlmostEqual(record.stat["lambda"], 0.267)
        self.assertAlmostEqual(record.stat["entropy"], 0.14)
        self.assertEqual(len(record), 10)
        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|671626|emb|CAA85685.1|")
        self.assertEqual(hit.target.name, "CAA85685")
        self.assertEqual(
            hit.target.description, "rubisco large subunit [Rosmarinus officinalis]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=473)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2543.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 984.170753837873)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 473)
        self.assertEqual(hsp.annotations["positive"], 473)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 473],
                              [  0, 473]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 473))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.query.id, "4")
        self.assertEqual(
            hsp.query.description, "gi|671626|emb|CAA85685.1| rubisco large subunit"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.target.id, "gi|671626|emb|CAA85685.1|")
        self.assertEqual(hsp.target.name, "CAA85685")
        self.assertEqual(
            hsp.target.description, "rubisco large subunit [Rosmarinus officinalis]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAESSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQCICYVAYPLDLFEEGSVTNMFTSIVGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGLSAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYLNATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAVIDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSRGIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVANRVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|671626         0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4                 0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE

gi|671626        60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQCICYVAYPLDLFEEGSVTNMFTSI
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4                60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQCICYVAYPLDLFEEGSVTNMFTSI

gi|671626       120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL

gi|671626       180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL

gi|671626       240 NATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               240 NATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV

gi|671626       300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR

gi|671626       360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN

gi|671626       420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||| 473
4               420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
""",
        )
        hit = record[1]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|671654|emb|CAA85698.1|")
        self.assertEqual(hit.target.name, "CAA85698")
        self.assertEqual(
            hit.target.description,
            "rubisco large subunit [Salvia sclarea] >gi|1419246|emb|CAA85693.1| rubisco large subunit [Salvia indica] >gi|1480421|emb|CAA85719.1| rubisco large subunit [Thymus vulgaris] >gi|1480423|emb|CAA85720.1| rubisco large subunit [Thymus vulgaris]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=473)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2530.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 979.163159350948)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 471)
        self.assertEqual(hsp.annotations["positive"], 472)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 473],
                              [  0, 473]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 473))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.query.id, "4")
        self.assertEqual(
            hsp.query.description, "gi|671626|emb|CAA85685.1| rubisco large subunit"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.target.id, "gi|671654|emb|CAA85698.1|")
        self.assertEqual(hsp.target.name, "CAA85698")
        self.assertEqual(
            hsp.target.description,
            "rubisco large subunit [Salvia sclarea] >gi|1419246|emb|CAA85693.1| rubisco large subunit [Salvia indica] >gi|1480421|emb|CAA85719.1| rubisco large subunit [Thymus vulgaris] >gi|1480423|emb|CAA85720.1| rubisco large subunit [Thymus vulgaris]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAESSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQ ICYVAYPLDLFEEGSVTNMFTSIVGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGLSAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYLNATAGTCEEM+KRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAVIDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSRGIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVANRVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|671654         0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4                 0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE

gi|671654        60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQYICYVAYPLDLFEEGSVTNMFTSI
                 60 ||||||||||||||||||||||||||||||||||||.|||||||||||||||||||||||
4                60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQCICYVAYPLDLFEEGSVTNMFTSI

gi|671654       120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL

gi|671654       180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL

gi|671654       240 NATAGTCEEMMKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV
                240 ||||||||||.|||||||||||||||||||||||||||||||||||||||||||||||||
4               240 NATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV

gi|671654       300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR

gi|671654       360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN

gi|671654       420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||| 473
4               420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
""",
        )
        hit = record[2]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|671568|emb|CAA85667.1|")
        self.assertEqual(hit.target.name, "CAA85667")
        self.assertEqual(
            hit.target.description, "rubisco large subunit [Mentha suaveolens]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=473)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2528.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 978.392760199113)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 470)
        self.assertEqual(hsp.annotations["positive"], 472)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 473],
                              [  0, 473]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 473))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.query.id, "4")
        self.assertEqual(
            hsp.query.description, "gi|671626|emb|CAA85685.1| rubisco large subunit"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.target.id, "gi|671568|emb|CAA85667.1|")
        self.assertEqual(hsp.target.name, "CAA85667")
        self.assertEqual(
            hsp.target.description, "rubisco large subunit [Mentha suaveolens]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAESSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQ ICYVAYPLDLFEEGSVTNMFTSIVGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGLSAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYK+QAETGEIKGHYLNATAGTCEEM+KRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAVIDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSRGIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVANRVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|671568         0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4                 0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE

gi|671568        60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQYICYVAYPLDLFEEGSVTNMFTSI
                 60 ||||||||||||||||||||||||||||||||||||.|||||||||||||||||||||||
4                60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQCICYVAYPLDLFEEGSVTNMFTSI

gi|671568       120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL

gi|671568       180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKSQAETGEIKGHYL
                180 |||||||||||||||||||||||||||||||||||||||||||||||.||||||||||||
4               180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL

gi|671568       240 NATAGTCEEMMKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV
                240 ||||||||||.|||||||||||||||||||||||||||||||||||||||||||||||||
4               240 NATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV

gi|671568       300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR

gi|671568       360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN

gi|671568       420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||| 473
4               420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
""",
        )
        hit = record[3]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1419217|emb|CAA85688.1|")
        self.assertEqual(hit.target.name, "CAA85688")
        self.assertEqual(
            hit.target.description,
            "rubisco large subunit [Salvia bucharica] >gi|1419237|emb|CAA85689.1| rubisco large subunit [Salvia canariensis]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=473)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2528.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 978.392760199113)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 470)
        self.assertEqual(hsp.annotations["positive"], 472)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 473],
                              [  0, 473]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 473))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.query.id, "4")
        self.assertEqual(
            hsp.query.description, "gi|671626|emb|CAA85685.1| rubisco large subunit"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.target.id, "gi|1419217|emb|CAA85688.1|")
        self.assertEqual(hsp.target.name, "CAA85688")
        self.assertEqual(
            hsp.target.description,
            "rubisco large subunit [Salvia bucharica] >gi|1419237|emb|CAA85689.1| rubisco large subunit [Salvia canariensis]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAESSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQ ICYVAYPLDLFEEGSVTNMFTSIVGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGLSAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYLNATAGTCEEM+KRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAVIDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDF+EKDRSRGIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVANRVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|141921         0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4                 0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE

gi|141921        60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQYICYVAYPLDLFEEGSVTNMFTSI
                 60 ||||||||||||||||||||||||||||||||||||.|||||||||||||||||||||||
4                60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQCICYVAYPLDLFEEGSVTNMFTSI

gi|141921       120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL

gi|141921       180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL

gi|141921       240 NATAGTCEEMMKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV
                240 ||||||||||.|||||||||||||||||||||||||||||||||||||||||||||||||
4               240 NATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV

gi|141921       300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFVEKDRSR
                300 |||||||||||||||||||||||||||||||||||||||||||||||||||||.||||||
4               300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR

gi|141921       360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN

gi|141921       420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||| 473
4               420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
""",
        )
        hit = record[4]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|671558|emb|CAA85670.1|")
        self.assertEqual(hit.target.name, "CAA85670")
        self.assertEqual(
            hit.target.description, "rubisco large subunit [Monarda menthaefolia]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=473)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2528.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 978.392760199113)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 470)
        self.assertEqual(hsp.annotations["positive"], 472)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 473],
                              [  0, 473]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 473))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.query.id, "4")
        self.assertEqual(
            hsp.query.description, "gi|671626|emb|CAA85685.1| rubisco large subunit"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPQYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.target.id, "gi|671558|emb|CAA85670.1|")
        self.assertEqual(hsp.target.name, "CAA85670")
        self.assertEqual(
            hsp.target.description, "rubisco large subunit [Monarda menthaefolia]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MSPQTETKASVGFKAGVKEYKLTYYTP+YETKDTDILAAFRVTPQPGVPPEEAGAAVAAESSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQ ICYVAYPLDLFEEGSVTNMFTSIVGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGLSAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYK+QAETGEIKGHYLNATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAVIDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSRGIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVANRVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|671558         0 MSPQTETKASVGFKAGVKEYKLTYYTPQYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE
                  0 |||||||||||||||||||||||||||.||||||||||||||||||||||||||||||||
4                 0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE

gi|671558        60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQYICYVAYPLDLFEEGSVTNMFTSI
                 60 ||||||||||||||||||||||||||||||||||||.|||||||||||||||||||||||
4                60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQCICYVAYPLDLFEEGSVTNMFTSI

gi|671558       120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL

gi|671558       180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKSQAETGEIKGHYL
                180 |||||||||||||||||||||||||||||||||||||||||||||||.||||||||||||
4               180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL

gi|671558       240 NATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               240 NATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV

gi|671558       300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR

gi|671558       360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN

gi|671558       420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||| 473
4               420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
""",
        )
        hit = record[5]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1419213|emb|CAA85687.1|")
        self.assertEqual(hit.target.name, "CAA85687")
        self.assertEqual(
            hit.target.description, "rubisco large subunit [Salvia argentea]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=473)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2525.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 977.237161471361)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 470)
        self.assertEqual(hsp.annotations["positive"], 471)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 473],
                              [  0, 473]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 473))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.query.id, "4")
        self.assertEqual(
            hsp.query.description, "gi|671626|emb|CAA85685.1| rubisco large subunit"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.target.id, "gi|1419213|emb|CAA85687.1|")
        self.assertEqual(hsp.target.name, "CAA85687")
        self.assertEqual(
            hsp.target.description, "rubisco large subunit [Salvia argentea]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAESSTGTWTTVWTDGLTSLDRYKGRCYHIEPV GEKDQ ICYVAYPLDLFEEGSVTNMFTSIVGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGLSAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYLNATAGTCEEM+KRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAVIDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSRGIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVANRVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|141921         0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4                 0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE

gi|141921        60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVTGEKDQYICYVAYPLDLFEEGSVTNMFTSI
                 60 ||||||||||||||||||||||||||||||.|||||.|||||||||||||||||||||||
4                60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQCICYVAYPLDLFEEGSVTNMFTSI

gi|141921       120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL

gi|141921       180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL

gi|141921       240 NATAGTCEEMMKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV
                240 ||||||||||.|||||||||||||||||||||||||||||||||||||||||||||||||
4               240 NATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV

gi|141921       300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR

gi|141921       360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN

gi|141921       420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||| 473
4               420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
""",
        )
        hit = record[6]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|671589|emb|CAA85676.1|")
        self.assertEqual(hit.target.name, "CAA85676")
        self.assertEqual(
            hit.target.description,
            "rubisco large subunit [Origanum laevigatum] >gi|671593|emb|CAA85677.1| rubisco large subunit [Origanum vulgare]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=473)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2525.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 977.237161471361)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 470)
        self.assertEqual(hsp.annotations["positive"], 471)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 473],
                              [  0, 473]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 473))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.query.id, "4")
        self.assertEqual(
            hsp.query.description, "gi|671626|emb|CAA85685.1| rubisco large subunit"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.target.id, "gi|671589|emb|CAA85676.1|")
        self.assertEqual(hsp.target.name, "CAA85676")
        self.assertEqual(
            hsp.target.description,
            "rubisco large subunit [Origanum laevigatum] >gi|671593|emb|CAA85677.1| rubisco large subunit [Origanum vulgare]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAESSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQ ICYVAYPLDLFEEGSVTNMFTSIVGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGLSAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYLNATAGTCEEM+KRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAVIDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLG VDLLRDDFIEKDRSRGIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVANRVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|671589         0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4                 0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE

gi|671589        60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQYICYVAYPLDLFEEGSVTNMFTSI
                 60 ||||||||||||||||||||||||||||||||||||.|||||||||||||||||||||||
4                60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQCICYVAYPLDLFEEGSVTNMFTSI

gi|671589       120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL

gi|671589       180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL

gi|671589       240 NATAGTCEEMMKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV
                240 ||||||||||.|||||||||||||||||||||||||||||||||||||||||||||||||
4               240 NATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV

gi|671589       300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGLVDLLRDDFIEKDRSR
                300 ||||||||||||||||||||||||||||||||||||||||||||.|||||||||||||||
4               300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR

gi|671589       360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN

gi|671589       420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||| 473
4               420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
""",
        )
        hit = record[7]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1480419|emb|CAA85718.1|")
        self.assertEqual(hit.target.name, "CAA85718")
        self.assertEqual(
            hit.target.description, "rubisco large subunit [Thymus alsinoides]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=473)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2523.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 976.466762319526)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 470)
        self.assertEqual(hsp.annotations["positive"], 471)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 473],
                              [  0, 473]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 473))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.query.id, "4")
        self.assertEqual(
            hsp.query.description, "gi|671626|emb|CAA85685.1| rubisco large subunit"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.target.id, "gi|1480419|emb|CAA85718.1|")
        self.assertEqual(hsp.target.name, "CAA85718")
        self.assertEqual(
            hsp.target.description, "rubisco large subunit [Thymus alsinoides]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAESSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQ ICYVAYPLDLFEEGSVTNMFTSIVGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGLSAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYLNATAGTCEEM+KRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAVIDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSRGIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDS LQFGGGTLGHPWGNAPGAVANRVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|148041         0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4                 0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE

gi|148041        60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQYICYVAYPLDLFEEGSVTNMFTSI
                 60 ||||||||||||||||||||||||||||||||||||.|||||||||||||||||||||||
4                60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQCICYVAYPLDLFEEGSVTNMFTSI

gi|148041       120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL

gi|148041       180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL

gi|148041       240 NATAGTCEEMMKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV
                240 ||||||||||.|||||||||||||||||||||||||||||||||||||||||||||||||
4               240 NATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV

gi|148041       300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR

gi|148041       360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSGLQFGGGTLGHPWGNAPGAVAN
                360 ||||||||||||||||||||||||||||||||||||||.|||||||||||||||||||||
4               360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN

gi|148041       420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||| 473
4               420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
""",
        )
        hit = record[8]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|671624|emb|CAA85684.1|")
        self.assertEqual(hit.target.name, "CAA85684")
        self.assertEqual(
            hit.target.description, "rubisco large subunit [Rosmarinus officinalis]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=473)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2523.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 976.466762319526)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 469)
        self.assertEqual(hsp.annotations["positive"], 471)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 473],
                              [  0, 473]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 473))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.query.id, "4")
        self.assertEqual(
            hsp.query.description, "gi|671626|emb|CAA85685.1| rubisco large subunit"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.target.id, "gi|671624|emb|CAA85684.1|")
        self.assertEqual(hsp.target.name, "CAA85684")
        self.assertEqual(
            hsp.target.description, "rubisco large subunit [Rosmarinus officinalis]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAESSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQ ICYVAYPLDLFEEGSVTNMFTSIVGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDK NKYGRPLLGCTIKPKLGLSAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYLNATAGTCEEM+KRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAVIDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGF+DLLRDDFIEKDRSRGIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVANRVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|671624         0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4                 0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE

gi|671624        60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQYICYVAYPLDLFEEGSVTNMFTSI
                 60 ||||||||||||||||||||||||||||||||||||.|||||||||||||||||||||||
4                60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQCICYVAYPLDLFEEGSVTNMFTSI

gi|671624       120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKSNKYGRPLLGCTIKPKLGL
                120 |||||||||||||||||||||||||||||||||||||||||.||||||||||||||||||
4               120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL

gi|671624       180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL

gi|671624       240 NATAGTCEEMMKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV
                240 ||||||||||.|||||||||||||||||||||||||||||||||||||||||||||||||
4               240 NATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV

gi|671624       300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFIDLLRDDFIEKDRSR
                300 |||||||||||||||||||||||||||||||||||||||||||||.||||||||||||||
4               300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR

gi|671624       360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN

gi|671624       420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||| 473
4               420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
""",
        )
        hit = record[9]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1419211|emb|CAA85686.1|")
        self.assertEqual(hit.target.name, "CAA85686")
        self.assertEqual(
            hit.target.description, "rubisco large subunit [Salvia aethiopis]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=473)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 2523.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 976.466762319526)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 469)
        self.assertEqual(hsp.annotations["positive"], 471)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 473],
                              [  0, 473]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 473))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.query.id, "4")
        self.assertEqual(
            hsp.query.description, "gi|671626|emb|CAA85685.1| rubisco large subunit"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAG...AMD')",
        )
        self.assertEqual(hsp.target.id, "gi|1419211|emb|CAA85686.1|")
        self.assertEqual(hsp.target.name, "CAA85686")
        self.assertEqual(
            hsp.target.description, "rubisco large subunit [Salvia aethiopis]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAESSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQ ICYVAYPLDLFEEGSVTNMFTSIVGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGLSAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYLNATAGTCEEM+KRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAVIDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDF+EKDRSRGIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVANRVAVEACV ARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|141921         0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4                 0 MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE

gi|141921        60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQYICYVAYPLDLFEEGSVTNMFTSI
                 60 ||||||||||||||||||||||||||||||||||||.|||||||||||||||||||||||
4                60 SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEKDQCICYVAYPLDLFEEGSVTNMFTSI

gi|141921       120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               120 VGNVFGFKALRALRLEDLRIPVAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL

gi|141921       180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               180 SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKAQAETGEIKGHYL

gi|141921       240 NATAGTCEEMMKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV
                240 ||||||||||.|||||||||||||||||||||||||||||||||||||||||||||||||
4               240 NATAGTCEEMIKRAIFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV

gi|141921       300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFVEKDRSR
                300 |||||||||||||||||||||||||||||||||||||||||||||||||||||.||||||
4               300 IDRQKNHGMHFRVLAKALRLSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFIEKDRSR

gi|141921       360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
4               360 GIYFTQDWVSLPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN

gi|141921       420 RVAVEACVLARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
                420 ||||||||.|||||||||||||||||||||||||||||||||||||||||||| 473
4               420 RVAVEACVKARNEGRDLAAEGNAIIREACKWSPELAAACEVWKEIKFEFPAMD 473
""",
        )

    def test_xml_2218L_rpsblast_001(self):
        """Parsing blastp 2.2.18 [Mar-02-2008] (xml_2218L_rpsblast_001.xml)."""
        filename = "xml_2218L_rpsblast_001.xml"
        datafile = os.path.join("Blast", filename)
        with open(datafile, "rb") as handle:
            records = Blast.parse(handle)
            self.check_xml_2218L_rpsblast_001(records)
        with Blast.parse(datafile) as records:
            self.check_xml_2218L_rpsblast_001(records)

    def check_xml_2218L_rpsblast_001(self, records):
        self.assertEqual(records.program, "blastp")
        self.assertEqual(records.version, "blastp 2.2.18 [Mar-02-2008]")
        self.assertEqual(
            records.reference,
            '~Reference: Altschul, Stephen F., Thomas L. Madden, Alejandro A. Schaffer, ~Jinghui Zhang, Zheng Zhang, Webb Miller, and David J. Lipman (1997), ~"Gapped BLAST and PSI-BLAST: a new generation of protein database search~programs",  Nucleic Acids Res. 25:3389-3402.',
        )
        self.assertEqual(records.db, "/opt/BlastDBs/nr")
        self.assertIsInstance(records.query, SeqRecord)
        self.assertEqual(records.query.id, "lcl|QUERY")
        self.assertEqual(records.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(repr(records.query.seq), "Seq(None, length=131)")
        self.assertEqual(len(records.param), 6)
        self.assertEqual(records.param["matrix"], "BLOSUM62")
        self.assertAlmostEqual(records.param["expect"], 10.0)
        self.assertAlmostEqual(records.param["include"], 0.001)
        self.assertEqual(records.param["gap-open"], 11)
        self.assertEqual(records.param["gap-extend"], 1)
        self.assertEqual(records.param["filter"], "S")
        record = next(records)
        self.assertIsNone(record.query)
        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 2563094)
        self.assertEqual(record.stat["db-len"], 864488805)
        self.assertEqual(record.stat["hsp-len"], 96)
        self.assertAlmostEqual(record.stat["eff-space"], 80278100000.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.041)
        self.assertAlmostEqual(record.stat["lambda"], 0.267)
        self.assertAlmostEqual(record.stat["entropy"], 0.14)
        self.assertEqual(len(record), 11)
        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|75750454|ref|YP_319893.1|")
        self.assertEqual(hit.target.name, "YP_319893")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein ATV_gp62 [Acidianus two-tailed virus] >gi|74474837|emb|CAI59911.1| hypothetical protein [Acidianus two-tailed virus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=131)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 680.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 266.544)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.72196e-70)
        self.assertEqual(hsp.annotations["identity"], 131)
        self.assertEqual(hsp.annotations["positive"], 131)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 131],
                              [  0, 131]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 131))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...MAS')",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...MAS')",
        )
        self.assertEqual(hsp.target.id, "gi|75750454|ref|YP_319893.1|")
        self.assertEqual(hsp.target.name, "YP_319893")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein ATV_gp62 [Acidianus two-tailed virus] >gi|74474837|emb|CAI59911.1| hypothetical protein [Acidianus two-tailed virus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQAMAS",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|757504         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|QUERY         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK

gi|757504        60 MISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSK
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|QUERY        60 MISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSK

gi|757504       120 GAKKLAQAMAS 131
                120 ||||||||||| 131
lcl|QUERY       120 GAKKLAQAMAS 131
""",
        )
        hit = record[1]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|51980166|ref|YP_077233.1|")
        self.assertEqual(hit.target.name, "YP_077233")
        self.assertEqual(
            hit.target.description,
            "coat protein [Sulfolobus virus STSV1] >gi|51890299|emb|CAH04223.1| coat protein [Sulfolobus virus STSV1]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=144)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 181.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 74.3294)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.03476e-12)
        self.assertEqual(hsp.annotations["identity"], 36)
        self.assertEqual(hsp.annotations["positive"], 49)
        self.assertEqual(hsp.annotations["gaps"], 1)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 70, 70, 76],
                              [ 0, 70, 71, 77]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 77))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({0: 'MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...GFQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MAREEPYKGDYVGGVAKILQGYFANYYGFPNVSLRLAGEEANLSKTGHANAKAI...GFK'}, length=144)",
        )
        self.assertEqual(hsp.target.id, "gi|51980166|ref|YP_077233.1|")
        self.assertEqual(hsp.target.name, "YP_077233")
        self.assertEqual(
            hsp.target.description,
            "coat protein [Sulfolobus virus STSV1] >gi|51890299|emb|CAH04223.1| coat protein [Sulfolobus virus STSV1]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MA+ EP KGDY GG  KIL  +     G+P V+L+LAGEEAN  + G    K  +H ++K+I +A KP R +G GF+",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|519801         0 MAREEPYKGDYVGGVAKILQGYFANYYGFPNVSLRLAGEEANLSKTGHANAKAIVHEMIK
                  0 ||..||.||||.||..|||........|.|.|.|.|||||||....|....|...|...|
lcl|QUERY         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK

gi|519801        60 VIKEASKPLR-RGKGFK 76
                 60 .|..|.||.|-.|.||. 77
lcl|QUERY        60 MISDAMKPYRNKGSGFQ 77
""",
        )
        hit = record[2]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|70606448|ref|YP_255318.1|")
        self.assertEqual(hit.target.name, "YP_255318")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein Saci_0636 [Sulfolobus acidocaldarius DSM 639] >gi|68567096|gb|AAY80025.1| hypothetical protein Saci_0636 [Sulfolobus acidocaldarius DSM 639]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=90)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 106.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 45.4394)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.00184433)
        self.assertEqual(hsp.annotations["identity"], 22)
        self.assertEqual(hsp.annotations["positive"], 37)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 65],
                              [ 0, 65]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 65))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({0: 'MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...SDA'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MMELKHKKEEYAKELINLLSRFMSGKISYPVLSLRLTGIEAKVHESGFEDLVRL...REA'}, length=90)",
        )
        self.assertEqual(hsp.target.id, "gi|70606448|ref|YP_255318.1|")
        self.assertEqual(hsp.target.name, "YP_255318")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein Saci_0636 [Sulfolobus acidocaldarius DSM 639] >gi|68567096|gb|AAY80025.1| hypothetical protein Saci_0636 [Sulfolobus acidocaldarius DSM 639]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "M + + KK +YA   + +L  F +G++ YP ++L+L G EA    +G E     IH ++K I +A",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|706064         0 MMELKHKKEEYAKELINLLSRFMSGKISYPVLSLRLTGIEAKVHESGFEDLVRLIHELLK
                  0 |.....||..||......|..|..|...||...|.|.|.||.....|.|.....||...|
lcl|QUERY         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK

gi|706064        60 AIREA 65
                 60 .|..| 65
lcl|QUERY        60 MISDA 65
""",
        )
        hit = record[3]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|75750440|ref|YP_319873.1|")
        self.assertEqual(hit.target.name, "YP_319873")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein ATV_gp42 [Acidianus two-tailed virus] >gi|74474823|emb|CAI59897.1| hypothetical protein [Acidianus two-tailed virus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=145)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 102.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 43.8986)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.00527737)
        self.assertEqual(hsp.annotations["identity"], 30)
        self.assertEqual(hsp.annotations["positive"], 42)
        self.assertEqual(hsp.annotations["gaps"], 6)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[20, 50, 50, 72, 72, 87, 89, 93],
                              [21, 51, 52, 74, 77, 92, 92, 96]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 77))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({21: 'FENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSG...EYQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({20: 'FYEGVIGYPEIDLRLAGEEAWLKGVNPELAEAVKKIIKTIRRYLEGSPYDGSEK...EVQ'}, length=145)",
        )
        self.assertEqual(hsp.target.id, "gi|75750440|ref|YP_319873.1|")
        self.assertEqual(hsp.target.name, "YP_319873")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein ATV_gp42 [Acidianus two-tailed virus] >gi|74474823|emb|CAI59897.1| hypothetical protein [Acidianus two-tailed virus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "F  G +GYPE+ L+LAGEEA  +    E   EA+  I+K I   ++     GS    +PIP  +IA++ S   PE Q",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|757504        20 FYEGVIGYPEIDLRLAGEEAWLKGVNPELA-EAVKKIIKTIRRYLEGSPYDGS---EKPI
                  0 |..|..||||..|.||||||.......|..-||...|.|.|..........||---..||
lcl|QUERY        21 FENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPI

gi|757504        76 PRYIIAEIFSQIAPEVQ 93
                 60 |...||...|.--||.| 77
lcl|QUERY        81 PGEVIAQVTSN--PEYQ 96
""",
        )
        hit = record[4]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|149720683|ref|XP_001495622.1|")
        self.assertEqual(hit.target.name, "XP_001495622")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: similar to P2X7 receptor [Equus caballus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=595)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 79.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 35.039)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.35127)
        self.assertEqual(hsp.annotations["identity"], 17)
        self.assertEqual(hsp.annotations["positive"], 30)
        self.assertEqual(hsp.annotations["gaps"], 2)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 40,  69,  71,  87],
                              [ 84, 113, 113, 129]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 47))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({84: 'VIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQAM'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({40: 'VIFALVSDKRYQRKEPLISSVHTKVKGIAEVREEIIESGAKKVVQSV'}, length=595)",
        )
        self.assertEqual(hsp.target.id, "gi|149720683|ref|XP_001495622.1|")
        self.assertEqual(hsp.target.name, "XP_001495622")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: similar to P2X7 receptor [Equus caballus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "VI  + S+  YQ+ +  ++S  T+V+ I   REE++  GAKK+ Q++",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|149720        40 VIFALVSDKRYQRKEPLISSVHTKVKGIAEVREEIIESGAKKVVQSV  87
                  0 ||....|...||.......|..|.|..|.--|||....||||..|..  47
lcl|QUERY        84 VIAQVTSNPEYQQAKAFLASPATQVRNIE--REEVLSKGAKKLAQAM 129
""",
        )
        hit = record[5]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|229220336|ref|ZP_03838482.2|")
        self.assertEqual(hit.target.name, "ZP_03838482")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein CIT292_04594 [Citrobacter youngae ATCC 29220] >gi|228553887|gb|EEK18552.1| hypothetical protein CIT292_04594 [Citrobacter youngae ATCC 29220]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=208)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 78.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 34.6538)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.99494)
        self.assertEqual(hsp.annotations["identity"], 23)
        self.assertEqual(hsp.annotations["positive"], 42)
        self.assertEqual(hsp.annotations["gaps"], 9)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 59,  71,  71,  98, 102, 138],
                              [  8,  20,  25,  52,  52,  88]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 84))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({8: 'GDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMI...IAQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({59: 'GEVVGGAISTALSIGGPQIAKGVSKTERNARRAVQEEAKNLSGESLNSFMKLNE...VSQ'}, length=208)",
        )
        self.assertEqual(hsp.target.id, "gi|229220336|ref|ZP_03838482.2|")
        self.assertEqual(hsp.target.name, "ZP_03838482")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein CIT292_04594 [Citrobacter youngae ATCC 29220] >gi|228553887|gb|EEK18552.1| hypothetical protein CIT292_04594 [Citrobacter youngae ATCC 29220]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "G+  GGA+          +G P++   ++  E NARRA  E  K    E++++ +K+    + P+RN     Q  P  G++++Q",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|229220        59 GEVVGGAISTAL-----SIGGPQIAKGVSKTERNARRAVQEEAKNLSGESLNSFMKLNEK
                  0 |...|||.....-----..|.|.........|.|||||..|..|----|......|....
lcl|QUERY         8 GDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTK----EAIHAIVKMISD

gi|229220       114 KLTPHRNFEILGQCSPAIGQLVSQ 138
                 60 ...|.||.....|..|..|....|  84
lcl|QUERY        64 AMKPYRNKGSGFQSQPIPGEVIAQ  88
""",
        )
        hit = record[6]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|167646253|ref|YP_001683916.1|")
        self.assertEqual(hit.target.name, "YP_001683916")
        self.assertEqual(
            hit.target.description,
            "activator of Hsp90 ATPase 1 family protein [Caulobacter sp. K31] >gi|167348683|gb|ABZ71418.1| Activator of Hsp90 ATPase 1 family protein [Caulobacter sp. K31]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=155)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 78.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 34.6538)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.12253)
        self.assertEqual(hsp.annotations["identity"], 16)
        self.assertEqual(hsp.annotations["positive"], 24)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 44,  92],
                              [ 58, 106]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 48))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({58: 'VKMISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQAKAFLASPA'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({44: 'VKMLVKTTSDRRRKDSGRITQLVPGEAITFTTGNPMLKHTECYTLTPS'}, length=155)",
        )
        self.assertEqual(hsp.target.id, "gi|167646253|ref|YP_001683916.1|")
        self.assertEqual(hsp.target.name, "YP_001683916")
        self.assertEqual(
            hsp.target.description,
            "activator of Hsp90 ATPase 1 family protein [Caulobacter sp. K31] >gi|167348683|gb|ABZ71418.1| Activator of Hsp90 ATPase 1 family protein [Caulobacter sp. K31]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "VKM+       R K SG  +Q +PGE I   T NP  +  + +  +P+",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|167646        44 VKMLVKTTSDRRRKDSGRITQLVPGEAITFTTGNPMLKHTECYTLTPS  92
                  0 |||........|.|.||...|..|||.|...|.||...........|.  48
lcl|QUERY        58 VKMISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQAKAFLASPA 106
""",
        )
        hit = record[7]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|46114422|ref|XP_383229.1|")
        self.assertEqual(hit.target.name, "XP_383229")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein FG03053.1 [Gibberella zeae PH-1]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=263)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 77.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 34.2686)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.07814)
        self.assertEqual(hsp.annotations["identity"], 26)
        self.assertEqual(hsp.annotations["positive"], 40)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 85, 118, 118, 127, 127, 151, 151, 169],
                              [ 34,  67,  68,  77,  79, 103, 105, 123]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 89))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({34: 'KLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPGEVIAQ...GAK'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({85: 'KLTTLKRRLRYEAKELRKEALRQIVSKLRSWMKLRDFGCGVKPLIESSLPEIAT...GSR'}, length=263)",
        )
        self.assertEqual(hsp.target.id, "gi|46114422|ref|XP_383229.1|")
        self.assertEqual(hsp.target.name, "XP_383229")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein FG03053.1 [Gibberella zeae PH-1]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "KL   +   R    E  KEA+  IV  +   MK  R+ G G +  P+    + ++ +NP Y Q   +L       R IER   + KG++",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|461144        85 KLTTLKRRLRYEAKELRKEALRQIVSKLRSWMK-LRDFGCGVK--PLIESSLPEIATNPH
                  0 ||.......|....|..|||...||......||-.|..|.|..--|...........||.
lcl|QUERY        34 KLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPE

gi|461144       142 YNQTSLYLT--MNHPRRIERVSRVIKGSR 169
                 60 |.|....|.--....|.|||.....||..  89
lcl|QUERY        94 YQQAKAFLASPATQVRNIEREEVLSKGAK 123
""",
        )
        hit = record[8]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|16804655|ref|NP_466140.1|")
        self.assertEqual(hit.target.name, "NP_466140")
        self.assertEqual(
            hit.target.description,
            "50S ribosomal protein L6 [Listeria monocytogenes EGD-e] >gi|47097188|ref|ZP_00234753.1| ribosomal protein L6 [Listeria monocytogenes str. 1/2a F6854] >gi|217966184|ref|YP_002351862.1| 50S ribosomal protein L6 (BL10) [Listeria monocytogenes HCC23] >gi|224499290|ref|ZP_03667639.1| 50S ribosomal protein L6 [Listeria monocytogenes Finland 1988] >gi|224503589|ref|ZP_03671896.1| 50S ribosomal protein L6 [Listeria monocytogenes FSL R2-561] >gi|81768735|sp|Q8Y444.1|RL6_LISMO RecName: Full=50S ribosomal protein L6 >gi|16412105|emb|CAD00695.1| ribosomal protein L6 [Listeria monocytogenes] >gi|47014447|gb|EAL05415.1| ribosomal protein L6 [Listeria monocytogenes str. 1/2a F6854] >gi|217335454|gb|ACK41248.1| 50S ribosomal protein L6 (BL10) [Listeria monocytogenes HCC23]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=178)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 77.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 34.2686)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.14677)
        self.assertEqual(hsp.annotations["identity"], 26)
        self.assertEqual(hsp.annotations["positive"], 44)
        self.assertEqual(hsp.annotations["gaps"], 13)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 38,  75,  80,  86,  90, 108, 108, 138],
                              [ 29,  66,  66,  72,  72,  90,  94, 124]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 104))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({29: 'PEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPG...AKK'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({38: 'PEITIKIEGNEINVSRPTDNKNHRALHGTTRAILNNMVVGVSEGYEKKLELIGV...YNK'}, length=178)",
        )
        self.assertEqual(hsp.target.id, "gi|16804655|ref|NP_466140.1|")
        self.assertEqual(hsp.target.name, "NP_466140")
        self.assertEqual(
            hsp.target.description,
            "50S ribosomal protein L6 [Listeria monocytogenes EGD-e] >gi|47097188|ref|ZP_00234753.1| ribosomal protein L6 [Listeria monocytogenes str. 1/2a F6854] >gi|217966184|ref|YP_002351862.1| 50S ribosomal protein L6 (BL10) [Listeria monocytogenes HCC23] >gi|224499290|ref|ZP_03667639.1| 50S ribosomal protein L6 [Listeria monocytogenes Finland 1988] >gi|224503589|ref|ZP_03671896.1| 50S ribosomal protein L6 [Listeria monocytogenes FSL R2-561] >gi|81768735|sp|Q8Y444.1|RL6_LISMO RecName: Full=50S ribosomal protein L6 >gi|16412105|emb|CAD00695.1| ribosomal protein L6 [Listeria monocytogenes] >gi|47014447|gb|EAL05415.1| ribosomal protein L6 [Listeria monocytogenes str. 1/2a F6854] >gi|217335454|gb|ACK41248.1| 50S ribosomal protein L6 (BL10) [Listeria monocytogenes HCC23]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "PE+T+K+ G E N  R  D +   A+H   + I + M     + Y  K    G G+++Q    +++  V     Y     F+A     +      +V+ KG  K",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|168046        38 PEITIKIEGNEINVSRPTDNKNHRALHGTTRAILNNMVVGVSEGYEKKLELIGVGYRAQK
                  0 ||.|.|..|.|.|..|..|.....|.|.....|...|-----..|..|----|.|...|.
lcl|QUERY        29 PEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAM-----KPYRNK----GSGFQSQP

gi|168046        98 QGDKLVLNVG----YSHPVEFVAPKGVDIEVPANTQVIVKGYNK 138
                 60 ........|.----|.....|.|.............|..||..| 104
lcl|QUERY        80 IPGEVIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKK 124
""",
        )
        hit = record[9]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|225106043|ref|YP_002674349.1|")
        self.assertEqual(hit.target.name, "YP_002674349")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein OA307_717 [Octadecabacter antarcticus 307] >gi|198251380|gb|EDY75695.1| hypothetical protein OA307_717 [Octadecabacter antarcticus 307]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=202)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 76.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 33.8834)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.81876)
        self.assertEqual(hsp.annotations["identity"], 23)
        self.assertEqual(hsp.annotations["positive"], 38)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 8, 16, 21, 92],
                              [ 0,  8,  8, 79]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 84))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({0: 'MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...QSQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({8: 'MRKIEPKKMTATERKHWGFGVDAIRMMENELMGYLHEYRALPLEWDEIWKDEDR...QAR'}, length=202)",
        )
        self.assertEqual(hsp.target.id, "gi|225106043|ref|YP_002674349.1|")
        self.assertEqual(hsp.target.name, "YP_002674349")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein OA307_717 [Octadecabacter antarcticus 307] >gi|198251380|gb|EDY75695.1| hypothetical protein OA307_717 [Octadecabacter antarcticus 307]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "M K EPKK       + G  V  + M EN  +GY      L  E     +  D R  +     +++ +D +K +R  G+G+Q++",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|225106         8 MRKIEPKKMTATERKHWGFGVDAIRMMENELMGYLHEYRALPLEWDEIWKDEDRRDPKRT
                  0 |.|.||||-----....|..|....|.||...||......|..|........|.|.....
lcl|QUERY         0 MAKYEPKK-----GDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAI

gi|225106        68 RVTIRLDADVVKYFRAMGAGYQAR 92
                 60 ........|..|..|..|.|.|.. 84
lcl|QUERY        55 HAIVKMISDAMKPYRNKGSGFQSQ 79
""",
        )
        hit = record[10]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|16801827|ref|NP_472095.1|")
        self.assertEqual(hit.target.name, "NP_472095")
        self.assertEqual(
            hit.target.description,
            "50S ribosomal protein L6 [Listeria innocua Clip11262] >gi|116873983|ref|YP_850764.1| 50S ribosomal protein L6 [Listeria welshimeri serovar 6b str. SLCC5334] >gi|81774192|sp|Q927M2.1|RL6_LISIN RecName: Full=50S ribosomal protein L6 >gi|123458730|sp|A0ALV3.1|RL6_LISW6 RecName: Full=50S ribosomal protein L6 >gi|16415302|emb|CAC97992.1| ribosomal protein L6 [Listeria innocua] >gi|116742861|emb|CAK21985.1| rplF [Listeria welshimeri serovar 6b str. SLCC5334]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=178)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 74.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 33.113)
        self.assertAlmostEqual(hsp.annotations["evalue"], 9.08516)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 44)
        self.assertEqual(hsp.annotations["gaps"], 13)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 38,  75,  80,  86,  90, 108, 108, 138],
                              [ 29,  66,  66,  72,  72,  90,  94, 124]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 104))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({29: 'PEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPG...AKK'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({38: 'PEITINIEGNEINVSRPTDNKNHRALHGTTRAILNNMVVGVSEGYEKKLELIGV...YNK'}, length=178)",
        )
        self.assertEqual(hsp.target.id, "gi|16801827|ref|NP_472095.1|")
        self.assertEqual(hsp.target.name, "NP_472095")
        self.assertEqual(
            hsp.target.description,
            "50S ribosomal protein L6 [Listeria innocua Clip11262] >gi|116873983|ref|YP_850764.1| 50S ribosomal protein L6 [Listeria welshimeri serovar 6b str. SLCC5334] >gi|81774192|sp|Q927M2.1|RL6_LISIN RecName: Full=50S ribosomal protein L6 >gi|123458730|sp|A0ALV3.1|RL6_LISW6 RecName: Full=50S ribosomal protein L6 >gi|16415302|emb|CAC97992.1| ribosomal protein L6 [Listeria innocua] >gi|116742861|emb|CAK21985.1| rplF [Listeria welshimeri serovar 6b str. SLCC5334]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "PE+T+ + G E N  R  D +   A+H   + I + M     + Y  K    G G+++Q    +++  V     Y     F+A    ++      +V+ KG  K",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|168018        38 PEITINIEGNEINVSRPTDNKNHRALHGTTRAILNNMVVGVSEGYEKKLELIGVGYRAQK
                  0 ||.|....|.|.|..|..|.....|.|.....|...|-----..|..|----|.|...|.
lcl|QUERY        29 PEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAM-----KPYRNK----GSGFQSQP

gi|168018        98 QGDKLVLNVG----YSHPVEFVAPKGVEIEVPANTQVIVKGYNK 138
                 60 ........|.----|.....|.|.............|..||..| 104
lcl|QUERY        80 IPGEVIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKK 124
""",
        )
        record = next(records)
        self.assertIsNone(record.query)
        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 2563094)
        self.assertEqual(record.stat["db-len"], 864488805)
        self.assertEqual(record.stat["hsp-len"], 96)
        self.assertAlmostEqual(record.stat["eff-space"], 80278100000.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.0413587)
        self.assertAlmostEqual(record.stat["lambda"], 0.267)
        self.assertAlmostEqual(record.stat["entropy"], 0.14)
        self.assertEqual(len(record), 19)
        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|75750454|ref|YP_319893.1|")
        self.assertEqual(hit.target.name, "YP_319893")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein ATV_gp62 [Acidianus two-tailed virus] >gi|74474837|emb|CAI59911.1| hypothetical protein [Acidianus two-tailed virus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=131)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 590.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 231.867)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.28615e-59)
        self.assertEqual(hsp.annotations["identity"], 131)
        self.assertEqual(hsp.annotations["positive"], 131)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 131],
                              [  0, 131]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 131))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...MAS')",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...MAS')",
        )
        self.assertEqual(hsp.target.id, "gi|75750454|ref|YP_319893.1|")
        self.assertEqual(hsp.target.name, "YP_319893")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein ATV_gp62 [Acidianus two-tailed virus] >gi|74474837|emb|CAI59911.1| hypothetical protein [Acidianus two-tailed virus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQAMAS",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|757504         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|QUERY         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK

gi|757504        60 MISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSK
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|QUERY        60 MISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSK

gi|757504       120 GAKKLAQAMAS 131
                120 ||||||||||| 131
lcl|QUERY       120 GAKKLAQAMAS 131
""",
        )
        hit = record[1]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|51980166|ref|YP_077233.1|")
        self.assertEqual(hit.target.name, "YP_077233")
        self.assertEqual(
            hit.target.description,
            "coat protein [Sulfolobus virus STSV1] >gi|51890299|emb|CAH04223.1| coat protein [Sulfolobus virus STSV1]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=144)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 346.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 137.878)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.63528e-31)
        self.assertEqual(hsp.annotations["identity"], 36)
        self.assertEqual(hsp.annotations["positive"], 49)
        self.assertEqual(hsp.annotations["gaps"], 1)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 70, 70, 76],
                              [ 0, 70, 71, 77]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 77))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({0: 'MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...GFQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MAREEPYKGDYVGGVAKILQGYFANYYGFPNVSLRLAGEEANLSKTGHANAKAI...GFK'}, length=144)",
        )
        self.assertEqual(hsp.target.id, "gi|51980166|ref|YP_077233.1|")
        self.assertEqual(hsp.target.name, "YP_077233")
        self.assertEqual(
            hsp.target.description,
            "coat protein [Sulfolobus virus STSV1] >gi|51890299|emb|CAH04223.1| coat protein [Sulfolobus virus STSV1]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MA+ EP KGDY GG  KIL  +     G+P V+L+LAGEEAN  + G    K  +H ++K+I +A KP R +G GF+",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|519801         0 MAREEPYKGDYVGGVAKILQGYFANYYGFPNVSLRLAGEEANLSKTGHANAKAIVHEMIK
                  0 ||..||.||||.||..|||........|.|.|.|.|||||||....|....|...|...|
lcl|QUERY         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK

gi|519801        60 VIKEASKPLR-RGKGFK 76
                 60 .|..|.||.|-.|.||. 77
lcl|QUERY        60 MISDAMKPYRNKGSGFQ 77
""",
        )
        hit = record[2]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|75750440|ref|YP_319873.1|")
        self.assertEqual(hit.target.name, "YP_319873")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein ATV_gp42 [Acidianus two-tailed virus] >gi|74474823|emb|CAI59897.1| hypothetical protein [Acidianus two-tailed virus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=145)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 118.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 50.0528)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.16661e-05)
        self.assertEqual(hsp.annotations["identity"], 34)
        self.assertEqual(hsp.annotations["positive"], 48)
        self.assertEqual(hsp.annotations["gaps"], 8)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 6,  9,  9, 50, 50, 72, 72, 87, 89, 93],
                              [ 5,  8, 10, 51, 52, 74, 77, 92, 92, 96]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 93))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({5: 'PKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIV...EYQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({6: 'PQKYETHVLDDLMEFYEGVIGYPEIDLRLAGEEAWLKGVNPELAEAVKKIIKTI...EVQ'}, length=145)",
        )
        self.assertEqual(hsp.target.id, "gi|75750440|ref|YP_319873.1|")
        self.assertEqual(hsp.target.name, "YP_319873")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein ATV_gp42 [Acidianus two-tailed virus] >gi|74474823|emb|CAI59897.1| hypothetical protein [Acidianus two-tailed virus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "P+K  Y    +  L  F  G +GYPE+ L+LAGEEA  +    E   EA+  I+K I   ++     GS    +PIP  +IA++ S   PE Q",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|757504         6 PQK--YETHVLDDLMEFYEGVIGYPEIDLRLAGEEAWLKGVNPELA-EAVKKIIKTIRRY
                  0 |.|--|.......|..|..|..||||..|.||||||.......|..-||...|.|.|...
lcl|QUERY         5 PKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDA

gi|757504        63 LEGSPYDGS---EKPIPRYIIAEIFSQIAPEVQ 93
                 60 .......||---..|||...||...|.--||.| 93
lcl|QUERY        65 MKPYRNKGSGFQSQPIPGEVIAQVTSN--PEYQ 96
""",
        )
        hit = record[3]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|70606448|ref|YP_255318.1|")
        self.assertEqual(hit.target.name, "YP_255318")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein Saci_0636 [Sulfolobus acidocaldarius DSM 639] >gi|68567096|gb|AAY80025.1| hypothetical protein Saci_0636 [Sulfolobus acidocaldarius DSM 639]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=90)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 112.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 47.7416)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.000338308)
        self.assertEqual(hsp.annotations["identity"], 22)
        self.assertEqual(hsp.annotations["positive"], 38)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 67],
                              [ 0, 67]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 67))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({0: 'MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...AMK'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MMELKHKKEEYAKELINLLSRFMSGKISYPVLSLRLTGIEAKVHESGFEDLVRL...AER'}, length=90)",
        )
        self.assertEqual(hsp.target.id, "gi|70606448|ref|YP_255318.1|")
        self.assertEqual(hsp.target.name, "YP_255318")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein Saci_0636 [Sulfolobus acidocaldarius DSM 639] >gi|68567096|gb|AAY80025.1| hypothetical protein Saci_0636 [Sulfolobus acidocaldarius DSM 639]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "M + + KK +YA   + +L  F +G++ YP ++L+L G EA    +G E     IH ++K I +A +",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|706064         0 MMELKHKKEEYAKELINLLSRFMSGKISYPVLSLRLTGIEAKVHESGFEDLVRLIHELLK
                  0 |.....||..||......|..|..|...||...|.|.|.||.....|.|.....||...|
lcl|QUERY         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK

gi|706064        60 AIREAER 67
                 60 .|..|.. 67
lcl|QUERY        60 MISDAMK 67
""",
        )
        hit = record[4]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|56478923|ref|YP_160512.1|")
        self.assertEqual(hit.target.name, "YP_160512")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein ebA6101 [Aromatoleum aromaticum EbN1] >gi|56314966|emb|CAI09611.1| conserved hypothetical protein [Azoarcus sp. EbN1]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=326)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 85.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 37.3412)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.461067)
        self.assertEqual(hsp.annotations["identity"], 21)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 11)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[141, 148, 148, 170, 172, 203, 205, 209, 211, 217],
                              [  8,  15,  20,  42,  42,  73,  73,  77,  77,  83]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 81))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({8: 'GDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMI...IPG'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({141: 'GDHVGGLGDSAGQMVFPNATIHVAQTDNDFWLSPQMAAQAPAEIQPFFKMAVDA...VPG'}, length=326)",
        )
        self.assertEqual(hsp.target.id, "gi|56478923|ref|YP_160512.1|")
        self.assertEqual(hsp.target.name, "YP_160512")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein ebA6101 [Aromatoleum aromaticum EbN1] >gi|56314966|emb|CAI09611.1| conserved hypothetical protein [Azoarcus sp. EbN1]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "GD+ GG          GQ+ +P  T+ +A  + +         +    I    KM  DA  PY+ +G    F   S+ +PG",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|564789       141 GDHVGGL-----GDSAGQMVFPNATIHVAQTDNDFWLSPQMAAQAPAEIQPFFKMAVDAA
                  0 ||..||.-----....||...|..|...|.....--............|....||..||.
lcl|QUERY         8 GDYAGGAVKILDMFENGQLGYPEVTLKLAGEEAN--ARRAGDERTKEAIHAIVKMISDAM

gi|564789       196 APYQARGQWKTFAEGSEVVPG 217
                 60 .||...|--..|.--|...||  81
lcl|QUERY        66 KPYRNKG--SGFQ--SQPIPG  83
""",
        )
        hit = record[5]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|16082535|ref|NP_394071.1|")
        self.assertEqual(hit.target.name, "NP_394071")
        self.assertEqual(
            hit.target.description,
            "deoxycytidine triphosphate deaminase [Thermoplasma acidophilum DSM 1728] >gi|20141306|sp|Q9HKK0.2|DCD_THEAC RecName: Full=Probable deoxycytidine triphosphate deaminase; Short=dCTP deaminase",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=166)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 82.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 36.1856)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.960826)
        self.assertEqual(hsp.annotations["identity"], 22)
        self.assertEqual(hsp.annotations["positive"], 30)
        self.assertEqual(hsp.annotations["gaps"], 10)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 94, 117, 117, 124, 124, 146, 152, 160],
                              [ 23,  46,  48,  55,  57,  79,  79,  87]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 70))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({23: 'NGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQ...VIA'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({94: 'AGYHGNLTLSFFNAGSAVNLRRGERIAQIVFVKMIGSAEKPYHIRSGNYQNSRG...QIA'}, length=166)",
        )
        self.assertEqual(hsp.target.id, "gi|16082535|ref|NP_394071.1|")
        self.assertEqual(hsp.target.name, "NP_394071")
        self.assertEqual(
            hsp.target.description,
            "deoxycytidine triphosphate deaminase [Thermoplasma acidophilum DSM 1728] >gi|20141306|sp|Q9HKK0.2|DCD_THEAC RecName: Full=Probable deoxycytidine triphosphate deaminase; Short=dCTP deaminase",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            " G  G   ++   AG   N RR   ER  + +   VKMI  A KPY  +   +Q+       P+ G  IA",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|160825        94 AGYHGNLTLSFFNAGSAVNLRRG--ERIAQIV--FVKMIGSAEKPYHIRSGNYQNSRGIV
                  0 .|..|........||...|.||.--||.....--.||||..|.|||.......|..----
lcl|QUERY        23 NGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQ----

gi|160825       150 KDPVAGSQIA 160
                 60 --|..|..||  70
lcl|QUERY        79 --PIPGEVIA  87
""",
        )
        hit = record[6]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|10639765|emb|CAC11737.1|")
        self.assertEqual(hit.target.name, "CAC11737")
        self.assertEqual(
            hit.target.description,
            "dCTP deaminase related protein [Thermoplasma acidophilum]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=183)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 82.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 36.1856)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.960826)
        self.assertEqual(hsp.annotations["identity"], 22)
        self.assertEqual(hsp.annotations["positive"], 30)
        self.assertEqual(hsp.annotations["gaps"], 10)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[111, 134, 134, 141, 141, 163, 169, 177],
                              [ 23,  46,  48,  55,  57,  79,  79,  87]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 70))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({23: 'NGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQ...VIA'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({111: 'AGYHGNLTLSFFNAGSAVNLRRGERIAQIVFVKMIGSAEKPYHIRSGNYQNSRG...QIA'}, length=183)",
        )
        self.assertEqual(hsp.target.id, "gi|10639765|emb|CAC11737.1|")
        self.assertEqual(hsp.target.name, "CAC11737")
        self.assertEqual(
            hsp.target.description,
            "dCTP deaminase related protein [Thermoplasma acidophilum]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            " G  G   ++   AG   N RR   ER  + +   VKMI  A KPY  +   +Q+       P+ G  IA",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|106397       111 AGYHGNLTLSFFNAGSAVNLRRG--ERIAQIV--FVKMIGSAEKPYHIRSGNYQNSRGIV
                  0 .|..|........||...|.||.--||.....--.||||..|.|||.......|..----
lcl|QUERY        23 NGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQ----

gi|106397       167 KDPVAGSQIA 177
                 60 --|..|..||  70
lcl|QUERY        79 --PIPGEVIA  87
""",
        )
        hit = record[7]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|38511961|gb|AAH60735.1|")
        self.assertEqual(hit.target.name, "AAH60735")
        self.assertEqual(hit.target.description, "Ttc28 protein [Mus musculus]")
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1370)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 82.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 36.1856)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.01015)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 45)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[738, 782, 784, 811, 811, 838],
                              [ 26,  70,  70,  97, 100, 127]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 103))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({26: 'LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQP...LAQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({738: 'LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFAS...ASR'}, length=1370)",
        )
        self.assertEqual(hsp.target.id, "gi|38511961|gb|AAH60735.1|")
        self.assertEqual(hsp.target.name, "AAH60735")
        self.assertEqual(hsp.target.description, "Ttc28 protein [Mus musculus]")
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "LG P   L+   +   A   G++    A+  +V M+   +   +   K   F S PIP  +  Q+   P   +   FLA+    +  + +EEV+ K  K+ ++",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|385119       738 LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFASAPIPVS
                  0 ||.|...|........|...|......|....|.|.........--.|...|.|.|||..
lcl|QUERY        26 LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYR--NKGSGFQSQPIPGE

gi|385119       798 LSVQLWRLPGCHE---FLAALGFDLCEVGQEEVILKTGKQASR 838
                 60 ...|....|....---|||...........|||..|..|.... 103
lcl|QUERY        84 VIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQ 127
""",
        )
        hit = record[8]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|71153789|sp|Q80XJ3.2|TTC28_MOUSE")
        self.assertEqual(hit.target.name, "Q80XJ3")
        self.assertEqual(
            hit.target.description,
            "RecName: Full=Tetratricopeptide repeat protein 28; Short=TPR repeat protein 28 >gi|55930902|gb|AAH46779.2| Tetratricopeptide repeat domain 28 [Mus musculus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1691)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 82.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 36.1856)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.12589)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 45)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[1059, 1103, 1105, 1132, 1132, 1159],
                              [  26,   70,   70,   97,  100,  127]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 103))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({26: 'LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQP...LAQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({1059: 'LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFAS...ASR'}, length=1691)",
        )
        self.assertEqual(hsp.target.id, "gi|71153789|sp|Q80XJ3.2|TTC28_MOUSE")
        self.assertEqual(hsp.target.name, "Q80XJ3")
        self.assertEqual(
            hsp.target.description,
            "RecName: Full=Tetratricopeptide repeat protein 28; Short=TPR repeat protein 28 >gi|55930902|gb|AAH46779.2| Tetratricopeptide repeat domain 28 [Mus musculus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "LG P   L+   +   A   G++    A+  +V M+   +   +   K   F S PIP  +  Q+   P   +   FLA+    +  + +EEV+ K  K+ ++",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|711537      1059 LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFASAPIPVS
                  0 ||.|...|........|...|......|....|.|.........--.|...|.|.|||..
lcl|QUERY        26 LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYR--NKGSGFQSQPIPGE

gi|711537      1119 LSVQLWRLPGCHE---FLAALGFDLCEVGQEEVILKTGKQASR 1159
                 60 ...|....|....---|||...........|||..|..|....  103
lcl|QUERY        84 VIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQ  127
""",
        )
        hit = record[9]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|149254322|ref|XP_001476594.1|")
        self.assertEqual(hit.target.name, "XP_001476594")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: similar to OTTHUMP00000028696 [Mus musculus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=2481)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 81.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 35.8004)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.23411)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 45)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[1849, 1893, 1895, 1922, 1922, 1949],
                              [  26,   70,   70,   97,  100,  127]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 103))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({26: 'LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQP...LAQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({1849: 'LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFAS...ASR'}, length=2481)",
        )
        self.assertEqual(hsp.target.id, "gi|149254322|ref|XP_001476594.1|")
        self.assertEqual(hsp.target.name, "XP_001476594")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: similar to OTTHUMP00000028696 [Mus musculus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "LG P   L+   +   A   G++    A+  +V M+   +   +   K   F S PIP  +  Q+   P   +   FLA+    +  + +EEV+ K  K+ ++",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|149254      1849 LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFASAPIPVS
                  0 ||.|...|........|...|......|....|.|.........--.|...|.|.|||..
lcl|QUERY        26 LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYR--NKGSGFQSQPIPGE

gi|149254      1909 LSVQLWRLPGCHE---FLAALGFDLCEVGQEEVILKTGKQASR 1949
                 60 ...|....|....---|||...........|||..|..|....  103
lcl|QUERY        84 VIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQ  127
""",
        )
        hit = record[10]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|148688047|gb|EDL19994.1|")
        self.assertEqual(hit.target.name, "EDL19994")
        self.assertEqual(
            hit.target.description, "tetratricopeptide repeat domain 28 [Mus musculus]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=2146)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 81.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 35.8004)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.24445)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 45)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[1514, 1558, 1560, 1587, 1587, 1614],
                              [  26,   70,   70,   97,  100,  127]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 103))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({26: 'LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQP...LAQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({1514: 'LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFAS...ASR'}, length=2146)",
        )
        self.assertEqual(hsp.target.id, "gi|148688047|gb|EDL19994.1|")
        self.assertEqual(hsp.target.name, "EDL19994")
        self.assertEqual(
            hsp.target.description, "tetratricopeptide repeat domain 28 [Mus musculus]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "LG P   L+   +   A   G++    A+  +V M+   +   +   K   F S PIP  +  Q+   P   +   FLA+    +  + +EEV+ K  K+ ++",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|148688      1514 LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFASAPIPVS
                  0 ||.|...|........|...|......|....|.|.........--.|...|.|.|||..
lcl|QUERY        26 LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYR--NKGSGFQSQPIPGE

gi|148688      1574 LSVQLWRLPGCHE---FLAALGFDLCEVGQEEVILKTGKQASR 1614
                 60 ...|....|....---|||...........|||..|..|....  103
lcl|QUERY        84 VIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQ  127
""",
        )
        hit = record[11]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|149063697|gb|EDM14020.1|")
        self.assertEqual(hit.target.name, "EDM14020")
        self.assertEqual(hit.target.description, "rCG21379 [Rattus norvegicus]")
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=2098)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 81.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 35.8004)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.41037)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 45)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[1465, 1509, 1511, 1538, 1538, 1565],
                              [  26,   70,   70,   97,  100,  127]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 103))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({26: 'LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQP...LAQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({1465: 'LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFAS...ASR'}, length=2098)",
        )
        self.assertEqual(hsp.target.id, "gi|149063697|gb|EDM14020.1|")
        self.assertEqual(hsp.target.name, "EDM14020")
        self.assertEqual(hsp.target.description, "rCG21379 [Rattus norvegicus]")
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "LG P   L+   +   A   G++    A+  +V M+   +   +   K   F S PIP  +  Q+   P   +   FLA+    +  + +EEV+ K  K+ ++",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|149063      1465 LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFASAPIPVS
                  0 ||.|...|........|...|......|....|.|.........--.|...|.|.|||..
lcl|QUERY        26 LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYR--NKGSGFQSQPIPGE

gi|149063      1525 LSVQLWRLPGCHE---FLAALGFDLCEVGQEEVILKTGKQASR 1565
                 60 ...|....|....---|||...........|||..|..|....  103
lcl|QUERY        84 VIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQ  127
""",
        )
        hit = record[12]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|163854616|ref|YP_001628914.1|")
        self.assertEqual(hit.target.name, "YP_001628914")
        self.assertEqual(
            hit.target.description,
            "metallo-beta-lactamase superfamily protein [Bordetella petrii DSM 12804] >gi|163258344|emb|CAP40643.1| metallo-beta-lactamase superfamily protein [Bordetella petrii]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=333)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 81.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 35.8004)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.45823)
        self.assertEqual(hsp.annotations["identity"], 15)
        self.assertEqual(hsp.annotations["positive"], 23)
        self.assertEqual(hsp.annotations["gaps"], 6)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[162, 176, 178, 216, 220, 223],
                              [ 28,  42,  42,  80,  80,  83]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 61))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({28: 'YPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPG'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({162: 'FPNADVYAARAEADFWLSTTVAAQAPADVQPMFKMSRDAAAPYQAAGKFLTYQP...LPG'}, length=333)",
        )
        self.assertEqual(hsp.target.id, "gi|163854616|ref|YP_001628914.1|")
        self.assertEqual(hsp.target.name, "YP_001628914")
        self.assertEqual(
            hsp.target.description,
            "metallo-beta-lactamase superfamily protein [Bordetella petrii DSM 12804] >gi|163258344|emb|CAP40643.1| metallo-beta-lactamase superfamily protein [Bordetella petrii]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "+P   +  A  EA+         +    +  + KM  DA  PY+  G     QP    +PG",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|163854       162 FPNADVYAARAEADFWLSTTVAAQAPADVQPMFKMSRDAAAPYQAAGKFLTYQPDDTLLP
                  0 .|......|..||.--.................||..||..||...|.....||----.|
lcl|QUERY        28 YPEVTLKLAGEEAN--ARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQP----IP

gi|163854       222 G 223
                 60 |  61
lcl|QUERY        82 G  83
""",
        )
        hit = record[13]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|109496198|ref|XP_222260.4|")
        self.assertEqual(hit.target.name, "XP_222260")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: similar to TPR repeat-containing protein KIAA1043 [Rattus norvegicus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=2570)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 81.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 35.8004)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.47045)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 45)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[1937, 1981, 1983, 2010, 2010, 2037],
                              [  26,   70,   70,   97,  100,  127]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 103))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({26: 'LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQP...LAQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({1937: 'LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFAS...ASR'}, length=2570)",
        )
        self.assertEqual(hsp.target.id, "gi|109496198|ref|XP_222260.4|")
        self.assertEqual(hsp.target.name, "XP_222260")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: similar to TPR repeat-containing protein KIAA1043 [Rattus norvegicus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "LG P   L+   +   A   G++    A+  +V M+   +   +   K   F S PIP  +  Q+   P   +   FLA+    +  + +EEV+ K  K+ ++",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|109496      1937 LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFASAPIPVS
                  0 ||.|...|........|...|......|....|.|.........--.|...|.|.|||..
lcl|QUERY        26 LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYR--NKGSGFQSQPIPGE

gi|109496      1997 LSVQLWRLPGCHE---FLAALGFDLCEVGQEEVILKTGKQASR 2037
                 60 ...|....|....---|||...........|||..|..|....  103
lcl|QUERY        84 VIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQ  127
""",
        )
        hit = record[14]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|26327341|dbj|BAC27414.1|")
        self.assertEqual(hit.target.name, "BAC27414")
        self.assertEqual(
            hit.target.description, "unnamed protein product [Mus musculus]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=682)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 80.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 35.4152)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.69454)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 45)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 50,  94,  96, 123, 123, 150],
                              [ 26,  70,  70,  97, 100, 127]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 103))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({26: 'LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQP...LAQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({50: 'LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFAS...ASR'}, length=682)",
        )
        self.assertEqual(hsp.target.id, "gi|26327341|dbj|BAC27414.1|")
        self.assertEqual(hsp.target.name, "BAC27414")
        self.assertEqual(
            hsp.target.description, "unnamed protein product [Mus musculus]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "LG P   L+   +   A   G++    A+  +V M+   +   +   K   F S PIP  +  Q+   P   +   FLA+    +  + +EEV+ K  K+ ++",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|263273        50 LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFASAPIPVS
                  0 ||.|...|........|...|......|....|.|.........--.|...|.|.|||..
lcl|QUERY        26 LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYR--NKGSGFQSQPIPGE

gi|263273       110 LSVQLWRLPGCHE---FLAALGFDLCEVGQEEVILKTGKQASR 150
                 60 ...|....|....---|||...........|||..|..|.... 103
lcl|QUERY        84 VIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQ 127
""",
        )
        hit = record[15]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|26349137|dbj|BAC38208.1|")
        self.assertEqual(hit.target.name, "BAC38208")
        self.assertEqual(
            hit.target.description, "unnamed protein product [Mus musculus]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=641)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 80.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 35.4152)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.842)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 45)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  9,  53,  55,  82,  82, 109],
                              [ 26,  70,  70,  97, 100, 127]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 103))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({26: 'LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQP...LAQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({9: 'LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFAS...ASR'}, length=641)",
        )
        self.assertEqual(hsp.target.id, "gi|26349137|dbj|BAC38208.1|")
        self.assertEqual(hsp.target.name, "BAC38208")
        self.assertEqual(
            hsp.target.description, "unnamed protein product [Mus musculus]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "LG P   L+   +   A   G++    A+  +V M+   +   +   K   F S PIP  +  Q+   P   +   FLA+    +  + +EEV+ K  K+ ++",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|263491         9 LGLPNPALQALCKLITASETGEQLISRAVKNMVGMLHQVLVQLQACEKEQDFASAPIPVS
                  0 ||.|...|........|...|......|....|.|.........--.|...|.|.|||..
lcl|QUERY        26 LGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYR--NKGSGFQSQPIPGE

gi|263491        69 LSVQLWRLPGCHE---FLAALGFDLCEVGQEEVILKTGKQASR 109
                 60 ...|....|....---|||...........|||..|..|.... 103
lcl|QUERY        84 VIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQ 127
""",
        )
        hit = record[16]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|194291978|ref|YP_002007885.1|")
        self.assertEqual(hit.target.name, "YP_002007885")
        self.assertEqual(
            hit.target.description,
            "non ribosomal peptide synthase, antibiotic synthesis; contains 3 condensation domains, 2 AMP-acid ligases II domains, 2 PP-binding, Phosphopantetheine attachment site [Cupriavidus taiwanensis] >gi|193225882|emb|CAQ71828.1| non ribosomal peptide synthase, antibiotic synthesis; contains 3 condensation domains, 2 AMP-acid ligases II domains, 2 PP-binding, Phosphopantetheine attachment site [Cupriavidus taiwanensis]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=2596)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 80.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 35.4152)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.95279)
        self.assertEqual(hsp.annotations["identity"], 28)
        self.assertEqual(hsp.annotations["positive"], 40)
        self.assertEqual(hsp.annotations["gaps"], 20)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[2334, 2340, 2340, 2354, 2360, 2374, 2376, 2395, 2395, 2402, 2402,
                               2417],
                              [  10,   16,   21,   35,   35,   49,   49,   68,   73,   80,   82,
                                 97]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 95))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({10: 'YAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISD...YQQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({2334: 'YVGGPALARGYLGRAALTADRFVPDPLAGDGARLYRTGDRVRRRADGVFEYLGR...VRQ'}, length=2596)",
        )
        self.assertEqual(hsp.target.id, "gi|194291978|ref|YP_002007885.1|")
        self.assertEqual(hsp.target.name, "YP_002007885")
        self.assertEqual(
            hsp.target.description,
            "non ribosomal peptide synthase, antibiotic synthesis; contains 3 condensation domains, 2 AMP-acid ligases II domains, 2 PP-binding, Phosphopantetheine attachment site [Cupriavidus taiwanensis] >gi|193225882|emb|CAQ71828.1| non ribosomal peptide synthase, antibiotic synthesis; contains 3 condensation domains, 2 AMP-acid ligases II domains, 2 PP-binding, Phosphopantetheine attachment site [Cupriavidus taiwanensis]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "Y GG          G LG   +T        LAG+ A   R GD   R  + +   +  + D +K       GF+ +P  GEV AQV + P+ +Q",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|194291      2334 YVGGPA-----LARGYLGRAALTADRFVPDPLAGDGARLYRTGDRVRRRADGVFEYLGRV
                  0 |.||..-----...|.||....|..------|||..|...|.||.--|............
lcl|QUERY        10 YAGGAVKILDMFENGQLGYPEVTLK------LAGEEANARRAGDE--RTKEAIHAIVKMI

gi|194291      2389 DDQVKI-----RGFRVEP--GEVAAQVAALPQVRQ 2417
                 60 .|..|.-----.||...|--|||.|||...|...|   95
lcl|QUERY        62 SDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQ   97
""",
        )
        hit = record[17]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|164498981|gb|ABY59058.1|")
        self.assertEqual(hit.target.name, "ABY59058")
        self.assertEqual(hit.target.description, "unknown [Mesorhizobium sp. F28]")
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=246)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 77.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 34.2596)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.90317)
        self.assertEqual(hsp.annotations["identity"], 14)
        self.assertEqual(hsp.annotations["positive"], 21)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 7, 55],
                              [ 7, 55]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 48))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({7: 'KGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAI'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({7: 'RGILVGLVAGILAFAFARVYGEPQVDKAIAFEEQQAQAAGEAPEEEIV'}, length=246)",
        )
        self.assertEqual(hsp.target.id, "gi|164498981|gb|ABY59058.1|")
        self.assertEqual(hsp.target.name, "ABY59058")
        self.assertEqual(hsp.target.description, "unknown [Mesorhizobium sp. F28]")
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "+G   G    IL        G P+V   +A EE  A+ AG+   +E +",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|164498         7 RGILVGLVAGILAFAFARVYGEPQVDKAIAFEEQQAQAAGEAPEEEIV 55
                  0 .|...|....||........|.|.|....|.||..|..||.....|.. 48
lcl|QUERY         7 KGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAI 55
""",
        )
        hit = record[18]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|189198988|ref|XP_001935831.1|")
        self.assertEqual(hit.target.name, "XP_001935831")
        self.assertEqual(
            hit.target.description,
            "predicted protein [Pyrenophora tritici-repentis Pt-1C-BFP] >gi|187982930|gb|EDU48418.1| predicted protein [Pyrenophora tritici-repentis Pt-1C-BFP]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1026)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 76.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 33.8744)
        self.assertAlmostEqual(hsp.annotations["evalue"], 5.35939)
        self.assertEqual(hsp.annotations["identity"], 14)
        self.assertEqual(hsp.annotations["positive"], 26)
        self.assertEqual(hsp.annotations["gaps"], 4)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[436, 463, 467, 492],
                              [ 28,  55,  55,  80]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 56))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({28: 'YPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQP'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({436: 'FPEVTMRGGGEESGLNLTQEGNTEDMVPPDYPESFPISSESSDYASEYGASFQSPP'}, length=1026)",
        )
        self.assertEqual(hsp.target.id, "gi|189198988|ref|XP_001935831.1|")
        self.assertEqual(hsp.target.name, "XP_001935831")
        self.assertEqual(
            hsp.target.description,
            "predicted protein [Pyrenophora tritici-repentis Pt-1C-BFP] >gi|187982930|gb|EDU48418.1| predicted protein [Pyrenophora tritici-repentis Pt-1C-BFP]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "+PEVT++  GEE+      +  T++ +         + S++       G+ FQS P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|189198       436 FPEVTMRGGGEESGLNLTQEGNTEDMVPPDYPESFPISSESSDYASEYGASFQSPP 492
                  0 .||||....|||..........|....----.......|.........|..|||.|  56
lcl|QUERY        28 YPEVTLKLAGEEANARRAGDERTKEAI----HAIVKMISDAMKPYRNKGSGFQSQP  80
""",
        )
        record = next(records)
        self.assertIsNone(record.query)
        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 2563094)
        self.assertEqual(record.stat["db-len"], 864488805)
        self.assertEqual(record.stat["hsp-len"], 96)
        self.assertAlmostEqual(record.stat["eff-space"], 80278100000.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.0433765)
        self.assertAlmostEqual(record.stat["lambda"], 0.267)
        self.assertAlmostEqual(record.stat["entropy"], 0.14)
        self.assertEqual(len(record), 9)
        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|75750454|ref|YP_319893.1|")
        self.assertEqual(hit.target.name, "YP_319893")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein ATV_gp62 [Acidianus two-tailed virus] >gi|74474837|emb|CAI59911.1| hypothetical protein [Acidianus two-tailed virus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=131)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 535.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 210.59)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.43623e-53)
        self.assertEqual(hsp.annotations["identity"], 131)
        self.assertEqual(hsp.annotations["positive"], 131)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 131],
                              [  0, 131]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 131))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...MAS')",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...MAS')",
        )
        self.assertEqual(hsp.target.id, "gi|75750454|ref|YP_319893.1|")
        self.assertEqual(hsp.target.name, "YP_319893")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein ATV_gp62 [Acidianus two-tailed virus] >gi|74474837|emb|CAI59911.1| hypothetical protein [Acidianus two-tailed virus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQAMAS",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|757504         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|QUERY         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK

gi|757504        60 MISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSK
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|QUERY        60 MISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSK

gi|757504       120 GAKKLAQAMAS 131
                120 ||||||||||| 131
lcl|QUERY       120 GAKKLAQAMAS 131
""",
        )
        hit = record[1]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|75750440|ref|YP_319873.1|")
        self.assertEqual(hit.target.name, "YP_319873")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein ATV_gp42 [Acidianus two-tailed virus] >gi|74474823|emb|CAI59897.1| hypothetical protein [Acidianus two-tailed virus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=145)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 312.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 124.69)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.62891e-27)
        self.assertEqual(hsp.annotations["identity"], 34)
        self.assertEqual(hsp.annotations["positive"], 48)
        self.assertEqual(hsp.annotations["gaps"], 8)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 4,  9,  9, 50, 50, 72, 72, 87, 89, 93],
                              [ 3,  8, 10, 51, 52, 74, 77, 92, 92, 96]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 95))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({3: 'YEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHA...EYQ'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({4: 'LHPQKYETHVLDDLMEFYEGVIGYPEIDLRLAGEEAWLKGVNPELAEAVKKIIK...EVQ'}, length=145)",
        )
        self.assertEqual(hsp.target.id, "gi|75750440|ref|YP_319873.1|")
        self.assertEqual(hsp.target.name, "YP_319873")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein ATV_gp42 [Acidianus two-tailed virus] >gi|74474823|emb|CAI59897.1| hypothetical protein [Acidianus two-tailed virus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "  P+K  Y    +  L  F  G +GYPE+ L+LAGEEA  +    E   EA+  I+K I   ++     GS    +PIP  +IA++ S   PE Q",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|757504         4 LHPQK--YETHVLDDLMEFYEGVIGYPEIDLRLAGEEAWLKGVNPELA-EAVKKIIKTIR
                  0 ..|.|--|.......|..|..|..||||..|.||||||.......|..-||...|.|.|.
lcl|QUERY         3 YEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMIS

gi|757504        61 RYLEGSPYDGS---EKPIPRYIIAEIFSQIAPEVQ 93
                 60 .........||---..|||...||...|.--||.| 95
lcl|QUERY        63 DAMKPYRNKGSGFQSQPIPGEVIAQVTSN--PEYQ 96
""",
        )
        hit = record[2]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|51980166|ref|YP_077233.1|")
        self.assertEqual(hit.target.name, "YP_077233")
        self.assertEqual(
            hit.target.description,
            "coat protein [Sulfolobus virus STSV1] >gi|51890299|emb|CAH04223.1| coat protein [Sulfolobus virus STSV1]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=144)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 298.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 119.298)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.0246e-25)
        self.assertEqual(hsp.annotations["identity"], 36)
        self.assertEqual(hsp.annotations["positive"], 49)
        self.assertEqual(hsp.annotations["gaps"], 1)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 70, 70, 77],
                              [ 0, 70, 71, 78]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 78))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({0: 'MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...FQS'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MAREEPYKGDYVGGVAKILQGYFANYYGFPNVSLRLAGEEANLSKTGHANAKAI...FKE'}, length=144)",
        )
        self.assertEqual(hsp.target.id, "gi|51980166|ref|YP_077233.1|")
        self.assertEqual(hsp.target.name, "YP_077233")
        self.assertEqual(
            hsp.target.description,
            "coat protein [Sulfolobus virus STSV1] >gi|51890299|emb|CAH04223.1| coat protein [Sulfolobus virus STSV1]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MA+ EP KGDY GG  KIL  +     G+P V+L+LAGEEAN  + G    K  +H ++K+I +A KP R +G GF+ ",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|519801         0 MAREEPYKGDYVGGVAKILQGYFANYYGFPNVSLRLAGEEANLSKTGHANAKAIVHEMIK
                  0 ||..||.||||.||..|||........|.|.|.|.|||||||....|....|...|...|
lcl|QUERY         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK

gi|519801        60 VIKEASKPLR-RGKGFKE 77
                 60 .|..|.||.|-.|.||.. 78
lcl|QUERY        60 MISDAMKPYRNKGSGFQS 78
""",
        )
        hit = record[3]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|70606448|ref|YP_255318.1|")
        self.assertEqual(hit.target.name, "YP_255318")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein Saci_0636 [Sulfolobus acidocaldarius DSM 639] >gi|68567096|gb|AAY80025.1| hypothetical protein Saci_0636 [Sulfolobus acidocaldarius DSM 639]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=90)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 242.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 97.7264)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.24619e-19)
        self.assertEqual(hsp.annotations["identity"], 26)
        self.assertEqual(hsp.annotations["positive"], 45)
        self.assertEqual(hsp.annotations["gaps"], 4)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 67, 67, 81],
                              [ 0, 67, 71, 85]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 85))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({0: 'MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...GEV'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MMELKHKKEEYAKELINLLSRFMSGKISYPVLSLRLTGIEAKVHESGFEDLVRL...PYV'}, length=90)",
        )
        self.assertEqual(hsp.target.id, "gi|70606448|ref|YP_255318.1|")
        self.assertEqual(hsp.target.name, "YP_255318")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein Saci_0636 [Sulfolobus acidocaldarius DSM 639] >gi|68567096|gb|AAY80025.1| hypothetical protein Saci_0636 [Sulfolobus acidocaldarius DSM 639]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "M + + KK +YA   + +L  F +G++ YP ++L+L G EA    +G E     IH ++K I +A +    KGS   ++ +   V",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|706064         0 MMELKHKKEEYAKELINLLSRFMSGKISYPVLSLRLTGIEAKVHESGFEDLVRLIHELLK
                  0 |.....||..||......|..|..|...||...|.|.|.||.....|.|.....||...|
lcl|QUERY         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK

gi|706064        60 AIREAER----KGSNEINKLVRPYV 81
                 60 .|..|..----|||..........| 85
lcl|QUERY        60 MISDAMKPYRNKGSGFQSQPIPGEV 85
""",
        )
        hit = record[4]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|227518463|ref|ZP_03948512.1|")
        self.assertEqual(hit.target.name, "ZP_03948512")
        self.assertEqual(
            hit.target.description,
            "possible histidine kinase [Enterococcus faecalis TX0104] >gi|227074141|gb|EEI12104.1| possible histidine kinase [Enterococcus faecalis TX0104]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=516)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 82.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 36.0945)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.01498)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 35)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[379, 418, 423, 486],
                              [ 29,  68,  68, 131]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({29: 'PEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPG...MAS'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({379: 'PILAGFLSGERIKFAEIKTQLAIEIYPEIPPNKRDEDTQNLIAIYRYIHRFLME...EAT'}, length=516)",
        )
        self.assertEqual(hsp.target.id, "gi|227518463|ref|ZP_03948512.1|")
        self.assertEqual(hsp.target.name, "ZP_03948512")
        self.assertEqual(
            hsp.target.description,
            "possible histidine kinase [Enterococcus faecalis TX0104] >gi|227074141|gb|EEI12104.1| possible histidine kinase [Enterococcus faecalis TX0104]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "P +   L+GE         +   E    I     D         YR        QP+P E+I  +   P         A P  Q+   E+E   S  A+ L  A A+",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|227518       379 PILAGFLSGERIKFAEIKTQLAIEIYPEIPPNKRDEDTQNLIAIYRYIHRFLMEQPLPEE
                  0 |.....|.||.............|....|.....|....-----||........||.|.|
lcl|QUERY        29 PEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKP-----YRNKGSGFQSQPIPGE

gi|227518       439 IIETIDYQPGSLTTTYSFAYPKEQLERFEQEFFTSYLARLLENAEAT 486
                 60 .|......|.........|.|..|....|.|...|..|..|..|.|. 107
lcl|QUERY        84 VIAQVTSNPEYQQAKAFLASPATQVRNIEREEVLSKGAKKLAQAMAS 131
""",
        )
        hit = record[5]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|78044048|ref|YP_360886.1|")
        self.assertEqual(hit.target.name, "YP_360886")
        self.assertEqual(
            hit.target.description,
            "UDP-N-acetylenolpyruvoylglucosamine reductase [Carboxydothermus hydrogenoformans Z-2901] >gi|90109774|sp|Q3AAE8.1|MURB_CARHZ RecName: Full=UDP-N-acetylenolpyruvoylglucosamine reductase; AltName: Full=UDP-N-acetylmuramate dehydrogenase >gi|77996163|gb|ABB15062.1| UDP-N-acetylenolpyruvoylglucosamine reductase [Carboxydothermus hydrogenoformans Z-2901]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=302)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 78.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 34.5537)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.29147)
        self.assertEqual(hsp.annotations["identity"], 15)
        self.assertEqual(hsp.annotations["positive"], 25)
        self.assertEqual(hsp.annotations["gaps"], 6)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[162, 208, 208, 232],
                              [ 18,  64,  70,  94]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 76))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({18: 'LDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNK...NPE'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({162: 'LKEFFANECGFKYRSSRFKEEKQWIVKAEFSLNPGDKKEILKKIREFREKRLAS...NPE'}, length=302)",
        )
        self.assertEqual(hsp.target.id, "gi|78044048|ref|YP_360886.1|")
        self.assertEqual(hsp.target.name, "YP_360886")
        self.assertEqual(
            hsp.target.description,
            "UDP-N-acetylenolpyruvoylglucosamine reductase [Carboxydothermus hydrogenoformans Z-2901] >gi|90109774|sp|Q3AAE8.1|MURB_CARHZ RecName: Full=UDP-N-acetylenolpyruvoylglucosamine reductase; AltName: Full=UDP-N-acetylmuramate dehydrogenase >gi|77996163|gb|ABB15062.1| UDP-N-acetylenolpyruvoylglucosamine reductase [Carboxydothermus hydrogenoformans Z-2901]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "L  F   + G+   + +   E+    +A           I+K I +       +     SQP+       V  NPE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|780440       162 LKEFFANECGFKYRSSRFKEEKQWIVKAEFSLNPGDKKEILKKIRE------FREKRLAS
                  0 |..|.....|..........|......|...........|.|.|..------.......|
lcl|QUERY        18 LDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQS

gi|780440       216 QPLEFPNAGSVFKNPE 232
                 60 ||........|..|||  76
lcl|QUERY        78 QPIPGEVIAQVTSNPE  94
""",
        )
        hit = record[6]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|116750563|ref|YP_847250.1|")
        self.assertEqual(hit.target.name, "YP_847250")
        self.assertEqual(
            hit.target.description,
            "NADH:flavin oxidoreductase/NADH oxidase [Syntrophobacter fumaroxidans MPOB] >gi|116699627|gb|ABK18815.1| NADH:flavin oxidoreductase/NADH oxidase [Syntrophobacter fumaroxidans MPOB]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=645)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 77.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 34.1685)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.67286)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 35)
        self.assertEqual(hsp.annotations["gaps"], 20)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[417, 430, 430, 449, 449, 461, 461, 497],
                              [  0,  13,  18,  37,  51,  63,  64, 100]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 100))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({0: 'MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEA...AKA'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({417: 'LAALPPKKGDFGKLVEFYAGELPRLGVDVRLGTAATTELLKSLKADVYVLATGS...GQA'}, length=645)",
        )
        self.assertEqual(hsp.target.id, "gi|116750563|ref|YP_847250.1|")
        self.assertEqual(hsp.target.name, "YP_847250")
        self.assertEqual(
            hsp.target.description,
            "NADH:flavin oxidoreductase/NADH oxidase [Syntrophobacter fumaroxidans MPOB] >gi|116699627|gb|ABK18815.1| NADH:flavin oxidoreductase/NADH oxidase [Syntrophobacter fumaroxidans MPOB]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "+A   PKKGD+       L  F  G+L    V ++L                 A   ++K +  A       GS     PIPG  +  V   PE    +A",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|116750       417 LAALPPKKGDFGK-----LVEFYAGELPRLGVDVRLG--------------TAATTELLK
                  0 .|...|||||...-----|..|..|.|....|...|.--------------..|.....|
lcl|QUERY         0 MAKYEPKKGDYAGGAVKILDMFENGQLGYPEVTLKLAGEEANARRAGDERTKEAIHAIVK

gi|116750       458 SLK-ADVYVLATGSTSSRPPIPGADLPHVFMVPEVLWGQA 497
                 60 ...-|.......||.....||||.....|...||.....| 100
lcl|QUERY        60 MISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPEYQQAKA 100
""",
        )
        hit = record[7]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|184201116|ref|YP_001855323.1|")
        self.assertEqual(hit.target.name, "YP_001855323")
        self.assertEqual(
            hit.target.description,
            "histidinol dehydrogenase [Kocuria rhizophila DC2201] >gi|183581346|dbj|BAG29817.1| histidinol dehydrogenase [Kocuria rhizophila DC2201]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=507)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 77.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 34.1685)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.67286)
        self.assertEqual(hsp.annotations["identity"], 12)
        self.assertEqual(hsp.annotations["positive"], 24)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 68, 127],
                              [ 30,  89]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 59))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({30: 'EVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPGEVIAQV'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({68: 'ELAHRFDGVEQQRLRVGPEQIERAVAELAPEVRRALETAIARTRAFAEAQRPRDVEVEV'}, length=507)",
        )
        self.assertEqual(hsp.target.id, "gi|184201116|ref|YP_001855323.1|")
        self.assertEqual(hsp.target.name, "YP_001855323")
        self.assertEqual(
            hsp.target.description,
            "histidinol dehydrogenase [Kocuria rhizophila DC2201] >gi|183581346|dbj|BAG29817.1| histidinol dehydrogenase [Kocuria rhizophila DC2201]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "E+  +  G E    R G E+ + A+  +   +  A++    +   F     P +V  +V",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|184201        68 ELAHRFDGVEQQRLRVGPEQIERAVAELAPEVRRALETAIARTRAFAEAQRPRDVEVEV
                  0 |......|.|....|.|.|....|..........|..........|.....|..|...|
lcl|QUERY        30 EVTLKLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPGEVIAQV

gi|184201       127
                 59
lcl|QUERY        89
""",
        )
        hit = record[8]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|46114422|ref|XP_383229.1|")
        self.assertEqual(hit.target.name, "XP_383229")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein FG03053.1 [Gibberella zeae PH-1]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=263)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 74.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 33.0129)
        self.assertAlmostEqual(hsp.annotations["evalue"], 9.81946)
        self.assertEqual(hsp.annotations["identity"], 26)
        self.assertEqual(hsp.annotations["positive"], 40)
        self.assertEqual(hsp.annotations["gaps"], 5)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 85, 118, 118, 126, 126, 151, 151, 169],
                              [ 34,  67,  68,  76,  78, 103, 105, 123]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 89))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({34: 'KLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPGEVIAQ...GAK'}, length=131)",
        )
        self.assertEqual(hsp.query.id, "lcl|QUERY")
        self.assertEqual(hsp.query.description, "tr|Q3V4Q3|Q3V4Q3_9VIRU")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({85: 'KLTTLKRRLRYEAKELRKEALRQIVSKLRSWMKLRDFGCGVKPLIESSLPEIAT...GSR'}, length=263)",
        )
        self.assertEqual(hsp.target.id, "gi|46114422|ref|XP_383229.1|")
        self.assertEqual(hsp.target.name, "XP_383229")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein FG03053.1 [Gibberella zeae PH-1]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "KL   +   R    E  KEA+  IV  +   MK  R+ G G   +P+    + ++ +NP Y Q   +L       R IER   + KG++",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|461144        85 KLTTLKRRLRYEAKELRKEALRQIVSKLRSWMK-LRDFGCGV--KPLIESSLPEIATNPH
                  0 ||.......|....|..|||...||......||-.|..|.|.--.|...........||.
lcl|QUERY        34 KLAGEEANARRAGDERTKEAIHAIVKMISDAMKPYRNKGSGFQSQPIPGEVIAQVTSNPE

gi|461144       142 YNQTSLYLT--MNHPRRIERVSRVIKGSR 169
                 60 |.|....|.--....|.|||.....||..  89
lcl|QUERY        94 YQQAKAFLASPATQVRNIEREEVLSKGAK 123
""",
        )

    def test_phiblast(self):
        """Parsing BLASTP 2.14.1+ (phiblast.xml)."""
        filename = "phiblast.xml"
        datafile = os.path.join("Blast", filename)
        with open(datafile, "rb") as handle:
            records = Blast.parse(handle)
            self.check_phiblast_records(records)
        with Blast.parse(datafile) as records:
            self.check_phiblast_records(records)
        with open(datafile, "rb") as handle:
            record = Blast.read(handle)
        self.check_phiblast_record(record)
        record = Blast.read(datafile)
        self.check_phiblast_record(record)

    def check_phiblast_records(self, records):
        self.assertEqual(records.program, "blastp")
        self.assertEqual(records.version, "BLASTP 2.14.1+")
        self.assertEqual(
            records.reference,
            'Zheng Zhang, Alejandro A. Sch&auml;ffer, Webb Miller, Thomas L. Madden, David J. Lipman, Eugene V. Koonin, and Stephen F. Altschul (1998), "Protein sequence similarity searches using patterns as seeds", Nucleic Acids Res. 26:3986-3990.',
        )
        self.assertEqual(records.db, "nr")
        self.assertIsInstance(records.query, SeqRecord)
        self.assertEqual(records.query.id, "Query_74414")
        self.assertEqual(records.query.description, "unnamed protein product")
        self.assertEqual(repr(records.query.seq), "Seq(None, length=664)")
        self.assertEqual(len(records.param), 6)
        self.assertEqual(records.param["matrix"], "BLOSUM62")
        self.assertAlmostEqual(records.param["expect"], 0.05)
        self.assertEqual(records.param["gap-open"], 11)
        self.assertEqual(records.param["gap-extend"], 1)
        self.assertEqual(records.param["filter"], "F")
        self.assertEqual(
            records.param["pattern"],
            "[LIVMF]-G-E-x-[GAS]-[LIVM]-x(5,11)-R-[STAQ]-A-x-[LIVMA]-x-[STACV]",
        )
        record = next(records)
        self.assertRaises(StopIteration, next, records)
        self.check_phiblast_record(record)

    def check_phiblast_record(self, record):
        self.assertEqual(record.num, 1)
        self.assertIsInstance(record.query, SeqRecord)
        self.assertEqual(record.query.id, "Query_74414")
        self.assertEqual(record.query.description, "unnamed protein product")
        self.assertEqual(repr(record.query.seq), "Seq(None, length=664)")
        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 633473216)
        self.assertEqual(record.stat["db-len"], 248084082182)
        self.assertEqual(record.stat["hsp-len"], 0)
        self.assertAlmostEqual(record.stat["eff-space"], 0.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.047)
        self.assertAlmostEqual(record.stat["lambda"], 0.27)
        self.assertAlmostEqual(record.stat["entropy"], 1.0)
        self.assertEqual(len(record), 10)
        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "ref|NP_001075863.1|")
        self.assertEqual(hit.target.name, "NP_001075863")
        self.assertEqual(
            hit.target.description,
            "cyclic nucleotide-gated olfactory channel [Oryctolagus cuniculus] >emb|CAA42201.1| aorta CNG channel (rACNG) [Oryctolagus cuniculus] >prf||1919268A cyclic nucleotide-gated channel [Oryctolagus cuniculus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=732)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3336.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1290.65)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 664)
        self.assertEqual(hsp.annotations["positive"], 664)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 68, 732],
                          [  0, 664]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 664))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP')",
        )
        self.assertEqual(hsp.query.id, "Query_74414")
        self.assertEqual(hsp.query.description, "unnamed protein product")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({68: 'MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP'}, length=732)",
        )
        self.assertEqual(hsp.target.id, "ref|NP_001075863.1|")
        self.assertEqual(hsp.target.name, "NP_001075863")
        self.assertEqual(
            hsp.target.description,
            "cyclic nucleotide-gated olfactory channel [Oryctolagus cuniculus] >emb|CAA42201.1| aorta CNG channel (rACNG) [Oryctolagus cuniculus] >prf||1919268A cyclic nucleotide-gated channel [Oryctolagus cuniculus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQQRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGDGKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDYFSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGIHNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSIGFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIGVLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNKKTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDYICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANIRSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEKLKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAAAEQP",
        )
        self.assertEqual(
            str(hsp),
            """\
ref|NP_00        68 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744         0 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ

ref|NP_00       128 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744        60 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD

ref|NP_00       188 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY

ref|NP_00       248 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       180 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI

ref|NP_00       308 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       240 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI

ref|NP_00       368 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG

ref|NP_00       428 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK

ref|NP_00       488 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       420 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY

ref|NP_00       548 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI
                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI

ref|NP_00       608 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK
                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK

ref|NP_00       668 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA
                600 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       600 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA

ref|NP_00       728 AEQP 732
                660 |||| 664
Query_744       660 AEQP 664
""",
        )
        hit = record[1]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "ref|XP_051689802.1|")
        self.assertEqual(hit.target.name, "XP_051689802")
        self.assertEqual(
            hit.target.description,
            "cyclic nucleotide-gated olfactory channel isoform X3 [Oryctolagus cuniculus] >sp|Q28718.1| RecName: Full=Cyclic nucleotide-gated olfactory channel; AltName: Full=Aorta CNG channel; Short=RACNG; AltName: Full=Cyclic nucleotide-gated cation channel 2; AltName: Full=Cyclic nucleotide-gated channel alpha-2; Short=CNG channel alpha-2; Short=CNG-2; Short=CNG2 [Oryctolagus cuniculus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=664)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3336.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1290.65)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 664)
        self.assertEqual(hsp.annotations["positive"], 664)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 664],
                          [  0, 664]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 664))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP')",
        )
        self.assertEqual(hsp.query.id, "Query_74414")
        self.assertEqual(hsp.query.description, "unnamed protein product")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP')",
        )
        self.assertEqual(hsp.target.id, "ref|XP_051689802.1|")
        self.assertEqual(hsp.target.name, "XP_051689802")
        self.assertEqual(
            hsp.target.description,
            "cyclic nucleotide-gated olfactory channel isoform X3 [Oryctolagus cuniculus] >sp|Q28718.1| RecName: Full=Cyclic nucleotide-gated olfactory channel; AltName: Full=Aorta CNG channel; Short=RACNG; AltName: Full=Cyclic nucleotide-gated cation channel 2; AltName: Full=Cyclic nucleotide-gated channel alpha-2; Short=CNG channel alpha-2; Short=CNG-2; Short=CNG2 [Oryctolagus cuniculus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQQRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGDGKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDYFSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGIHNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSIGFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIGVLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNKKTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDYICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANIRSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEKLKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAAAEQP",
        )
        self.assertEqual(
            str(hsp),
            """\
ref|XP_05         0 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744         0 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ

ref|XP_05        60 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744        60 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD

ref|XP_05       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY

ref|XP_05       180 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       180 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI

ref|XP_05       240 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       240 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI

ref|XP_05       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG

ref|XP_05       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK

ref|XP_05       420 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       420 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY

ref|XP_05       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI
                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI

ref|XP_05       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK
                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK

ref|XP_05       600 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA
                600 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       600 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA

ref|XP_05       660 AEQP 664
                660 |||| 664
Query_744       660 AEQP 664
""",
        )
        hit = record[2]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "ref|XP_017206345.1|")
        self.assertEqual(hit.target.name, "XP_017206345")
        self.assertEqual(
            hit.target.description,
            "cyclic nucleotide-gated olfactory channel isoform X2 [Oryctolagus cuniculus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=677)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3336.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1290.65)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 664)
        self.assertEqual(hsp.annotations["positive"], 664)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 13, 677],
                          [  0, 664]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 664))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP')",
        )
        self.assertEqual(hsp.query.id, "Query_74414")
        self.assertEqual(hsp.query.description, "unnamed protein product")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({13: 'MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP'}, length=677)",
        )
        self.assertEqual(hsp.target.id, "ref|XP_017206345.1|")
        self.assertEqual(hsp.target.name, "XP_017206345")
        self.assertEqual(
            hsp.target.description,
            "cyclic nucleotide-gated olfactory channel isoform X2 [Oryctolagus cuniculus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQQRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGDGKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDYFSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGIHNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSIGFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIGVLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNKKTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDYICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANIRSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEKLKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAAAEQP",
        )
        self.assertEqual(
            str(hsp),
            """\
ref|XP_01        13 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744         0 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ

ref|XP_01        73 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744        60 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD

ref|XP_01       133 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY

ref|XP_01       193 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       180 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI

ref|XP_01       253 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       240 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI

ref|XP_01       313 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG

ref|XP_01       373 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK

ref|XP_01       433 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       420 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY

ref|XP_01       493 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI
                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI

ref|XP_01       553 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK
                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK

ref|XP_01       613 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA
                600 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       600 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA

ref|XP_01       673 AEQP 677
                660 |||| 664
Query_744       660 AEQP 664
""",
        )
        hit = record[3]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "ref|XP_051689801.1|")
        self.assertEqual(hit.target.name, "XP_051689801")
        self.assertEqual(
            hit.target.description,
            "cyclic nucleotide-gated olfactory channel isoform X1 [Oryctolagus cuniculus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=687)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3336.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1290.65)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 664)
        self.assertEqual(hsp.annotations["positive"], 664)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 23, 687],
                          [  0, 664]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 664))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP')",
        )
        self.assertEqual(hsp.query.id, "Query_74414")
        self.assertEqual(hsp.query.description, "unnamed protein product")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({23: 'MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP'}, length=687)",
        )
        self.assertEqual(hsp.target.id, "ref|XP_051689801.1|")
        self.assertEqual(hsp.target.name, "XP_051689801")
        self.assertEqual(
            hsp.target.description,
            "cyclic nucleotide-gated olfactory channel isoform X1 [Oryctolagus cuniculus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQQRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGDGKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDYFSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGIHNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSIGFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIGVLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNKKTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDYICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANIRSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEKLKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAAAEQP",
        )
        self.assertEqual(
            str(hsp),
            """\
ref|XP_05        23 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744         0 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ

ref|XP_05        83 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744        60 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD

ref|XP_05       143 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY

ref|XP_05       203 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       180 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI

ref|XP_05       263 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       240 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI

ref|XP_05       323 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG

ref|XP_05       383 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK

ref|XP_05       443 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       420 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY

ref|XP_05       503 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI
                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI

ref|XP_05       563 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK
                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK

ref|XP_05       623 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA
                600 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       600 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA

ref|XP_05       683 AEQP 687
                660 |||| 664
Query_744       660 AEQP 664
""",
        )
        hit = record[4]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "ref|XP_004407164.1|")
        self.assertEqual(hit.target.name, "XP_004407164")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: cyclic nucleotide-gated olfactory channel [Odobenus rosmarus divergens]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=664)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3231.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1249.79)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 639)
        self.assertEqual(hsp.annotations["positive"], 652)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 664],
                          [  0, 664]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 664))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP')",
        )
        self.assertEqual(hsp.query.id, "Query_74414")
        self.assertEqual(hsp.query.description, "unnamed protein product")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTEKSNGVKSSPANNHNHHTPPAIKANGKDDHRTNSRPQSAADDDTSSELQRLA...DEP')",
        )
        self.assertEqual(hsp.target.id, "ref|XP_004407164.1|")
        self.assertEqual(hsp.target.name, "XP_004407164")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: cyclic nucleotide-gated olfactory channel [Odobenus rosmarus divergens]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MTEKSNGVKSSPANNHN+H P  IKANGKD+ RT SRPQSAADDDTSSELQRLAEMDAPQQ RGGFRRIVRLVG+IR+WAN+NFREEE RPDSFLERFRGPELQTVTTQQGDGKGDKDG+GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGY+LVWLVLDYFSDVVYI DLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGIH+PELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSIGFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIGVLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNKK+VDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDYICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANIRSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEKL+QLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLE KMKQN  DDYLSDG+NSPEP AA++P",
        )
        self.assertEqual(
            str(hsp),
            """\
ref|XP_00         0 MTEKSNGVKSSPANNHNHHTPPAIKANGKDDHRTNSRPQSAADDDTSSELQRLAEMDAPQ
                  0 |||||||||||||||||.|.|..|||||||..||.|||||||||||||||||||||||||
Query_744         0 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ

ref|XP_00        60 QGRGGFRRIVRLVGIIREWANKNFREEEPRPDSFLERFRGPELQTVTTQQGDGKGDKDGE
                 60 |.||||||||||||.||.|||.||||||.||||||||||||||||||||||||||||||.
Query_744        60 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD

ref|XP_00       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYYLVWLVLDY
                120 |||||||||||||||||||||||||||||||||||||||||||||||||||.||||||||
Query_744       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY

ref|XP_00       180 FSDVVYITDLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI
                180 |||||||.||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       180 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI

ref|XP_00       240 HSPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI
                240 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       240 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI

ref|XP_00       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG

ref|XP_00       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK

ref|XP_00       420 KSVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY
                420 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       420 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY

ref|XP_00       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI
                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI

ref|XP_00       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK
                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK

ref|XP_00       600 LEQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLETKMKQNNMDDYLSDGVNSPEPTA
                600 |.|||||||||||||||||||||||||||||||||||.|||||..|||||||.|||||.|
Query_744       600 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA

ref|XP_00       660 ADEP 664
                660 |..| 664
Query_744       660 AEQP 664
""",
        )
        hit = record[5]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "ref|XP_008688471.1|")
        self.assertEqual(hit.target.name, "XP_008688471")
        self.assertEqual(
            hit.target.description,
            "cyclic nucleotide-gated olfactory channel [Ursus maritimus] >ref|XP_026343324.1| cyclic nucleotide-gated olfactory channel [Ursus arctos]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=664)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3228.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1248.63)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 638)
        self.assertEqual(hsp.annotations["positive"], 652)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 664],
                          [  0, 664]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 664))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP')",
        )
        self.assertEqual(hsp.query.id, "Query_74414")
        self.assertEqual(hsp.query.description, "unnamed protein product")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTEKSNGVKSSPANNHNHHAPPAIKANGKDDHRSSSRPQSAVDDDTSSELQRLA...DEP')",
        )
        self.assertEqual(hsp.target.id, "ref|XP_008688471.1|")
        self.assertEqual(hsp.target.name, "XP_008688471")
        self.assertEqual(
            hsp.target.description,
            "cyclic nucleotide-gated olfactory channel [Ursus maritimus] >ref|XP_026343324.1| cyclic nucleotide-gated olfactory channel [Ursus arctos]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MTEKSNGVKSSPANNHN+H P  IKANGKD+ R+ SRPQSA DDDTSSELQRLAEMDAPQ+ RGGFRRIVRLVG+IR WAN+NFREEE RPDSFLERFRGPELQTVTTQQGDGKGDKDG+GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQ+GY+LVWLVLDYFSDVVYI DLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGIH+PELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSIGFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIGVLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNKK+VDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDYICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANIRSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEKL+QLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLE KMKQN EDDYLSDGMNSPEPAAA++P",
        )
        self.assertEqual(
            str(hsp),
            """\
ref|XP_00         0 MTEKSNGVKSSPANNHNHHAPPAIKANGKDDHRSSSRPQSAVDDDTSSELQRLAEMDAPQ
                  0 |||||||||||||||||.|.|..|||||||..|..||||||.||||||||||||||||||
Query_744         0 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ

ref|XP_00        60 RGRGGFRRIVRLVGIIRDWANKNFREEEPRPDSFLERFRGPELQTVTTQQGDGKGDKDGE
                 60 ..||||||||||||.||.|||.||||||.||||||||||||||||||||||||||||||.
Query_744        60 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD

ref|XP_00       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQKGYYLVWLVLDY
                120 ||||||||||||||||||||||||||||||||||||||||||||||||.||.||||||||
Query_744       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY

ref|XP_00       180 FSDVVYITDLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI
                180 |||||||.||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       180 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI

ref|XP_00       240 HSPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI
                240 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       240 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI

ref|XP_00       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG

ref|XP_00       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK

ref|XP_00       420 KSVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY
                420 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       420 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY

ref|XP_00       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI
                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI

ref|XP_00       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK
                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK

ref|XP_00       600 LEQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLETKMKQNNEDDYLSDGMNSPEPAA
                600 |.|||||||||||||||||||||||||||||||||||.|||||.||||||||||||||||
Query_744       600 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA

ref|XP_00       660 ADEP 664
                660 |..| 664
Query_744       660 AEQP 664
""",
        )
        hit = record[6]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "ref|XP_011229794.1|")
        self.assertEqual(hit.target.name, "XP_011229794")
        self.assertEqual(
            hit.target.description,
            "cyclic nucleotide-gated olfactory channel [Ailuropoda melanoleuca] >gb|EFB14215.1| hypothetical protein PANDA_013994, partial [Ailuropoda melanoleuca]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=664)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3227.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1248.24)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 638)
        self.assertEqual(hsp.annotations["positive"], 652)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 664],
                          [  0, 664]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 664))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP')",
        )
        self.assertEqual(hsp.query.id, "Query_74414")
        self.assertEqual(hsp.query.description, "unnamed protein product")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTEKSNGVKSSPANNHNHHAPPAIKANGKDDHRSSSRPQSAVDDDTSSELQRLA...DEP')",
        )
        self.assertEqual(hsp.target.id, "ref|XP_011229794.1|")
        self.assertEqual(hsp.target.name, "XP_011229794")
        self.assertEqual(
            hsp.target.description,
            "cyclic nucleotide-gated olfactory channel [Ailuropoda melanoleuca] >gb|EFB14215.1| hypothetical protein PANDA_013994, partial [Ailuropoda melanoleuca]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MTEKSNGVKSSPANNHN+H P  IKANGKD+ R+ SRPQSA DDDTSSELQRLAEMDAPQ+ RGGFRRIVRLVG+IR WAN+NFREEE RPDSFLERFRGPELQTVTTQQGDGKGDKDG+GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQ+GY+LVWLVLDYFSDVVYI DLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGIH+PELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSIGFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIGVLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNKK+VDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDYICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANIRSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEKL+QLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLE KMKQN EDDYLSDGMNSPEPAAA++P",
        )
        self.assertEqual(
            str(hsp),
            """\
ref|XP_01         0 MTEKSNGVKSSPANNHNHHAPPAIKANGKDDHRSSSRPQSAVDDDTSSELQRLAEMDAPQ
                  0 |||||||||||||||||.|.|..|||||||..|..||||||.||||||||||||||||||
Query_744         0 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ

ref|XP_01        60 RGRGGFRRIVRLVGIIRDWANKNFREEEPRPDSFLERFRGPELQTVTTQQGDGKGDKDGE
                 60 ..||||||||||||.||.|||.||||||.||||||||||||||||||||||||||||||.
Query_744        60 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD

ref|XP_01       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQKGYYLVWLVLDY
                120 ||||||||||||||||||||||||||||||||||||||||||||||||.||.||||||||
Query_744       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY

ref|XP_01       180 FSDVVYIIDLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI
                180 |||||||.||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       180 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI

ref|XP_01       240 HSPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI
                240 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       240 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI

ref|XP_01       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG

ref|XP_01       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK

ref|XP_01       420 KSVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY
                420 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       420 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY

ref|XP_01       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI
                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI

ref|XP_01       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK
                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK

ref|XP_01       600 LEQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLETKMKQNNEDDYLSDGMNSPEPAA
                600 |.|||||||||||||||||||||||||||||||||||.|||||.||||||||||||||||
Query_744       600 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA

ref|XP_01       660 ADEP 664
                660 |..| 664
Query_744       660 AEQP 664
""",
        )
        hit = record[7]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "ref|XP_045646452.1|")
        self.assertEqual(hit.target.name, "XP_045646452")
        self.assertEqual(
            hit.target.description,
            "cyclic nucleotide-gated olfactory channel [Ursus americanus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=664)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3223.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1246.68)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 637)
        self.assertEqual(hsp.annotations["positive"], 651)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 664],
                          [  0, 664]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 664))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP')",
        )
        self.assertEqual(hsp.query.id, "Query_74414")
        self.assertEqual(hsp.query.description, "unnamed protein product")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTEKSNGVKCSPANNHNHHAPPAIKANGKDDHRSSSRPQSAVDDDTSSELQRLA...DEP')",
        )
        self.assertEqual(hsp.target.id, "ref|XP_045646452.1|")
        self.assertEqual(hsp.target.name, "XP_045646452")
        self.assertEqual(
            hsp.target.description,
            "cyclic nucleotide-gated olfactory channel [Ursus americanus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MTEKSNGVK SPANNHN+H P  IKANGKD+ R+ SRPQSA DDDTSSELQRLAEMDAPQ+ RGGFRRIVRLVG+IR WAN+NFREEE RPDSFLERFRGPELQTVTTQQGDGKGDKDG+GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQ+GY+LVWLVLDYFSDVVYI DLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGIH+PELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSIGFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIGVLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNKK+VDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDYICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANIRSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEKL+QLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLE KMKQN EDDYLSDGMNSPEPAAA++P",
        )
        self.assertEqual(
            str(hsp),
            """\
ref|XP_04         0 MTEKSNGVKCSPANNHNHHAPPAIKANGKDDHRSSSRPQSAVDDDTSSELQRLAEMDAPQ
                  0 |||||||||.|||||||.|.|..|||||||..|..||||||.||||||||||||||||||
Query_744         0 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ

ref|XP_04        60 RGRGGFRRIVRLVGIIRDWANKNFREEEPRPDSFLERFRGPELQTVTTQQGDGKGDKDGE
                 60 ..||||||||||||.||.|||.||||||.||||||||||||||||||||||||||||||.
Query_744        60 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD

ref|XP_04       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQKGYYLVWLVLDY
                120 ||||||||||||||||||||||||||||||||||||||||||||||||.||.||||||||
Query_744       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY

ref|XP_04       180 FSDVVYITDLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI
                180 |||||||.||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       180 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI

ref|XP_04       240 HSPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI
                240 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       240 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI

ref|XP_04       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG

ref|XP_04       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK

ref|XP_04       420 KSVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY
                420 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       420 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY

ref|XP_04       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI
                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI

ref|XP_04       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK
                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK

ref|XP_04       600 LEQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLETKMKQNNEDDYLSDGMNSPEPAA
                600 |.|||||||||||||||||||||||||||||||||||.|||||.||||||||||||||||
Query_744       600 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA

ref|XP_04       660 ADEP 664
                660 |..| 664
Query_744       660 AEQP 664
""",
        )
        hit = record[8]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "ref|XP_035942617.1|")
        self.assertEqual(hit.target.name, "XP_035942617")
        self.assertEqual(
            hit.target.description,
            "cyclic nucleotide-gated olfactory channel [Halichoerus grypus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=664)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3221.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1245.9)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 638)
        self.assertEqual(hsp.annotations["positive"], 651)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 664],
                          [  0, 664]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 664))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP')",
        )
        self.assertEqual(hsp.query.id, "Query_74414")
        self.assertEqual(hsp.query.description, "unnamed protein product")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTEKSNGVKSSPANNHNHHAPPVIKANGKDDHRTSSRPQSAADDDTSSELQRLA...DEP')",
        )
        self.assertEqual(hsp.target.id, "ref|XP_035942617.1|")
        self.assertEqual(hsp.target.name, "XP_035942617")
        self.assertEqual(
            hsp.target.description,
            "cyclic nucleotide-gated olfactory channel [Halichoerus grypus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MTEKSNGVKSSPANNHN+H P  IKANGKD+ RT SRPQSAADDDTSSELQRLAEMD PQQ RGGFRRIVRLVG+IR+WAN+NFREEE RPDSFLERFRGPELQTVTTQQGDGKGDKDG+GKGTKKKFELFVLDPAGDWYYRWLFVIAM VLYNWCLLVARACFSDLQ+GY+LVWLVLDYFSDVVYI DLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGIH+PELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSIGFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIGVLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNKK+VDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDYICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANIRSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEKL+QLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLE KMKQN  DDYLSDGMNSPEPAAA++P",
        )
        self.assertEqual(
            str(hsp),
            """\
ref|XP_03         0 MTEKSNGVKSSPANNHNHHAPPVIKANGKDDHRTSSRPQSAADDDTSSELQRLAEMDVPQ
                  0 |||||||||||||||||.|.|..|||||||..||.||||||||||||||||||||||.||
Query_744         0 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ

ref|XP_03        60 QGRGGFRRIVRLVGIIREWANKNFREEELRPDSFLERFRGPELQTVTTQQGDGKGDKDGE
                 60 |.||||||||||||.||.|||.||||||.||||||||||||||||||||||||||||||.
Query_744        60 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD

ref|XP_03       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMLVLYNWCLLVARACFSDLQKGYYLVWLVLDY
                120 |||||||||||||||||||||||||||||.||||||||||||||||||.||.||||||||
Query_744       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY

ref|XP_03       180 FSDVVYITDLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI
                180 |||||||.||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       180 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI

ref|XP_03       240 HSPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI
                240 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       240 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI

ref|XP_03       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG

ref|XP_03       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK

ref|XP_03       420 KSVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY
                420 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       420 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY

ref|XP_03       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI
                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI

ref|XP_03       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK
                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK

ref|XP_03       600 LEQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLETKMKQNNMDDYLSDGMNSPEPAA
                600 |.|||||||||||||||||||||||||||||||||||.|||||..|||||||||||||||
Query_744       600 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA

ref|XP_03       660 ADEP 664
                660 |..| 664
Query_744       660 AEQP 664
""",
        )
        hit = record[9]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "ref|XP_049729369.1|")
        self.assertEqual(hit.target.name, "XP_049729369")
        self.assertEqual(
            hit.target.description,
            "cyclic nucleotide-gated olfactory channel [Elephas maximus indicus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=664)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 3219.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1245.12)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 635)
        self.assertEqual(hsp.annotations["positive"], 654)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 664],
                          [  0, 664]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 664))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLA...EQP')",
        )
        self.assertEqual(hsp.query.id, "Query_74414")
        self.assertEqual(hsp.query.description, "unnamed protein product")
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTEKSNGVKSSPANNHNHHVPSTIKANGKDDRRTSSRPQSAADDDTSSELQRLA...EKP')",
        )
        self.assertEqual(hsp.target.id, "ref|XP_049729369.1|")
        self.assertEqual(hsp.target.name, "XP_049729369")
        self.assertEqual(
            hsp.target.description,
            "cyclic nucleotide-gated olfactory channel [Elephas maximus indicus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MTEKSNGVKSSPANNHN+HVP+TIKANGKD+ RT SRPQSAADDDTSSELQRLAEMDAPQQ RGGFRRI+RLVGVIR+WAN+NFREE+ RPDSFLERFRGPELQTVTTQQGDGK DKDG+GKGTKKKFELFVLDPAGDWYYRWLF IA+PVLYNWCLLVARACFSDLQ+GY+LVWLVLDYFSD+VYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHT+QFKLDVASIIPTDLIYFAVGIH+PELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSIGFGVDTWVYPNITDP YGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIGVLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNKKTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDYICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANIRSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAA+MEVDVQEKL+QLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLE KMKQN E+DYLSDG+NSPEPAA E+P",
        )
        self.assertEqual(
            str(hsp),
            """\
ref|XP_04         0 MTEKSNGVKSSPANNHNHHVPSTIKANGKDDRRTSSRPQSAADDDTSSELQRLAEMDAPQ
                  0 |||||||||||||||||.|||.||||||||..||.|||||||||||||||||||||||||
Query_744         0 MTEKSNGVKSSPANNHNNHVPATIKANGKDESRTRSRPQSAADDDTSSELQRLAEMDAPQ

ref|XP_04        60 QWRGGFRRIIRLVGVIREWANKNFREEDPRPDSFLERFRGPELQTVTTQQGDGKSDKDGE
                 60 |.|||||||.|||||||.|||.|||||..|||||||||||||||||||||||||.||||.
Query_744        60 QRRGGFRRIVRLVGVIRQWANRNFREEEARPDSFLERFRGPELQTVTTQQGDGKGDKDGD

ref|XP_04       120 GKGTKKKFELFVLDPAGDWYYRWLFFIALPVLYNWCLLVARACFSDLQKGYYLVWLVLDY
                120 |||||||||||||||||||||||||.||.|||||||||||||||||||.||.||||||||
Query_744       120 GKGTKKKFELFVLDPAGDWYYRWLFVIAMPVLYNWCLLVARACFSDLQRGYFLVWLVLDY

ref|XP_04       180 FSDMVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTMQFKLDVASIIPTDLIYFAVGI
                180 |||.||||||||||||||||||||||||||||||||||.|||||||||||||||||||||
Query_744       180 FSDVVYIADLFIRLRTGFLEQGLLVKDPKKLRDNYIHTLQFKLDVASIIPTDLIYFAVGI

ref|XP_04       240 HSPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI
                240 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       240 HNPELRFNRLLHFARMFEFFDRTETRTSYPNIFRISNLVLYILVIIHWNACIYYAISKSI

ref|XP_04       300 GFGVDTWVYPNITDPAYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG
                300 |||||||||||||||.||||||||||||||||||||||||||||||||||||||||||||
Query_744       300 GFGVDTWVYPNITDPEYGYLAREYIYCLYWSTLTLTTIGETPPPVKDEEYLFVIFDFLIG

ref|XP_04       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       360 VLIFATIVGNVGSMISNMNATRAEFQAKIDAVKHYMQFRKVSKEMEAKVIKWFDYLWTNK

ref|XP_04       420 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       420 KTVDEREVLKNLPAKLRAEIAINVHLSTLKKVRIFQDCEAGLLVELVLKLRPQVFSPGDY

ref|XP_04       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI
                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Query_744       480 ICRKGDIGKEMYIIKEGKLAVVADDGVTQYALLSAGSCFGEISILNIKGSKMGNRRTANI

ref|XP_04       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAATMEVDVQEK
                540 |||||||||||||||||||||||||||||||||||||||||||||||||||.||||||||
Query_744       540 RSLGYSDLFCLSKDDLMEAVTEYPDAKKVLEERGREILMKEGLLDENEVAASMEVDVQEK

ref|XP_04       600 LEQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLETKMKQNNEEDYLSDGINSPEPAA
                600 |.|||||||||||||||||||||||||||||||||||.|||||.|.||||||.|||||||
Query_744       600 LKQLETNMETLYTRFGRLLAEYTGAQQKLKQRITVLEVKMKQNTEDDYLSDGMNSPEPAA

ref|XP_04       660 VEKP 664
                660 .|.| 664
Query_744       660 AEQP 664
""",
        )


class TestBlastn(unittest.TestCase):
    """Test the Blast XML parser for blastn output."""

    def test_xml_2900_blastn_001(self):
        """Parsing BLASTN 2.9.0+ (xml_2900_blastn_001.xml)."""
        filename = "xml_2900_blastn_001.xml"
        datafile = os.path.join("Blast", filename)
        with open(datafile, "rb") as handle:
            records = Blast.parse(handle)
            self.check_xml_2900_blastn_001_records(records)
        with Blast.parse(datafile) as records:
            self.check_xml_2900_blastn_001_records(records)
        with open(datafile, "rb") as handle:
            record = Blast.read(handle)
        self.check_xml_2900_blastn_001_record(record)
        record = Blast.read(datafile)
        self.check_xml_2900_blastn_001_record(record)

    def check_xml_2900_blastn_001_records(self, records):
        self.assertEqual(records.program, "blastn")
        self.assertEqual(records.version, "BLASTN 2.9.0+")
        self.assertEqual(
            records.reference,
            'Stephen F. Altschul, Thomas L. Madden, Alejandro A. Sch&auml;ffer, Jinghui Zhang, Zheng Zhang, Webb Miller, and David J. Lipman (1997), "Gapped BLAST and PSI-BLAST: a new generation of protein database search programs", Nucleic Acids Res. 25:3389-3402.',
        )
        self.assertEqual(
            records.db, "GPIPE/10090/current/all_top_level GPIPE/10090/current/rna"
        )
        self.assertIsInstance(records.query, SeqRecord)
        self.assertEqual(records.query.id, "G26684.1")
        self.assertEqual(
            records.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(repr(records.query.seq), "Seq(None, length=285)")
        self.assertEqual(len(records.param), 6)
        self.assertAlmostEqual(records.param["expect"], 10.0)
        self.assertEqual(records.param["sc-match"], 2)
        self.assertEqual(records.param["sc-mismatch"], -3)
        self.assertEqual(records.param["gap-open"], 5)
        self.assertEqual(records.param["gap-extend"], 2)
        self.assertEqual(records.param["filter"], "R -d repeatmasker/repeat_9989;m;F;")
        record = next(records)
        self.assertRaises(StopIteration, next, records)
        self.check_xml_2900_blastn_001_record(record)

    def check_xml_2900_blastn_001_record(self, record):
        self.assertEqual(record.num, 1)

        self.assertIsInstance(record.query, SeqRecord)
        self.assertEqual(record.query.id, "G26684.1")
        self.assertEqual(
            record.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(repr(record.query.seq), "Seq(None, length=285)")

        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 107382)
        self.assertEqual(record.stat["db-len"], 3164670549)
        self.assertEqual(record.stat["hsp-len"], 0)
        self.assertAlmostEqual(record.stat["eff-space"], 0.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.41)
        self.assertAlmostEqual(record.stat["lambda"], 0.625)
        self.assertAlmostEqual(record.stat["entropy"], 0.78)
        self.assertEqual(len(record), 10)

        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|372099107|ref|NC_000069.6|")
        self.assertEqual(hit.target.name, "NC_000069")
        self.assertEqual(
            hit.target.description,
            "Mus musculus strain C57BL/6J chromosome 3, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=160039680)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 44.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 40.9604)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.375311)
        self.assertEqual(hsp.annotations["identity"], 30)
        self.assertEqual(hsp.annotations["positive"], 30)
        self.assertEqual(hsp.annotations["gaps"], 1)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[101449177, 101449150, 101449149, 101449143],
                          [      133,       160,       160,       166]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 34))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({133: 'GAATCCTAGAGGCTTGATTGGCCCAGGCTGCTG'}, length=285)",
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({101449143: 'CAGCAGGCCAGGGCCAGTCCAGCCTCTAGGATTC'}, length=160039680)",
        )
        self.assertEqual(hsp.target.id, "gi|372099107|ref|NC_000069.6|")
        self.assertEqual(hsp.target.name, "NC_000069")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 3, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"], "|||||||||||||| || |||||| || ||||||"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|372099 101449177 GAATCCTAGAGGCTGGACTGGCCCTGGCCTGCTG 101449143
                  0 ||||||||||||||.||.||||||.||-||||||        34
G26684.1        133 GAATCCTAGAGGCTTGATTGGCCCAGG-CTGCTG       166
""",
        )
        hit = record[1]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|372099103|ref|NC_000073.6|")
        self.assertEqual(hit.target.name, "NC_000073")
        self.assertEqual(
            hit.target.description,
            "Mus musculus strain C57BL/6J chromosome 7, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=145441459)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 44.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 40.9604)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.375311)
        self.assertEqual(hsp.annotations["identity"], 26)
        self.assertEqual(hsp.annotations["positive"], 26)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[131772185, 131772156],
                          [      204,       233]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 29))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({204: 'GAAAGGAAATNAAAATGGAAAGTTCTTGT'}, length=285)",
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({131772156: 'ACCAGAACTTTCCATTTTTTTTTCCTTTC'}, length=145441459)",
        )
        self.assertEqual(hsp.target.id, "gi|372099103|ref|NC_000073.6|")
        self.assertEqual(hsp.target.name, "NC_000073")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 7, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(hsp.annotations["midline"], "|||||||||  ||||||||||||||| ||")
        self.assertEqual(
            str(hsp),
            """\
gi|372099 131772185 GAAAGGAAAAAAAAATGGAAAGTTCTGGT 131772156
                  0 |||||||||..|||||||||||||||.||        29
G26684.1        204 GAAAGGAAATNAAAATGGAAAGTTCTTGT       233
""",
        )
        hit = record[2]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|372099106|ref|NC_000070.6|")
        self.assertEqual(hit.target.name, "NC_000070")
        self.assertEqual(
            hit.target.description,
            "Mus musculus strain C57BL/6J chromosome 4, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=156508116)")
        self.assertEqual(len(hit), 2)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 43.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 40.0587)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.30996)
        self.assertEqual(hsp.annotations["identity"], 23)
        self.assertEqual(hsp.annotations["positive"], 23)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[9607562, 9607538],
                          [     61,      85]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 24))
        self.assertEqual(
            repr(hsp.query.seq), "Seq({61: 'CCAACACAGGCCAGCGACTTCTGG'}, length=285)"
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({9607538: 'CCAGAAGCCGCTGGCCTGTGTTGG'}, length=156508116)",
        )
        self.assertEqual(hsp.target.id, "gi|372099106|ref|NC_000070.6|")
        self.assertEqual(hsp.target.name, "NC_000070")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 4, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(hsp.annotations["midline"], "|||||||||||||||| |||||||")
        self.assertEqual(
            str(hsp),
            """\
gi|372099   9607562 CCAACACAGGCCAGCGGCTTCTGG 9607538
                  0 ||||||||||||||||.|||||||      24
G26684.1         61 CCAACACAGGCCAGCGACTTCTGG      85
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 40.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 37.3537)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.57222)
        self.assertEqual(hsp.annotations["identity"], 28)
        self.assertEqual(hsp.annotations["positive"], 28)
        self.assertEqual(hsp.annotations["gaps"], 1)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[142902531, 142902542, 142902543, 142902563],
                          [      241,       252,       252,       272]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 32))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({241: 'GCCTGACATGGGTAGCTGCTCAATAAATGCT'}, length=285)",
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({142902531: 'GCCTGGCATGAAGTAACTGCTCAATAAATGCT'}, length=156508116)",
        )
        self.assertEqual(hsp.target.id, "gi|372099106|ref|NC_000070.6|")
        self.assertEqual(hsp.target.name, "NC_000070")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 4, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(hsp.annotations["midline"], "||||| ||||  ||| ||||||||||||||||")
        self.assertEqual(
            str(hsp),
            """\
gi|372099 142902531 GCCTGGCATGAAGTAACTGCTCAATAAATGCT 142902563
                  0 |||||.||||.-|||.||||||||||||||||        32
G26684.1        241 GCCTGACATGG-GTAGCTGCTCAATAAATGCT       272
""",
        )
        hit = record[3]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|372099108|ref|NC_000068.7|")
        self.assertEqual(hit.target.name, "NC_000068")
        self.assertEqual(
            hit.target.description,
            "Mus musculus strain C57BL/6J chromosome 2, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=182113224)")
        self.assertEqual(len(hit), 2)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 42.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 39.157)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.30996)
        self.assertEqual(hsp.annotations["identity"], 27)
        self.assertEqual(hsp.annotations["positive"], 27)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[3799646, 3799677],
                          [    238,     269]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 31))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({238: 'AAGGCCTGACATGGGTAGCTGCTCAATAAAT'}, length=285)",
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({3799646: 'AAGTCCTGGCATGAGTAGTTGCTCAATAAAT'}, length=182113224)",
        )
        self.assertEqual(hsp.target.id, "gi|372099108|ref|NC_000068.7|")
        self.assertEqual(hsp.target.name, "NC_000068")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 2, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(hsp.annotations["midline"], "||| |||| |||| |||| ||||||||||||")
        self.assertEqual(
            str(hsp),
            """\
gi|372099   3799646 AAGTCCTGGCATGAGTAGTTGCTCAATAAAT 3799677
                  0 |||.||||.||||.||||.||||||||||||      31
G26684.1        238 AAGGCCTGACATGGGTAGCTGCTCAATAAAT     269
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 41.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 38.2554)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.57222)
        self.assertEqual(hsp.annotations["identity"], 23)
        self.assertEqual(hsp.annotations["positive"], 23)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[70278959, 70278984],
                          [     210,      235]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 25))
        self.assertEqual(
            repr(hsp.query.seq), "Seq({210: 'AAATNAAAATGGAAAGTTCTTGTAG'}, length=285)"
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({70278959: 'AAATGAAAATGGAAAGTTCTTATAG'}, length=182113224)",
        )
        self.assertEqual(hsp.target.id, "gi|372099108|ref|NC_000068.7|")
        self.assertEqual(hsp.target.name, "NC_000068")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 2, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(hsp.annotations["midline"], "|||| |||||||||||||||| |||")
        self.assertEqual(
            str(hsp),
            """\
gi|372099  70278959 AAATGAAAATGGAAAGTTCTTATAG 70278984
                  0 ||||.||||||||||||||||.|||       25
G26684.1        210 AAATNAAAATGGAAAGTTCTTGTAG      235
""",
        )
        hit = record[4]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|372099097|ref|NC_000079.6|")
        self.assertEqual(hit.target.name, "NC_000079")
        self.assertEqual(
            hit.target.description,
            "Mus musculus strain C57BL/6J chromosome 13, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=120421639)")
        self.assertEqual(len(hit), 2)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 42.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 39.157)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.30996)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 25)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[26806584, 26806556],
                          [     206,      234]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 28))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({206: 'AAGGAAATNAAAATGGAAAGTTCTTGTA'}, length=285)",
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({26806556: 'TAGAAGAACTTTCCATTTTGATGTCCTT'}, length=120421639)",
        )
        self.assertEqual(hsp.target.id, "gi|372099097|ref|NC_000079.6|")
        self.assertEqual(hsp.target.name, "NC_000079")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 13, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(hsp.annotations["midline"], "||||| || |||||||||||||||| ||")
        self.assertEqual(
            str(hsp),
            """\
gi|372099  26806584 AAGGACATCAAAATGGAAAGTTCTTCTA 26806556
                  0 |||||.||.||||||||||||||||.||       28
G26684.1        206 AAGGAAATNAAAATGGAAAGTTCTTGTA      234
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 40.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 37.3537)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.57222)
        self.assertEqual(hsp.annotations["identity"], 32)
        self.assertEqual(hsp.annotations["positive"], 32)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[56840340, 56840300],
                          [     233,      273]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 40))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({233: 'AGCGCAAGGCCTGACATGGGTAGCTGCTCAATAAATGCTA'}, length=285)",
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({56840300: 'TAGTATTCACTGAACATTTTCCTATGTCAGGCCTTGCGCT'}, length=120421639)",
        )
        self.assertEqual(hsp.target.id, "gi|372099097|ref|NC_000079.6|")
        self.assertEqual(hsp.target.name, "NC_000079")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 13, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"], "||||||||||||||||| || |  || ||| | ||| |||"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|372099  56840340 AGCGCAAGGCCTGACATAGGAAAATGTTCAGTGAATACTA 56840300
                  0 |||||||||||||||||.||.|..||.|||.|.|||.|||       40
G26684.1        233 AGCGCAAGGCCTGACATGGGTAGCTGCTCAATAAATGCTA      273
""",
        )
        hit = record[5]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|372099098|ref|NC_000078.6|")
        self.assertEqual(hit.target.name, "NC_000078")
        self.assertEqual(
            hit.target.description,
            "Mus musculus strain C57BL/6J chromosome 12, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=120129022)")
        self.assertEqual(len(hit), 2)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 41.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 38.2554)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.57222)
        self.assertEqual(hsp.annotations["identity"], 22)
        self.assertEqual(hsp.annotations["positive"], 22)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[113030662, 113030685],
                          [       48,        71]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 23))
        self.assertEqual(
            repr(hsp.query.seq), "Seq({48: 'CATCCATTCACACCCAACACAGG'}, length=285)"
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({113030662: 'CATCCATTCACACCCAGCACAGG'}, length=120129022)",
        )
        self.assertEqual(hsp.target.id, "gi|372099098|ref|NC_000078.6|")
        self.assertEqual(hsp.target.name, "NC_000078")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 12, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(hsp.annotations["midline"], "|||||||||||||||| ||||||")
        self.assertEqual(
            str(hsp),
            """\
gi|372099 113030662 CATCCATTCACACCCAGCACAGG 113030685
                  0 ||||||||||||||||.||||||        23
G26684.1         48 CATCCATTCACACCCAACACAGG        71
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 40.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 37.3537)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.57222)
        self.assertEqual(hsp.annotations["identity"], 28)
        self.assertEqual(hsp.annotations["positive"], 28)
        self.assertEqual(hsp.annotations["gaps"], 1)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[108990272, 108990248, 108990248, 108990241],
                          [      230,       254,       255,       262]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 32))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({230: 'TGTAGCGCAAGGCCTGACATGGGTAGCTGCTC'}, length=285)",
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({108990241: 'GACCAGCACCCATGTCAGGCCTAGAGCTACA'}, length=120129022)",
        )
        self.assertEqual(hsp.target.id, "gi|372099098|ref|NC_000078.6|")
        self.assertEqual(hsp.target.name, "NC_000078")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 12, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(hsp.annotations["midline"], "|||||| | ||||||||||||||| |||| ||")
        self.assertEqual(
            str(hsp),
            """\
gi|372099 108990272 TGTAGCTCTAGGCCTGACATGGGT-GCTGGTC 108990241
                  0 ||||||.|.|||||||||||||||-||||.||        32
G26684.1        230 TGTAGCGCAAGGCCTGACATGGGTAGCTGCTC       262
""",
        )
        hit = record[6]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|372099109|ref|NC_000067.6|")
        self.assertEqual(hit.target.name, "NC_000067")
        self.assertEqual(
            hit.target.description,
            "Mus musculus strain C57BL/6J chromosome 1, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=195471971)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 40.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 37.3537)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.57222)
        self.assertEqual(hsp.annotations["identity"], 35)
        self.assertEqual(hsp.annotations["positive"], 35)
        self.assertEqual(hsp.annotations["gaps"], 2)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[65190107, 65190128, 65190128, 65190144, 65190144, 65190148],
                          [      86,      107,      108,      124,      125,      129]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 43))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({86: 'GCTCAGCCACAGACATGGTTTGTNACTNTTGAGCTTCTGTTCC'}, length=285)",
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({65190107: 'GCTCAGCCACATACATGGTTTTAAGTGTTGAGGCTCTTTCC'}, length=195471971)",
        )
        self.assertEqual(hsp.target.id, "gi|372099109|ref|NC_000067.6|")
        self.assertEqual(hsp.target.name, "NC_000067")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 1, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"], "||||||||||| ||||||||| | | | |||||  ||| ||||"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|372099  65190107 GCTCAGCCACATACATGGTTT-TAAGTGTTGAGGCTCT-TTCC 65190148
                  0 |||||||||||.|||||||||-|.|.|.|||||..|||-||||       43
G26684.1         86 GCTCAGCCACAGACATGGTTTGTNACTNTTGAGCTTCTGTTCC      129
""",
        )
        hit = record[7]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|372099101|ref|NC_000075.6|")
        self.assertEqual(hit.target.name, "NC_000075")
        self.assertEqual(
            hit.target.description,
            "Mus musculus strain C57BL/6J chromosome 9, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=124595110)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 40.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 37.3537)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.57222)
        self.assertEqual(hsp.annotations["identity"], 36)
        self.assertEqual(hsp.annotations["positive"], 36)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[58227241, 58227194],
                          [     237,      284]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 47))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({237: 'CAAGGCCTGACATGGGTAGCTGCTCAATAAATGCTAGTNTGTTATTT'}, length=285)",
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({58227194: 'AAAAAAAAAAATAGTATTTATTGAGCAGTCATACCTGTCAGGCTTTG'}, length=124595110)",
        )
        self.assertEqual(hsp.target.id, "gi|372099101|ref|NC_000075.6|")
        self.assertEqual(hsp.target.name, "NC_000075")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 9, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "||| |||||||| |  |  ||||||||||||| ||| | | || |||",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|372099  58227241 CAAAGCCTGACAGGTATGACTGCTCAATAAATACTATTTTTTTTTTT 58227194
                  0 |||.||||||||.|..|..|||||||||||||.|||.|.|.||.|||       47
G26684.1        237 CAAGGCCTGACATGGGTAGCTGCTCAATAAATGCTAGTNTGTTATTT      284
""",
        )
        hit = record[8]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|372099100|ref|NC_000076.6|")
        self.assertEqual(hit.target.name, "NC_000076")
        self.assertEqual(
            hit.target.description,
            "Mus musculus strain C57BL/6J chromosome 10, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=130694993)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 40.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 37.3537)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.57222)
        self.assertEqual(hsp.annotations["identity"], 20)
        self.assertEqual(hsp.annotations["positive"], 20)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[119337185, 119337205],
                          [      254,       274]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 20))
        self.assertEqual(
            repr(hsp.query.seq), "Seq({254: 'AGCTGCTCAATAAATGCTAG'}, length=285)"
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({119337185: 'AGCTGCTCAATAAATGCTAG'}, length=130694993)",
        )
        self.assertEqual(hsp.target.id, "gi|372099100|ref|NC_000076.6|")
        self.assertEqual(hsp.target.name, "NC_000076")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 10, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(hsp.annotations["midline"], "||||||||||||||||||||")
        self.assertEqual(
            str(hsp),
            """\
gi|372099 119337185 AGCTGCTCAATAAATGCTAG 119337205
                  0 ||||||||||||||||||||        20
G26684.1        254 AGCTGCTCAATAAATGCTAG       274
""",
        )
        hit = record[9]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|372099094|ref|NC_000082.6|")
        self.assertEqual(hit.target.name, "NC_000082")
        self.assertEqual(
            hit.target.description,
            "Mus musculus strain C57BL/6J chromosome 16, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=98207768)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 40.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 37.3537)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.57222)
        self.assertEqual(hsp.annotations["identity"], 43)
        self.assertEqual(hsp.annotations["positive"], 43)
        self.assertEqual(hsp.annotations["gaps"], 2)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[18854779, 18854803, 18854804, 18854812, 18854813, 18854835],
                          [     174,      198,      198,      206,      206,      228]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 56))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({174: 'GGAGGCAAAGAATCCCTACCTCCTAGGGGTGAAAGGAAATNAAAATGGAAAGTT'}, length=285)",
        )
        self.assertEqual(hsp.query.id, "G26684.1")
        self.assertEqual(
            hsp.query.description, "human STS STS_D11570, sequence tagged site"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({18854779: 'GGAGGCAAAGAATCCCTACATTGTGACAGCTGATAAAGAAGGTAAAATGGAAAATT'}, length=98207768)",
        )
        self.assertEqual(hsp.target.id, "gi|372099094|ref|NC_000082.6|")
        self.assertEqual(hsp.target.name, "NC_000082")
        self.assertEqual(
            hsp.target.description,
            "Mus musculus strain C57BL/6J chromosome 16, GRCm38.p4 C57BL/6J",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "||||||||||||||||||| |  | |  | ||| || |||   |||||||||| ||",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|372099  18854779 GGAGGCAAAGAATCCCTACATTGTGACAGCTGATAAAGAAGGTAAAATGGAAAATT
                  0 |||||||||||||||||||.|..|-|..|.|||-||.|||...||||||||||.||
G26684.1        174 GGAGGCAAAGAATCCCTACCTCCT-AGGGGTGA-AAGGAAATNAAAATGGAAAGTT

gi|372099  18854835
                 56
G26684.1        228
""",
        )

    def test_megablast_legacy(self):
        """Parsing megablast 2.2.26 [Sep-21-2011] (megablast_legacy.xml)."""
        filename = "megablast_legacy.xml"
        datafile = os.path.join("Blast", filename)
        with open(datafile, "rb") as handle:
            records = Blast.parse(handle)
            self.check_megablast_legacy_records(records)
        with Blast.parse(datafile) as records:
            self.check_megablast_legacy_records(records)
        with open(datafile, "rb") as handle:
            record = Blast.read(handle)
        self.check_megablast_legacy_record(record)
        record = Blast.read(datafile)
        self.check_megablast_legacy_record(record)

    def check_megablast_legacy_records(self, records):
        self.assertEqual(records.program, "megablast")
        self.assertEqual(records.version, "megablast 2.2.26 [Sep-21-2011]")
        self.assertEqual(
            records.reference,
            '~Reference: Altschul, Stephen F., Thomas L. Madden, Alejandro A. Schaffer, ~Jinghui Zhang, Zheng Zhang, Webb Miller, and David J. Lipman (1997), ~"Gapped BLAST and PSI-BLAST: a new generation of protein database search~programs",  Nucleic Acids Res. 25:3389-3402.',
        )
        self.assertEqual(records.db, "m_cold.fasta")
        self.assertIsInstance(records.query, SeqRecord)
        self.assertEqual(records.query.id, "lcl|1_")
        self.assertEqual(
            records.query.description,
            "gi|8332116|gb|BE037100.1|BE037100 MP14H09 MP Mesembryanthemum crystallinum cDNA 5' similar to cold acclimation protein, mRNA sequence",
        )
        self.assertEqual(repr(records.query.seq), "Seq(None, length=1111)")
        self.assertEqual(len(records.param), 6)
        self.assertAlmostEqual(records.param["expect"], 10.0)
        self.assertEqual(records.param["sc-match"], 1)
        self.assertEqual(records.param["sc-mismatch"], -3)
        self.assertEqual(records.param["gap-open"], 0)
        self.assertEqual(records.param["gap-extend"], 0)
        self.assertEqual(records.param["filter"], "D")
        record = next(records)
        self.assertRaises(StopIteration, next, records)
        self.check_megablast_legacy_record(record)
        self.assertEqual(len(records.mbstat), 7)
        self.assertEqual(records.mbstat["db-num"], 1)
        self.assertEqual(records.mbstat["db-len"], 1111)
        self.assertEqual(records.mbstat["hsp-len"], 10)
        self.assertAlmostEqual(records.mbstat["eff-space"], 1212200.0)
        self.assertAlmostEqual(records.mbstat["kappa"], 0.710603)
        self.assertAlmostEqual(records.mbstat["lambda"], 1.37406)
        self.assertAlmostEqual(records.mbstat["entropy"], 1.30725)

    def check_megablast_legacy_record(self, record):
        self.assertEqual(record.num, 0)
        self.assertIsInstance(record.query, SeqRecord)
        self.assertEqual(record.query.id, "lcl|1_")
        self.assertEqual(
            record.query.description,
            "gi|8332116|gb|BE037100.1|BE037100 MP14H09 MP Mesembryanthemum crystallinum cDNA 5' similar to cold acclimation protein, mRNA sequence",
        )
        self.assertEqual(repr(record.query.seq), "Seq(None, length=1111)")
        self.assertEqual(len(record), 1)
        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gnl|BL_ORD_ID|0")
        self.assertEqual(hit.target.name, "0")
        self.assertEqual(
            hit.target.description,
            "gi|8332116|gb|BE037100.1|BE037100 MP14H09 MP Mesembryanthemum crystallinum cDNA 5' similar to cold acclimation protein, mRNA sequence",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1111)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 788.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 1562.59)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
        self.assertEqual(hsp.annotations["identity"], 797)
        self.assertEqual(hsp.annotations["positive"], 797)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 797],
                          [  0, 797]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 797))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq({0: 'CACTAGTACTCGAGCGTNCTGCACCAATTCGGCACGAGCAAGTGACTACGTTNT...GTG'}, length=1111)",
        )
        self.assertEqual(hsp.query.id, "lcl|1_")
        self.assertEqual(
            hsp.query.description,
            "gi|8332116|gb|BE037100.1|BE037100 MP14H09 MP Mesembryanthemum crystallinum cDNA 5' similar to cold acclimation protein, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'CACTAGTACTCGAGCGTNCTGCACCAATTCGGCACGAGCAAGTGACTACGTTNT...GTG'}, length=1111)",
        )
        self.assertEqual(hsp.target.id, "gnl|BL_ORD_ID|0")
        self.assertEqual(hsp.target.name, "0")
        self.assertEqual(
            hsp.target.description,
            "gi|8332116|gb|BE037100.1|BE037100 MP14H09 MP Mesembryanthemum crystallinum cDNA 5' similar to cold acclimation protein, mRNA sequence",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||",
        )
        self.assertEqual(
            str(hsp),
            """\
gnl|BL_OR         0 CACTAGTACTCGAGCGTNCTGCACCAATTCGGCACGAGCAAGTGACTACGTTNTGTGAAC
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_            0 CACTAGTACTCGAGCGTNCTGCACCAATTCGGCACGAGCAAGTGACTACGTTNTGTGAAC

gnl|BL_OR        60 AGAAAATGGGGAGAGAAATGAAGTACTTGGCCATGAAAACTGATCAATTGGCCGTGGCTA
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_           60 AGAAAATGGGGAGAGAAATGAAGTACTTGGCCATGAAAACTGATCAATTGGCCGTGGCTA

gnl|BL_OR       120 ATATGATCGATTCCGATATCAATGAGCTTAAAATGGCAACAATGAGGCTCATCAATGATG
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_          120 ATATGATCGATTCCGATATCAATGAGCTTAAAATGGCAACAATGAGGCTCATCAATGATG

gnl|BL_OR       180 CTAGTATGCTCGGTCATTACGGGTTTGGCACTCATTTCCTCAAATGGCTCGCCTGCCTTG
                180 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_          180 CTAGTATGCTCGGTCATTACGGGTTTGGCACTCATTTCCTCAAATGGCTCGCCTGCCTTG

gnl|BL_OR       240 CGGCTATTTACTTGTTGATATTGGATCGAACAAACTGGAGAACCAACATGCTCACGTCAC
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_          240 CGGCTATTTACTTGTTGATATTGGATCGAACAAACTGGAGAACCAACATGCTCACGTCAC

gnl|BL_OR       300 TTTTAGTCCCTTACATATTCCTCAGTCTTCCATCCGGGCCATTTCATCTGTTCAGAGGCG
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_          300 TTTTAGTCCCTTACATATTCCTCAGTCTTCCATCCGGGCCATTTCATCTGTTCAGAGGCG

gnl|BL_OR       360 AGGTCGGGAAATGGATTGCCATCATTGCAGTCGTGTTAAGGCTGTTCTTCAACCGGCATT
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_          360 AGGTCGGGAAATGGATTGCCATCATTGCAGTCGTGTTAAGGCTGTTCTTCAACCGGCATT

gnl|BL_OR       420 TCCCAGTTTGGCTGGAAATGCCTGGATCGTTGATACTCCTCCTGGTGGTGGCACCAGACT
                420 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_          420 TCCCAGTTTGGCTGGAAATGCCTGGATCGTTGATACTCCTCCTGGTGGTGGCACCAGACT

gnl|BL_OR       480 TCTTTACACACAAAGTGAAGGAGAGCTGGATCGGAATTGCAATTATGATAGCGATAGGGT
                480 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_          480 TCTTTACACACAAAGTGAAGGAGAGCTGGATCGGAATTGCAATTATGATAGCGATAGGGT

gnl|BL_OR       540 GTCACCTGATGCAAGAACATATCAGAGCCACTGGTGGCTTTTGGAATTCCTTCACACAGA
                540 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_          540 GTCACCTGATGCAAGAACATATCAGAGCCACTGGTGGCTTTTGGAATTCCTTCACACAGA

gnl|BL_OR       600 GCCACGGAACTTTTAACACAATTGGGCTTATCCTTCTACTGGCTTACCCTGTCTGTTTAT
                600 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_          600 GCCACGGAACTTTTAACACAATTGGGCTTATCCTTCTACTGGCTTACCCTGTCTGTTTAT

gnl|BL_OR       660 GGTCATCTTCATGATGTAGTAGCTTAGTCTTGATCCTAATCCTCAAATNTACTTTTCCAG
                660 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_          660 GGTCATCTTCATGATGTAGTAGCTTAGTCTTGATCCTAATCCTCAAATNTACTTTTCCAG

gnl|BL_OR       720 CTCTTTCGACGCTCTTGCTAAAGCCCATTCAATTCGCCCCATATTTCGCACACATTCATT
                720 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
lcl|1_          720 CTCTTTCGACGCTCTTGCTAAAGCCCATTCAATTCGCCCCATATTTCGCACACATTCATT

gnl|BL_OR       780 TCACCACCCAATACGTG 797
                780 ||||||||||||||||| 797
lcl|1_          780 TCACCACCCAATACGTG 797
""",
        )


class TestBlastx(unittest.TestCase):
    """Test the Blast XML parser for blastx output."""

    def test_xml_2222_blastx_001(self):
        """Parsing BLASTX 2.2.22+ (xml_2222_blastx_001.xml)."""
        filename = "xml_2222_blastx_001.xml"
        datafile = os.path.join("Blast", filename)
        with open(datafile, "rb") as handle:
            records = Blast.parse(handle)
            self.assertEqual(records.program, "blastx")
            self.assertEqual(records.version, "BLASTX 2.2.22+")
            self.assertEqual(
                records.reference,
                'Stephen F. Altschul, Thomas L. Madden, Alejandro A. Sch&auml;ffer, Jinghui Zhang, Zheng Zhang, Webb Miller, and David J. Lipman (1997), "Gapped BLAST and PSI-BLAST: a new generation of protein database search programs", Nucleic Acids Res. 25:3389-3402.',
            )
            self.assertEqual(records.db, "nr")
            self.assertIsInstance(records.query, SeqRecord)
            self.assertEqual(records.query.id, "1")
            self.assertEqual(
                records.query.description,
                "gi|4104054|gb|AH007193.1|SEG_CVIGS Centaurea vallesiaca 18S ribosomal RNA gene, partial sequence",
            )
            self.assertEqual(repr(records.query.seq), "Seq(None, length=1002)")
            self.assertEqual(len(records.param), 5)
            self.assertEqual(records.param["matrix"], "BLOSUM62")
            self.assertAlmostEqual(records.param["expect"], 0.0001)
            self.assertEqual(records.param["gap-open"], 11)
            self.assertEqual(records.param["gap-extend"], 1)
            self.assertEqual(records.param["filter"], "L;")
            record = next(records)
            self.assertIsInstance(record.query, SeqRecord)
            self.assertEqual(record.query.id, "1")
            self.assertEqual(
                record.query.description,
                "gi|4104054|gb|AH007193.1|SEG_CVIGS Centaurea vallesiaca 18S ribosomal RNA gene, partial sequence",
            )
            self.assertEqual(repr(record.query.seq), "Seq(None, length=1002)")

            self.assertEqual(len(record.stat), 7)
            self.assertEqual(record.stat["db-num"], 8994603)
            self.assertEqual(record.stat["db-len"], -1216159329)
            self.assertEqual(record.stat["hsp-len"], 0)
            self.assertAlmostEqual(record.stat["eff-space"], 367397307882.0)
            self.assertAlmostEqual(record.stat["kappa"], 0.041)
            self.assertAlmostEqual(record.stat["lambda"], 0.267)
            self.assertAlmostEqual(record.stat["entropy"], 0.14)
            self.assertEqual(len(record), 1)
            hit = record[0]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|149390769|gb|ABR25402.1|")
            self.assertEqual(hit.target.name, "ABR25402")
            self.assertEqual(
                hit.target.description, "unknown [Oryza sativa (indica cultivar-group)]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=26)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 129.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 54.2989775733826)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.83262460293058e-05)
            self.assertEqual(hsp.annotations["identity"], 24)
            self.assertEqual(hsp.annotations["positive"], 25)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 0, 26],
                              [ 0, 26]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 26))
            self.assertEqual(repr(hsp.query.seq), "Seq('HMLVSKIKPCMCKYEQIQTVKLRMAH')")
            self.assertEqual(hsp.query.id, "1")
            self.assertEqual(
                hsp.query.description,
                "gi|4104054|gb|AH007193.1|SEG_CVIGS Centaurea vallesiaca 18S ribosomal RNA gene, partial sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(26))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "1:911..988")
            self.assertEqual(repr(hsp.target.seq), "Seq('HMLVSKIKPCMCKYELIRTVKLRMAH')")
            self.assertEqual(hsp.target.id, "gi|149390769|gb|ABR25402.1|")
            self.assertEqual(hsp.target.name, "ABR25402")
            self.assertEqual(
                hsp.target.description, "unknown [Oryza sativa (indica cultivar-group)]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(hsp.annotations["midline"], "HMLVSKIKPCMCKYE I+TVKLRMAH")
            self.assertEqual(
                str(hsp),
                """\
gi|149390         0 HMLVSKIKPCMCKYELIRTVKLRMAH 26
                  0 |||||||||||||||.|.|||||||| 26
1                 0 HMLVSKIKPCMCKYEQIQTVKLRMAH 26
""",
            )
            record = next(records)
            self.assertIsInstance(record.query, SeqRecord)
            self.assertEqual(record.query.id, "2")
            self.assertEqual(
                record.query.description,
                "gi|4218935|gb|AF074388.1|AF074388 Sambucus nigra hevein-like protein HLPf gene, partial cds",
            )
            self.assertEqual(repr(record.query.seq), "Seq(None, length=2050)")

            self.assertEqual(len(record.stat), 7)
            self.assertEqual(record.stat["db-num"], 8994603)
            self.assertEqual(record.stat["db-len"], -1216159329)
            self.assertEqual(record.stat["hsp-len"], 0)
            self.assertAlmostEqual(record.stat["eff-space"], 967993058520.0)
            self.assertAlmostEqual(record.stat["kappa"], 0.041)
            self.assertAlmostEqual(record.stat["lambda"], 0.267)
            self.assertAlmostEqual(record.stat["entropy"], 0.14)
            self.assertEqual(len(record), 10)
            hit = record[0]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|4218936|gb|AAD12237.1|")
            self.assertEqual(hit.target.name, "AAD12237")
            self.assertEqual(
                hit.target.description, "hevein-like protein HLPf [Sambucus nigra]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=333)")
            self.assertEqual(len(hit), 2)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1053.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 410.223385721017)
            self.assertAlmostEqual(hsp.annotations["evalue"], 3.48406066731465e-112)
            self.assertEqual(hsp.annotations["identity"], 199)
            self.assertEqual(hsp.annotations["positive"], 200)
            self.assertEqual(hsp.annotations["gaps"], 33)
            hsp = hit[1]
            self.assertAlmostEqual(hsp.score, 683.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 267.699542631596)
            self.assertAlmostEqual(hsp.annotations["evalue"], 2.79278546744412e-69)
            self.assertEqual(hsp.annotations["identity"], 127)
            self.assertEqual(hsp.annotations["positive"], 127)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[206, 333],
                              [  0, 127]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 127))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...SVV')",
            )
            self.assertEqual(hsp.query.id, "2")
            self.assertEqual(
                hsp.query.description,
                "gi|4218935|gb|AF074388.1|AF074388 Sambucus nigra hevein-like protein HLPf gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(127))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "2:1669..2049")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({206: 'NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...SVV'}, length=333)",
            )
            self.assertEqual(hsp.target.id, "gi|4218936|gb|AAD12237.1|")
            self.assertEqual(hsp.target.name, "AAD12237")
            self.assertEqual(
                hsp.target.description, "hevein-like protein HLPf [Sambucus nigra]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASDQVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVAHIKMSVV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|421893       206 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                 0 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD

gi|421893       266 QVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVA
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                60 QVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVA

gi|421893       326 HIKMSVV 333
                120 ||||||| 127
2               120 HIKMSVV 127
""",
            )
            hit = record[1]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|4206074|gb|AAD11408.1|")
            self.assertEqual(hit.target.name, "AAD11408")
            self.assertEqual(
                hit.target.description, "hevein-like protein [Sambucus nigra]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=333)")
            self.assertEqual(len(hit), 2)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1043.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 406.371389961843)
            self.assertAlmostEqual(hsp.annotations["evalue"], 5.03097287018806e-111)
            self.assertEqual(hsp.annotations["identity"], 198)
            self.assertEqual(hsp.annotations["positive"], 199)
            self.assertEqual(hsp.annotations["gaps"], 33)
            hsp = hit[1]
            self.assertAlmostEqual(hsp.score, 672.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 263.462347296505)
            self.assertAlmostEqual(hsp.annotations["evalue"], 5.26696544712228e-68)
            self.assertEqual(hsp.annotations["identity"], 125)
            self.assertEqual(hsp.annotations["positive"], 126)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[206, 333],
                              [  0, 127]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 127))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...SVV')",
            )
            self.assertEqual(hsp.query.id, "2")
            self.assertEqual(
                hsp.query.description,
                "gi|4218935|gb|AF074388.1|AF074388 Sambucus nigra hevein-like protein HLPf gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(127))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "2:1669..2049")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({206: 'NYYYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...SLV'}, length=333)",
            )
            self.assertEqual(hsp.target.id, "gi|4206074|gb|AAD11408.1|")
            self.assertEqual(hsp.target.name, "AAD11408")
            self.assertEqual(
                hsp.target.description, "hevein-like protein [Sambucus nigra]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "NY YGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASDQVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVAHIKMS+V",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|420607       206 NYYYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD
                  0 ||.|||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                 0 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD

gi|420607       266 QVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVA
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                60 QVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVA

gi|420607       326 HIKMSLV 333
                120 |||||.| 127
2               120 HIKMSVV 127
""",
            )
            hit = record[2]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|4206070|gb|AAD11406.1|")
            self.assertEqual(hit.target.name, "AAD11406")
            self.assertEqual(
                hit.target.description, "hevein-like protein [Sambucus nigra]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=333)")
            self.assertEqual(len(hit), 2)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1043.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 406.371389961843)
            self.assertAlmostEqual(hsp.annotations["evalue"], 5.03097287018806e-111)
            self.assertEqual(hsp.annotations["identity"], 198)
            self.assertEqual(hsp.annotations["positive"], 199)
            self.assertEqual(hsp.annotations["gaps"], 33)
            hsp = hit[1]
            self.assertAlmostEqual(hsp.score, 680.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 266.543943903844)
            self.assertAlmostEqual(hsp.annotations["evalue"], 6.22167692942359e-69)
            self.assertEqual(hsp.annotations["identity"], 126)
            self.assertEqual(hsp.annotations["positive"], 127)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[206, 333],
                              [  0, 127]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 127))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...SVV')",
            )
            self.assertEqual(hsp.query.id, "2")
            self.assertEqual(
                hsp.query.description,
                "gi|4218935|gb|AF074388.1|AF074388 Sambucus nigra hevein-like protein HLPf gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(127))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "2:1669..2049")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({206: 'NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...SLV'}, length=333)",
            )
            self.assertEqual(hsp.target.id, "gi|4206070|gb|AAD11406.1|")
            self.assertEqual(hsp.target.name, "AAD11406")
            self.assertEqual(
                hsp.target.description, "hevein-like protein [Sambucus nigra]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASDQVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVAHIKMS+V",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|420607       206 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                 0 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD

gi|420607       266 QVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVA
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                60 QVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVA

gi|420607       326 HIKMSLV 333
                120 |||||.| 127
2               120 HIKMSVV 127
""",
            )
            hit = record[3]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|4206072|gb|AAD11407.1|")
            self.assertEqual(hit.target.name, "AAD11407")
            self.assertEqual(
                hit.target.description, "hevein-like protein [Sambucus nigra]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=333)")
            self.assertEqual(len(hit), 2)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1016.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 395.971001412075)
            self.assertAlmostEqual(hsp.annotations["evalue"], 6.7995613312017e-108)
            self.assertEqual(hsp.annotations["identity"], 193)
            self.assertEqual(hsp.annotations["positive"], 195)
            self.assertEqual(hsp.annotations["gaps"], 33)
            hsp = hit[1]
            self.assertAlmostEqual(hsp.score, 646.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 253.447158322654)
            self.assertAlmostEqual(hsp.annotations["evalue"], 5.45045505347399e-65)
            self.assertEqual(hsp.annotations["identity"], 120)
            self.assertEqual(hsp.annotations["positive"], 124)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[206, 333],
                              [  0, 127]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 127))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...SVV')",
            )
            self.assertEqual(hsp.query.id, "2")
            self.assertEqual(
                hsp.query.description,
                "gi|4218935|gb|AF074388.1|AF074388 Sambucus nigra hevein-like protein HLPf gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(127))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "2:1669..2049")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({206: 'NYYYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...SVV'}, length=333)",
            )
            self.assertEqual(hsp.target.id, "gi|4206072|gb|AAD11407.1|")
            self.assertEqual(hsp.target.name, "AAD11407")
            self.assertEqual(
                hsp.target.description, "hevein-like protein [Sambucus nigra]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "NY YGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASDQVPSYGVIS+II+SN GHQS LDTITTSIGYYKRYCDMLEVSYGDNL+NWFDETPF+KVAHIKMSVV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|420607       206 NYYYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD
                  0 ||.|||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                 0 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD

gi|420607       266 QVPSYGVISEIIDSNIGHQSSLDTITTSIGYYKRYCDMLEVSYGDNLKNWFDETPFSKVA
                 60 |||||||||.||.||.||||.||||||||||||||||||||||||||.||||||||.|||
2                60 QVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVA

gi|420607       326 HIKMSVV 333
                120 ||||||| 127
2               120 HIKMSVV 127
""",
            )
            hit = record[4]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|16903131|gb|AAL30421.1|AF434174_1")
            self.assertEqual(hit.target.name, "AAL30421")
            self.assertEqual(
                hit.target.description, "hevein-like protein [Sambucus nigra]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=330)")
            self.assertEqual(len(hit), 2)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 986.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 384.415014134554)
            self.assertAlmostEqual(hsp.annotations["evalue"], 2.04729155722083e-104)
            self.assertEqual(hsp.annotations["identity"], 190)
            self.assertEqual(hsp.annotations["positive"], 191)
            self.assertEqual(hsp.annotations["gaps"], 36)
            hsp = hit[1]
            self.assertAlmostEqual(hsp.score, 679.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 266.158744327927)
            self.assertAlmostEqual(hsp.annotations["evalue"], 8.12576171382949e-69)
            self.assertEqual(hsp.annotations["identity"], 126)
            self.assertEqual(hsp.annotations["positive"], 126)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[203, 330],
                              [  0, 127]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 127))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...SVV')",
            )
            self.assertEqual(hsp.query.id, "2")
            self.assertEqual(
                hsp.query.description,
                "gi|4218935|gb|AF074388.1|AF074388 Sambucus nigra hevein-like protein HLPf gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(127))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "2:1669..2049")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({203: 'NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...SVV'}, length=330)",
            )
            self.assertEqual(hsp.target.id, "gi|16903131|gb|AAL30421.1|AF434174_1")
            self.assertEqual(hsp.target.name, "AAL30421")
            self.assertEqual(
                hsp.target.description, "hevein-like protein [Sambucus nigra]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASDQVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKV HIKMSVV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|169031       203 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
2                 0 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD

gi|169031       263 QVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVV
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||.
2                60 QVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVA

gi|169031       323 HIKMSVV 330
                120 ||||||| 127
2               120 HIKMSVV 127
""",
            )
            hit = record[5]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|16903133|gb|AAL30422.1|AF434175_1")
            self.assertEqual(hit.target.name, "AAL30422")
            self.assertEqual(
                hit.target.description, "hevein-like protein [Sambucus nigra]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=336)")
            self.assertEqual(len(hit), 2)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 713.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 279.255529909117)
            self.assertAlmostEqual(hsp.annotations["evalue"], 9.27553088557319e-73)
            self.assertEqual(hsp.annotations["identity"], 148)
            self.assertEqual(hsp.annotations["positive"], 162)
            self.assertEqual(hsp.annotations["gaps"], 40)
            hsp = hit[1]
            self.assertAlmostEqual(hsp.score, 620.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 243.431969348803)
            self.assertAlmostEqual(hsp.annotations["evalue"], 5.64033703812707e-62)
            self.assertEqual(hsp.annotations["identity"], 115)
            self.assertEqual(hsp.annotations["positive"], 120)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[209, 336],
                              [  0, 127]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 127))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...SVV')",
            )
            self.assertEqual(hsp.query.id, "2")
            self.assertEqual(
                hsp.query.description,
                "gi|4218935|gb|AF074388.1|AF074388 Sambucus nigra hevein-like protein HLPf gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(127))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "2:1669..2049")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({209: 'NYNYGLAGEAIGIDLVNDPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...HVV'}, length=336)",
            )
            self.assertEqual(hsp.target.id, "gi|16903133|gb|AAL30422.1|AF434175_1")
            self.assertEqual(hsp.target.name, "AAL30422")
            self.assertEqual(
                hsp.target.description, "hevein-like protein [Sambucus nigra]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "NYNYGLAGEA+GIDLVN PDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINAN EASDQVPSYGV+S IINSN GH+SGLD ITTSIGYYKRYCDMLEVSYGDNL+NWFDETPF+KVA IKM VV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|169031       209 NYNYGLAGEAIGIDLVNDPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANYEASD
                  0 ||||||||||.||||||.|||||||||||||||||||||||||||||||||||||.||||
2                 0 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD

gi|169031       269 QVPSYGVLSNIINSNSGHKSGLDIITTSIGYYKRYCDMLEVSYGDNLKNWFDETPFSKVA
                 60 |||||||.|.|||||.||.||||.|||||||||||||||||||||||.||||||||.|||
2                60 QVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETPFTKVA

gi|169031       329 RIKMHVV 336
                120 .|||.|| 127
2               120 HIKMSVV 127
""",
            )
            hit = record[6]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|30691147|gb|AAO17294.1|")
            self.assertEqual(hit.target.name, "AAO17294")
            self.assertEqual(hit.target.description, "chitinase [Ficus carica]")
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=321)")
            self.assertEqual(len(hit), 2)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 481.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 189.889228296291)
            self.assertAlmostEqual(hsp.annotations["evalue"], 7.40075731140555e-46)
            self.assertEqual(hsp.annotations["identity"], 113)
            self.assertEqual(hsp.annotations["positive"], 138)
            self.assertEqual(hsp.annotations["gaps"], 49)
            hsp = hit[1]
            self.assertAlmostEqual(hsp.score, 426.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 168.703251620836)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.76559312729927e-39)
            self.assertEqual(hsp.annotations["identity"], 81)
            self.assertEqual(hsp.annotations["positive"], 99)
            self.assertEqual(hsp.annotations["gaps"], 10)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[202, 261, 261, 266, 266, 308, 309, 320],
                              [  0,  59,  60,  65,  73, 115, 115, 126]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 127))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...MSV')",
            )
            self.assertEqual(hsp.query.id, "2")
            self.assertEqual(
                hsp.query.description,
                "gi|4218935|gb|AF074388.1|AF074388 Sambucus nigra hevein-like protein HLPf gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(126))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "2:1669..2046")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({202: 'NHNYGLVGEALGIDLINNPDLVATDPVVSFKTAIWFWMTRHQNKPSFHGVIINA...MPV'}, length=321)",
            )
            self.assertEqual(hsp.target.id, "gi|30691147|gb|AAO17294.1|")
            self.assertEqual(hsp.target.name, "AAO17294")
            self.assertEqual(hsp.target.description, "chitinase [Ficus carica]")
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "N+NYGL GEALGIDL+N+PDLVATDP+VSFKTAIWFWMT+H N PS H ++INANSE S  +P++        SNFG +S LD +  SIGYYKRYCDML+VS+GDNL+ W+D TP F+ V+ I M V",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|306911       202 NHNYGLVGEALGIDLINNPDLVATDPVVSFKTAIWFWMTRHQNKPSFHGVIINANSEPS-
                  0 |.||||.||||||||.|.||||||||.||||||||||||.|.|.||.|...||||||.|-
2                 0 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD

gi|306911       261 HIPNH--------SNFGQESVLDVVNRSIGYYKRYCDMLKVSFGDNLKYWYDGTPNFSDV
                 60 ..|..--------||||..|.||....||||||||||||.||.||||..|.|.||-|..|
2                60 QVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNLENWFDETP-FTKV

gi|306911       313 SRIGMPV 320
                120 ..|.|.| 127
2               119 AHIKMSV 126
""",
            )
            hit = record[7]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|222139388|gb|ACM45713.1|")
            self.assertEqual(hit.target.name, "ACM45713")
            self.assertEqual(
                hit.target.description, "class I chitinase [Pyrus pyrifolia]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=317)")
            self.assertEqual(len(hit), 2)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 469.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 185.266833385283)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.82286993845418e-44)
            self.assertEqual(hsp.annotations["identity"], 111)
            self.assertEqual(hsp.annotations["positive"], 137)
            self.assertEqual(hsp.annotations["gaps"], 50)
            hsp = hit[1]
            self.assertAlmostEqual(hsp.score, 318.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 127.101697421762)
            self.assertAlmostEqual(hsp.annotations["evalue"], 5.89123449548921e-27)
            self.assertEqual(hsp.annotations["identity"], 62)
            self.assertEqual(hsp.annotations["positive"], 84)
            self.assertEqual(hsp.annotations["gaps"], 7)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[195, 247, 252, 284, 285, 309, 309, 316],
                              [  0,  52,  52,  84,  84, 108, 109, 116]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 122))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...TPF')",
            )
            self.assertEqual(hsp.query.id, "2")
            self.assertEqual(
                hsp.query.description,
                "gi|4218935|gb|AF074388.1|AF074388 Sambucus nigra hevein-like protein HLPf gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(116))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "2:1669..2016")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({195: 'NYNYGQAGKAIGKDLINNPDLVATDPVVSFKTAIWFWMTPQGNKPSSHDVITGR...RPF'}, length=317)",
            )
            self.assertEqual(hsp.target.id, "gi|222139388|gb|ACM45713.1|")
            self.assertEqual(hsp.target.name, "ACM45713")
            self.assertEqual(
                hsp.target.description, "class I chitinase [Pyrus pyrifolia]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "NYNYG AG+A+G DL+N+PDLVATDP+VSFKTAIWFWMT   N PS HD++      +    ++ +VP YGVI+ IIN       G D  + + IG+Y+RYC +L V+ GDNL+  +++ PF",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|222139       195 NYNYGQAGKAIGKDLINNPDLVATDPVVSFKTAIWFWMTPQGNKPSSHDVITGRWSPSTA
                  0 |||||.||.|.|.||.|.||||||||.||||||||||||...|.||.||...-----...
2                 0 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILI-----NAN

gi|222139       255 DRSAGRVPGYGVITNIINGGVECGKGQDARVASRIGFYRRYCQILGVNPGDNLD-CYNQR
                 60 ......||.||||..|||.......|.|.-....||.|.|||..|.|..||||.-.....
2                55 SEASDQVPSYGVISKIINSNFGHQSGLDT-ITTSIGYYKRYCDMLEVSYGDNLENWFDET

gi|222139       314 PF 316
                120 || 122
2               114 PF 116
""",
            )
            hit = record[8]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|23496435|dbj|BAB40817.2|")
            self.assertEqual(hit.target.name, "BAB40817")
            self.assertEqual(
                hit.target.description, "endochitinase MCHT-2 [Cucumis melo]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=311)")
            self.assertEqual(len(hit), 2)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 460.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 181.800037202027)
            self.assertAlmostEqual(hsp.annotations["evalue"], 2.01541888137674e-43)
            self.assertEqual(hsp.annotations["identity"], 109)
            self.assertEqual(hsp.annotations["positive"], 132)
            self.assertEqual(hsp.annotations["gaps"], 54)
            hsp = hit[1]
            self.assertAlmostEqual(hsp.score, 285.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 114.39011141649)
            self.assertAlmostEqual(hsp.annotations["evalue"], 3.95161831690075e-23)
            self.assertEqual(hsp.annotations["identity"], 56)
            self.assertEqual(hsp.annotations["positive"], 75)
            self.assertEqual(hsp.annotations["gaps"], 7)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[191, 211, 211, 242, 247, 277, 278, 304],
                              [  0,  20,  21,  52,  52,  82,  82, 108]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 114))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...NLE')",
            )
            self.assertEqual(hsp.query.id, "2")
            self.assertEqual(
                hsp.query.description,
                "gi|4218935|gb|AF074388.1|AF074388 Sambucus nigra hevein-like protein HLPf gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(108))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "2:1669..1992")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({191: 'NYNYGPAGKAIGAPLLTNPDTATDPVTSFKTALWFWMTAQGNKPSCHNVITGNW...NLD'}, length=311)",
            )
            self.assertEqual(hsp.target.id, "gi|23496435|dbj|BAB40817.2|")
            self.assertEqual(hsp.target.name, "BAB40817")
            self.assertEqual(
                hsp.target.description, "endochitinase MCHT-2 [Cucumis melo]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "NYNYG AG+A+G  L+ +PD  ATDP+ SFKTA+WFWMT   N PS H+++      ++   A+ +VP YGVI+ IIN       G  D +   IG+YKRYCDML + YG+NL+",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|234964       191 NYNYGPAGKAIGAPLLTNPD-TATDPVTSFKTALWFWMTAQGNKPSCHNVITGNWQPSSA
                  0 |||||.||.|.|..|...||-.||||..|||||.|||||...|.||.|....-----...
2                 0 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILI-----NAN

gi|234964       250 DNAAGRVPGYGVITNIINGGLECGRGPDDRVKDRIGFYKRYCDMLGIGYGNNLD 304
                 60 ..|...||.||||..|||.......|.-|.....||.||||||||...||.||. 114
2                55 SEASDQVPSYGVISKIINSNFGHQSGL-DTITTSIGYYKRYCDMLEVSYGDNLE 108
""",
            )
            hit = record[9]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|82621253|gb|ABB86300.1|")
            self.assertEqual(hit.target.name, "ABB86300")
            self.assertEqual(hit.target.description, "chitinase [Ficus awkeotsang]")
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=301)")
            self.assertEqual(len(hit), 2)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 459.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 181.414837626109)
            self.assertAlmostEqual(hsp.annotations["evalue"], 2.6322185753765e-43)
            self.assertEqual(hsp.annotations["identity"], 114)
            self.assertEqual(hsp.annotations["positive"], 134)
            self.assertEqual(hsp.annotations["gaps"], 50)
            hsp = hit[1]
            self.assertAlmostEqual(hsp.score, 359.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 142.894880034374)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.03749166509001e-31)
            self.assertEqual(hsp.annotations["identity"], 67)
            self.assertEqual(hsp.annotations["positive"], 83)
            self.assertEqual(hsp.annotations["gaps"], 9)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[203, 263, 263, 268, 268, 301],
                              [  0,  60,  61,  66,  74, 107]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 107))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINA...DNL')",
            )
            self.assertEqual(hsp.query.id, "2")
            self.assertEqual(
                hsp.query.description,
                "gi|4218935|gb|AF074388.1|AF074388 Sambucus nigra hevein-like protein HLPf gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(107))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "2:1669..1989")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({203: 'NHNYGLVGEALGIDLINNPELVATDPVISFKTAIWFWMARYEDKPSFHDVIINA...DNL'}, length=301)",
            )
            self.assertEqual(hsp.target.id, "gi|82621253|gb|ABB86300.1|")
            self.assertEqual(hsp.target.name, "ABB86300")
            self.assertEqual(hsp.target.description, "chitinase [Ficus awkeotsang]")
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "N+NYGL GEALGIDL+N+P+LVATDP++SFKTAIWFWM ++++ PS HD++INAN EASD +P +G        N G +S LD +  SIGYYKRYCDML VS  DNL",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|826212       203 NHNYGLVGEALGIDLINNPELVATDPVISFKTAIWFWMARYEDKPSFHDVIINANFEASD
                  0 |.||||.||||||||.|.|.||||||..||||||||||......||.||..||||.||||
2                 0 NYNYGLAGEALGIDLVNHPDLVATDPIVSFKTAIWFWMTQHDNNPSLHDILINANSEASD

gi|826212       263 -IPYHG--------NSGQESSLDVVNRSIGYYKRYCDMLGVSCEDNL 301
                 60 -.|..|--------|.|..|.||....||||||||||||.||..||| 107
2                60 QVPSYGVISKIINSNFGHQSGLDTITTSIGYYKRYCDMLEVSYGDNL 107
""",
            )
            record = next(records)
            self.assertIsInstance(record.query, SeqRecord)
            self.assertEqual(record.query.id, "3")
            self.assertEqual(
                record.query.description,
                "gi|5690369|gb|AF158246.1|AF158246 Cricetulus griseus glucose phosphate isomerase (GPI) gene, partial intron sequence",
            )
            self.assertEqual(repr(record.query.seq), "Seq(None, length=550)")

            self.assertEqual(len(record.stat), 7)
            self.assertEqual(record.stat["db-num"], 8994603)
            self.assertEqual(record.stat["db-len"], -1216159329)
            self.assertEqual(record.stat["hsp-len"], 0)
            self.assertAlmostEqual(record.stat["eff-space"], 108443629616.0)
            self.assertAlmostEqual(record.stat["kappa"], 0.041)
            self.assertAlmostEqual(record.stat["lambda"], 0.267)
            self.assertAlmostEqual(record.stat["entropy"], 0.14)
            self.assertEqual(len(record), 0)
            record = next(records)
            self.assertIsInstance(record.query, SeqRecord)
            self.assertEqual(record.query.id, "4")
            self.assertEqual(
                record.query.description,
                "gi|5049839|gb|AI730987.1|AI730987 BNLGHi8354 Six-day Cotton fiber Gossypium hirsutum cDNA 5' similar to TUBULIN BETA-1 CHAIN gi|486734|pir|S35142 tubulin beta chain - white lupine gi|402636 (X70184) Beta tubulin 1 [Lupinus albus], mRNA sequence",
            )
            self.assertEqual(repr(record.query.seq), "Seq(None, length=655)")

            self.assertEqual(len(record.stat), 7)
            self.assertEqual(record.stat["db-num"], 8994603)
            self.assertEqual(record.stat["db-len"], -1216159329)
            self.assertEqual(record.stat["hsp-len"], 0)
            self.assertAlmostEqual(record.stat["eff-space"], 165344802738.0)
            self.assertAlmostEqual(record.stat["kappa"], 0.041)
            self.assertAlmostEqual(record.stat["lambda"], 0.267)
            self.assertAlmostEqual(record.stat["entropy"], 0.14)
            self.assertEqual(len(record), 10)
            hit = record[0]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|166343825|gb|ABY86655.1|")
            self.assertEqual(hit.target.name, "ABY86655")
            self.assertEqual(
                hit.target.description, "beta-tubulin 4 [Gossypium hirsutum]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=448)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1048.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 408.29738784143)
            self.assertAlmostEqual(hsp.annotations["evalue"], 2.26145081918239e-112)
            self.assertEqual(hsp.annotations["identity"], 196)
            self.assertEqual(hsp.annotations["positive"], 197)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 201],
                              [  0, 201]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 201))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEA...CMV')",
            )
            self.assertEqual(hsp.query.id, "4")
            self.assertEqual(
                hsp.query.description,
                "gi|5049839|gb|AI730987.1|AI730987 BNLGHi8354 Six-day Cotton fiber Gossypium hirsutum cDNA 5' similar to TUBULIN BETA-1 CHAIN gi|486734|pir|S35142 tubulin beta chain - white lupine gi|402636 (X70184) Beta tubulin 1 [Lupinus albus], mRNA sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(201))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "4:50..652")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({0: 'MREILHIQAGQCGNQIGAKFWEVVCAEHGIDSTGRYQGDNDLQLERVNVYYNEA...CMV'}, length=448)",
            )
            self.assertEqual(hsp.target.id, "gi|166343825|gb|ABY86655.1|")
            self.assertEqual(hsp.target.name, "ABY86655")
            self.assertEqual(
                hsp.target.description, "beta-tubulin 4 [Gossypium hirsutum]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MREILHIQAGQCGNQIGA FWEVVCAEHGI+STGRYQGDNDLQLERVNVYYNEASCGRFVPRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDS LDVVRKEAENCDCLQGFQVCHSLG GTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVVEPYNATLSVH LVENADECMV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|166343         0 MREILHIQAGQCGNQIGAKFWEVVCAEHGIDSTGRYQGDNDLQLERVNVYYNEASCGRFV
                  0 ||||||||||||||||||.|||||||||||.|||||||||||||||||||||||||||||
4                 0 MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEASCGRFV

gi|166343        60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSVLDVV
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||||.||||
4                60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSXLDVV

gi|166343       120 RKEAENCDCLQGFQVCHSLGGGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV
                120 ||||||||||||||||||||.|||||||||||||||||||||||||||||||||||||||
4               120 RKEAENCDCLQGFQVCHSLGRGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV

gi|166343       180 EPYNATLSVHQLVENADECMV 201
                180 ||||||||||.|||||||||| 201
4               180 EPYNATLSVHXLVENADECMV 201
""",
            )
            hit = record[1]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|223549899|gb|EEF51386.1|")
            self.assertEqual(hit.target.name, "EEF51386")
            self.assertEqual(
                hit.target.description,
                "tubulin beta chain, putative [Ricinus communis]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=448)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1044.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 406.756589537761)
            self.assertAlmostEqual(hsp.annotations["evalue"], 6.57981456092236e-112)
            self.assertEqual(hsp.annotations["identity"], 195)
            self.assertEqual(hsp.annotations["positive"], 196)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 201],
                              [  0, 201]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 201))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEA...CMV')",
            )
            self.assertEqual(hsp.query.id, "4")
            self.assertEqual(
                hsp.query.description,
                "gi|5049839|gb|AI730987.1|AI730987 BNLGHi8354 Six-day Cotton fiber Gossypium hirsutum cDNA 5' similar to TUBULIN BETA-1 CHAIN gi|486734|pir|S35142 tubulin beta chain - white lupine gi|402636 (X70184) Beta tubulin 1 [Lupinus albus], mRNA sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(201))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "4:50..652")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({0: 'MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYQGDNDLQLERVNVYYNEA...CMV'}, length=448)",
            )
            self.assertEqual(hsp.target.id, "gi|223549899|gb|EEF51386.1|")
            self.assertEqual(hsp.target.name, "EEF51386")
            self.assertEqual(
                hsp.target.description,
                "tubulin beta chain, putative [Ricinus communis]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MREILHIQ GQCGNQIGA FWEVVCAEHGI+STGRYQGDNDLQLERVNVYYNEASCGRFVPRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDS LDVVRKEAENCDCLQGFQVCHSLG GTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVVEPYNATLSVH LVENADECMV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|223549         0 MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYQGDNDLQLERVNVYYNEASCGRFV
                  0 ||||||||.|||||||||.|||||||||||.|||||||||||||||||||||||||||||
4                 0 MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEASCGRFV

gi|223549        60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSVLDVV
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||||.||||
4                60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSXLDVV

gi|223549       120 RKEAENCDCLQGFQVCHSLGGGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV
                120 ||||||||||||||||||||.|||||||||||||||||||||||||||||||||||||||
4               120 RKEAENCDCLQGFQVCHSLGRGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV

gi|223549       180 EPYNATLSVHQLVENADECMV 201
                180 ||||||||||.|||||||||| 201
4               180 EPYNATLSVHXLVENADECMV 201
""",
            )
            hit = record[2]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|18420724|ref|NP_568437.1|")
            self.assertEqual(hit.target.name, "NP_568437")
            self.assertEqual(
                hit.target.description,
                "TUB8 (tubulin beta-8) [Arabidopsis thaliana] >gi|27735261|sp|P29516.2|TBB8_ARATH RecName: Full=Tubulin beta-8 chain; AltName: Full=Beta-8-tubulin >gi|10176853|dbj|BAB10059.1| beta tubulin [Arabidopsis thaliana]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=449)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1040.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 405.215791234091)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.91443295113426e-111)
            self.assertEqual(hsp.annotations["identity"], 194)
            self.assertEqual(hsp.annotations["positive"], 196)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 201],
                              [  0, 201]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 201))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEA...CMV')",
            )
            self.assertEqual(hsp.query.id, "4")
            self.assertEqual(
                hsp.query.description,
                "gi|5049839|gb|AI730987.1|AI730987 BNLGHi8354 Six-day Cotton fiber Gossypium hirsutum cDNA 5' similar to TUBULIN BETA-1 CHAIN gi|486734|pir|S35142 tubulin beta chain - white lupine gi|402636 (X70184) Beta tubulin 1 [Lupinus albus], mRNA sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(201))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "4:50..652")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({0: 'MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYQGENDLQLERVNVYYNEA...CMV'}, length=449)",
            )
            self.assertEqual(hsp.target.id, "gi|18420724|ref|NP_568437.1|")
            self.assertEqual(hsp.target.name, "NP_568437")
            self.assertEqual(
                hsp.target.description,
                "TUB8 (tubulin beta-8) [Arabidopsis thaliana] >gi|27735261|sp|P29516.2|TBB8_ARATH RecName: Full=Tubulin beta-8 chain; AltName: Full=Beta-8-tubulin >gi|10176853|dbj|BAB10059.1| beta tubulin [Arabidopsis thaliana]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MREILHIQ GQCGNQIGA FWEVVCAEHGI+STGRYQG+NDLQLERVNVYYNEASCGRFVPRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDS LDVVRKEAENCDCLQGFQVCHSLG GTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVVEPYNATLSVH LVENADECMV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|184207         0 MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYQGENDLQLERVNVYYNEASCGRFV
                  0 ||||||||.|||||||||.|||||||||||.|||||||.|||||||||||||||||||||
4                 0 MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEASCGRFV

gi|184207        60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSVLDVV
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||||.||||
4                60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSXLDVV

gi|184207       120 RKEAENCDCLQGFQVCHSLGGGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV
                120 ||||||||||||||||||||.|||||||||||||||||||||||||||||||||||||||
4               120 RKEAENCDCLQGFQVCHSLGRGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV

gi|184207       180 EPYNATLSVHQLVENADECMV 201
                180 ||||||||||.|||||||||| 201
4               180 EPYNATLSVHXLVENADECMV 201
""",
            )
            hit = record[3]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|225426385|ref|XP_002271992.1|")
            self.assertEqual(hit.target.name, "XP_002271992")
            self.assertEqual(
                hit.target.description,
                "PREDICTED: hypothetical protein [Vitis vinifera] >gi|157356601|emb|CAO62796.1| unnamed protein product [Vitis vinifera]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=447)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1034.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 402.904593778587)
            self.assertAlmostEqual(hsp.annotations["evalue"], 9.50123195540709e-111)
            self.assertEqual(hsp.annotations["identity"], 193)
            self.assertEqual(hsp.annotations["positive"], 195)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 201],
                              [  0, 201]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 201))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEA...CMV')",
            )
            self.assertEqual(hsp.query.id, "4")
            self.assertEqual(
                hsp.query.description,
                "gi|5049839|gb|AI730987.1|AI730987 BNLGHi8354 Six-day Cotton fiber Gossypium hirsutum cDNA 5' similar to TUBULIN BETA-1 CHAIN gi|486734|pir|S35142 tubulin beta chain - white lupine gi|402636 (X70184) Beta tubulin 1 [Lupinus albus], mRNA sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(201))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "4:50..652")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({0: 'MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYHGDSDLQLERVNVYYNEA...CMV'}, length=447)",
            )
            self.assertEqual(hsp.target.id, "gi|225426385|ref|XP_002271992.1|")
            self.assertEqual(hsp.target.name, "XP_002271992")
            self.assertEqual(
                hsp.target.description,
                "PREDICTED: hypothetical protein [Vitis vinifera] >gi|157356601|emb|CAO62796.1| unnamed protein product [Vitis vinifera]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MREILHIQ GQCGNQIGA FWEVVCAEHGI+STGRY GD+DLQLERVNVYYNEASCGRFVPRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDS LDVVRKEAENCDCLQGFQVCHSLG GTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVVEPYNATLSVH LVENADECMV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|225426         0 MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYHGDSDLQLERVNVYYNEASCGRFV
                  0 ||||||||.|||||||||.|||||||||||.|||||.||.||||||||||||||||||||
4                 0 MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEASCGRFV

gi|225426        60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSVLDVV
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||||.||||
4                60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSXLDVV

gi|225426       120 RKEAENCDCLQGFQVCHSLGGGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV
                120 ||||||||||||||||||||.|||||||||||||||||||||||||||||||||||||||
4               120 RKEAENCDCLQGFQVCHSLGRGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV

gi|225426       180 EPYNATLSVHQLVENADECMV 201
                180 ||||||||||.|||||||||| 201
4               180 EPYNATLSVHXLVENADECMV 201
""",
            )
            hit = record[4]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|15451226|gb|AAK96884.1|")
            self.assertEqual(hit.target.name, "AAK96884")
            self.assertEqual(
                hit.target.description,
                "beta tubulin [Arabidopsis thaliana] >gi|20148289|gb|AAM10035.1| beta tubulin [Arabidopsis thaliana]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=449)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1034.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 402.904593778587)
            self.assertAlmostEqual(hsp.annotations["evalue"], 9.50123195540709e-111)
            self.assertEqual(hsp.annotations["identity"], 193)
            self.assertEqual(hsp.annotations["positive"], 195)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 201],
                              [  0, 201]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 201))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEA...CMV')",
            )
            self.assertEqual(hsp.query.id, "4")
            self.assertEqual(
                hsp.query.description,
                "gi|5049839|gb|AI730987.1|AI730987 BNLGHi8354 Six-day Cotton fiber Gossypium hirsutum cDNA 5' similar to TUBULIN BETA-1 CHAIN gi|486734|pir|S35142 tubulin beta chain - white lupine gi|402636 (X70184) Beta tubulin 1 [Lupinus albus], mRNA sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(201))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "4:50..652")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({0: 'MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYQGEKDLQLERVNVYYNEA...CMV'}, length=449)",
            )
            self.assertEqual(hsp.target.id, "gi|15451226|gb|AAK96884.1|")
            self.assertEqual(hsp.target.name, "AAK96884")
            self.assertEqual(
                hsp.target.description,
                "beta tubulin [Arabidopsis thaliana] >gi|20148289|gb|AAM10035.1| beta tubulin [Arabidopsis thaliana]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MREILHIQ GQCGNQIGA FWEVVCAEHGI+STGRYQG+ DLQLERVNVYYNEASCGRFVPRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDS LDVVRKEAENCDCLQGFQVCHSLG GTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVVEPYNATLSVH LVENADECMV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|154512         0 MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYQGEKDLQLERVNVYYNEASCGRFV
                  0 ||||||||.|||||||||.|||||||||||.|||||||..||||||||||||||||||||
4                 0 MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEASCGRFV

gi|154512        60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSVLDVV
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||||.||||
4                60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSXLDVV

gi|154512       120 RKEAENCDCLQGFQVCHSLGGGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV
                120 ||||||||||||||||||||.|||||||||||||||||||||||||||||||||||||||
4               120 RKEAENCDCLQGFQVCHSLGRGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV

gi|154512       180 EPYNATLSVHQLVENADECMV 201
                180 ||||||||||.|||||||||| 201
4               180 EPYNATLSVHXLVENADECMV 201
""",
            )
            hit = record[5]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|225470745|ref|XP_002267380.1|")
            self.assertEqual(hit.target.name, "XP_002267380")
            self.assertEqual(
                hit.target.description,
                "PREDICTED: hypothetical protein [Vitis vinifera] >gi|157327486|emb|CAO15467.1| unnamed protein product [Vitis vinifera]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=449)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1033.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 402.51939420267)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.24089932237309e-110)
            self.assertEqual(hsp.annotations["identity"], 192)
            self.assertEqual(hsp.annotations["positive"], 195)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 201],
                              [  0, 201]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 201))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEA...CMV')",
            )
            self.assertEqual(hsp.query.id, "4")
            self.assertEqual(
                hsp.query.description,
                "gi|5049839|gb|AI730987.1|AI730987 BNLGHi8354 Six-day Cotton fiber Gossypium hirsutum cDNA 5' similar to TUBULIN BETA-1 CHAIN gi|486734|pir|S35142 tubulin beta chain - white lupine gi|402636 (X70184) Beta tubulin 1 [Lupinus albus], mRNA sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(201))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "4:50..652")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({0: 'MREILHVQGGQCGNQIGAKFWEVVCAEHGIDSTGRYQGDTELQLERVNVYYNEA...CMV'}, length=449)",
            )
            self.assertEqual(hsp.target.id, "gi|225470745|ref|XP_002267380.1|")
            self.assertEqual(hsp.target.name, "XP_002267380")
            self.assertEqual(
                hsp.target.description,
                "PREDICTED: hypothetical protein [Vitis vinifera] >gi|157327486|emb|CAO15467.1| unnamed protein product [Vitis vinifera]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MREILH+Q GQCGNQIGA FWEVVCAEHGI+STGRYQGD +LQLERVNVYYNEASCGRFVPRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDS LDVVRKEAENCDCLQGFQVCHSLG GTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVVEPYNATLSVH LVENADECMV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|225470         0 MREILHVQGGQCGNQIGAKFWEVVCAEHGIDSTGRYQGDTELQLERVNVYYNEASCGRFV
                  0 ||||||.|.|||||||||.|||||||||||.||||||||..|||||||||||||||||||
4                 0 MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEASCGRFV

gi|225470        60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSVLDVV
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||||.||||
4                60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSXLDVV

gi|225470       120 RKEAENCDCLQGFQVCHSLGGGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV
                120 ||||||||||||||||||||.|||||||||||||||||||||||||||||||||||||||
4               120 RKEAENCDCLQGFQVCHSLGRGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV

gi|225470       180 EPYNATLSVHQLVENADECMV 201
                180 ||||||||||.|||||||||| 201
4               180 EPYNATLSVHXLVENADECMV 201
""",
            )
            hit = record[6]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|586076|sp|P37392.1|TBB1_LUPAL")
            self.assertEqual(hit.target.name, "P37392")
            self.assertEqual(
                hit.target.description,
                "RecName: Full=Tubulin beta-1 chain; AltName: Full=Beta-1-tubulin >gi|402636|emb|CAA49736.1| Beta tubulin 1 [Lupinus albus]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=447)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1033.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 402.51939420267)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.24089932237309e-110)
            self.assertEqual(hsp.annotations["identity"], 193)
            self.assertEqual(hsp.annotations["positive"], 195)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 201],
                              [  0, 201]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 201))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEA...CMV')",
            )
            self.assertEqual(hsp.query.id, "4")
            self.assertEqual(
                hsp.query.description,
                "gi|5049839|gb|AI730987.1|AI730987 BNLGHi8354 Six-day Cotton fiber Gossypium hirsutum cDNA 5' similar to TUBULIN BETA-1 CHAIN gi|486734|pir|S35142 tubulin beta chain - white lupine gi|402636 (X70184) Beta tubulin 1 [Lupinus albus], mRNA sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(201))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "4:50..652")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({0: 'MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYGGDNELQLERVNVYYNEA...CMV'}, length=447)",
            )
            self.assertEqual(hsp.target.id, "gi|586076|sp|P37392.1|TBB1_LUPAL")
            self.assertEqual(hsp.target.name, "P37392")
            self.assertEqual(
                hsp.target.description,
                "RecName: Full=Tubulin beta-1 chain; AltName: Full=Beta-1-tubulin >gi|402636|emb|CAA49736.1| Beta tubulin 1 [Lupinus albus]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MREILHIQ GQCGNQIGA FWEVVCAEHGI+STGRY GDN+LQLERVNVYYNEASCGRFVPRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDS LDVVRKEAENCDCLQGFQVCHSLG GTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVVEPYNATLSVH LVENADECMV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|586076         0 MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYGGDNELQLERVNVYYNEASCGRFV
                  0 ||||||||.|||||||||.|||||||||||.|||||.|||.|||||||||||||||||||
4                 0 MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEASCGRFV

gi|586076        60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSVLDVV
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||||.||||
4                60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSXLDVV

gi|586076       120 RKEAENCDCLQGFQVCHSLGGGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV
                120 ||||||||||||||||||||.|||||||||||||||||||||||||||||||||||||||
4               120 RKEAENCDCLQGFQVCHSLGRGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV

gi|586076       180 EPYNATLSVHQLVENADECMV 201
                180 ||||||||||.|||||||||| 201
4               180 EPYNATLSVHXLVENADECMV 201
""",
            )
            hit = record[7]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|224104341|ref|XP_002313404.1|")
            self.assertEqual(hit.target.name, "XP_002313404")
            self.assertEqual(
                hit.target.description,
                "tubulin, beta chain [Populus trichocarpa] >gi|222849812|gb|EEE87359.1| tubulin, beta chain [Populus trichocarpa]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=451)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1031.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 401.748995050835)
            self.assertAlmostEqual(hsp.annotations["evalue"], 2.1166536544662e-110)
            self.assertEqual(hsp.annotations["identity"], 192)
            self.assertEqual(hsp.annotations["positive"], 195)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 201],
                              [  0, 201]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 201))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEA...CMV')",
            )
            self.assertEqual(hsp.query.id, "4")
            self.assertEqual(
                hsp.query.description,
                "gi|5049839|gb|AI730987.1|AI730987 BNLGHi8354 Six-day Cotton fiber Gossypium hirsutum cDNA 5' similar to TUBULIN BETA-1 CHAIN gi|486734|pir|S35142 tubulin beta chain - white lupine gi|402636 (X70184) Beta tubulin 1 [Lupinus albus], mRNA sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(201))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "4:50..652")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({0: 'MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYQGDSPLQLERINVYYNEA...CMV'}, length=451)",
            )
            self.assertEqual(hsp.target.id, "gi|224104341|ref|XP_002313404.1|")
            self.assertEqual(hsp.target.name, "XP_002313404")
            self.assertEqual(
                hsp.target.description,
                "tubulin, beta chain [Populus trichocarpa] >gi|222849812|gb|EEE87359.1| tubulin, beta chain [Populus trichocarpa]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MREILHIQ GQCGNQIGA FWEVVCAEHGI+STGRYQGD+ LQLER+NVYYNEASCGRFVPRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDS LDVVRKEAENCDCLQGFQVCHSLG GTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVVEPYNATLSVH LVENADECMV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|224104         0 MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYQGDSPLQLERINVYYNEASCGRFV
                  0 ||||||||.|||||||||.|||||||||||.||||||||..|||||.|||||||||||||
4                 0 MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEASCGRFV

gi|224104        60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSVLDVV
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||||.||||
4                60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSXLDVV

gi|224104       120 RKEAENCDCLQGFQVCHSLGGGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV
                120 ||||||||||||||||||||.|||||||||||||||||||||||||||||||||||||||
4               120 RKEAENCDCLQGFQVCHSLGRGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV

gi|224104       180 EPYNATLSVHQLVENADECMV 201
                180 ||||||||||.|||||||||| 201
4               180 EPYNATLSVHXLVENADECMV 201
""",
            )
            hit = record[8]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|223549679|gb|EEF51167.1|")
            self.assertEqual(hit.target.name, "EEF51167")
            self.assertEqual(
                hit.target.description,
                "tubulin beta chain, putative [Ricinus communis]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=446)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1029.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 400.978595899)
            self.assertAlmostEqual(hsp.annotations["evalue"], 3.61046429165375e-110)
            self.assertEqual(hsp.annotations["identity"], 191)
            self.assertEqual(hsp.annotations["positive"], 194)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 201],
                              [  0, 201]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 201))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEA...CMV')",
            )
            self.assertEqual(hsp.query.id, "4")
            self.assertEqual(
                hsp.query.description,
                "gi|5049839|gb|AI730987.1|AI730987 BNLGHi8354 Six-day Cotton fiber Gossypium hirsutum cDNA 5' similar to TUBULIN BETA-1 CHAIN gi|486734|pir|S35142 tubulin beta chain - white lupine gi|402636 (X70184) Beta tubulin 1 [Lupinus albus], mRNA sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(201))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "4:50..652")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({0: 'MREILHVQGGQCGNQIGAKFWEVVCAEHGIDSTGRYHGDTDLQLERVNVYYNEA...CMV'}, length=446)",
            )
            self.assertEqual(hsp.target.id, "gi|223549679|gb|EEF51167.1|")
            self.assertEqual(hsp.target.name, "EEF51167")
            self.assertEqual(
                hsp.target.description,
                "tubulin beta chain, putative [Ricinus communis]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MREILH+Q GQCGNQIGA FWEVVCAEHGI+STGRY GD DLQLERVNVYYNEASCGRFVPRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDS LDVVRKEAENCDCLQGFQVCHSLG GTGSGMGTLLISK+REEYPDRMMLTFSVFPSPKVSDTVVEPYNATLSVH LVENADECMV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|223549         0 MREILHVQGGQCGNQIGAKFWEVVCAEHGIDSTGRYHGDTDLQLERVNVYYNEASCGRFV
                  0 ||||||.|.|||||||||.|||||||||||.|||||.||.||||||||||||||||||||
4                 0 MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEASCGRFV

gi|223549        60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSVLDVV
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||||.||||
4                60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSXLDVV

gi|223549       120 RKEAENCDCLQGFQVCHSLGGGTGSGMGTLLISKMREEYPDRMMLTFSVFPSPKVSDTVV
                120 ||||||||||||||||||||.|||||||||||||.|||||||||||||||||||||||||
4               120 RKEAENCDCLQGFQVCHSLGRGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV

gi|223549       180 EPYNATLSVHQLVENADECMV 201
                180 ||||||||||.|||||||||| 201
4               180 EPYNATLSVHXLVENADECMV 201
""",
            )
            hit = record[9]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|224058553|ref|XP_002299541.1|")
            self.assertEqual(hit.target.name, "XP_002299541")
            self.assertEqual(
                hit.target.description,
                "tubulin, beta chain [Populus trichocarpa] >gi|222846799|gb|EEE84346.1| tubulin, beta chain [Populus trichocarpa]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=447)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 1029.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 400.978595899)
            self.assertAlmostEqual(hsp.annotations["evalue"], 3.61046429165375e-110)
            self.assertEqual(hsp.annotations["identity"], 192)
            self.assertEqual(hsp.annotations["positive"], 195)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 201],
                              [  0, 201]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 201))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEA...CMV')",
            )
            self.assertEqual(hsp.query.id, "4")
            self.assertEqual(
                hsp.query.description,
                "gi|5049839|gb|AI730987.1|AI730987 BNLGHi8354 Six-day Cotton fiber Gossypium hirsutum cDNA 5' similar to TUBULIN BETA-1 CHAIN gi|486734|pir|S35142 tubulin beta chain - white lupine gi|402636 (X70184) Beta tubulin 1 [Lupinus albus], mRNA sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(201))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "4:50..652")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({0: 'MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYQGDSALQIERVNVYYNEA...CMV'}, length=447)",
            )
            self.assertEqual(hsp.target.id, "gi|224058553|ref|XP_002299541.1|")
            self.assertEqual(hsp.target.name, "XP_002299541")
            self.assertEqual(
                hsp.target.description,
                "tubulin, beta chain [Populus trichocarpa] >gi|222846799|gb|EEE84346.1| tubulin, beta chain [Populus trichocarpa]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MREILHIQ GQCGNQIGA FWEVVCAEHGI+STGRYQGD+ LQ+ERVNVYYNEASCGRFVPRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDS LDVVRKEAENCDCLQGFQVCHSLG GTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVVEPYNATLSVH LVENADECMV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|224058         0 MREILHIQGGQCGNQIGAKFWEVVCAEHGIDSTGRYQGDSALQIERVNVYYNEASCGRFV
                  0 ||||||||.|||||||||.|||||||||||.||||||||..||.||||||||||||||||
4                 0 MREILHIQAGQCGNQIGANFWEVVCAEHGINSTGRYQGDNDLQLERVNVYYNEASCGRFV

gi|224058        60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSVLDVV
                 60 |||||||||||||||||||||||||||||||||||||||||||||||||||||||.||||
4                60 PRAVLMDLEPGTMDSVRSGPYGQIFRPDNFVFGQSGAGNNWAKGHYTEGAELIDSXLDVV

gi|224058       120 RKEAENCDCLQGFQVCHSLGGGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV
                120 ||||||||||||||||||||.|||||||||||||||||||||||||||||||||||||||
4               120 RKEAENCDCLQGFQVCHSLGRGTGSGMGTLLISKIREEYPDRMMLTFSVFPSPKVSDTVV

gi|224058       180 EPYNATLSVHQLVENADECMV 201
                180 ||||||||||.|||||||||| 201
4               180 EPYNATLSVHXLVENADECMV 201
""",
            )
            record = next(records)
            self.assertIsInstance(record.query, SeqRecord)
            self.assertEqual(record.query.id, "5")
            self.assertEqual(
                record.query.description,
                "gi|5052071|gb|AF067555.1|AF067555 Phlox stansburyi internal transcribed spacer 1, 5.8S ribosomal RNA gene, and internal transcribed spacer 2, complete sequence",
            )
            self.assertEqual(repr(record.query.seq), "Seq(None, length=623)")

            self.assertEqual(len(record.stat), 7)
            self.assertEqual(record.stat["db-num"], 8994603)
            self.assertEqual(record.stat["db-len"], -1216159329)
            self.assertEqual(record.stat["hsp-len"], 0)
            self.assertAlmostEqual(record.stat["eff-space"], 147032237429.0)
            self.assertAlmostEqual(record.stat["kappa"], 0.041)
            self.assertAlmostEqual(record.stat["lambda"], 0.267)
            self.assertAlmostEqual(record.stat["entropy"], 0.14)
            self.assertEqual(len(record), 10)
            hit = record[0]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|110740644|dbj|BAE98425.1|")
            self.assertEqual(hit.target.name, "BAE98425")
            self.assertEqual(
                hit.target.description, "hypothetical protein [Arabidopsis thaliana]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=80)")
            self.assertEqual(len(hit), 2)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 231.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 93.5893343169526)
            self.assertAlmostEqual(hsp.annotations["evalue"], 5.57283114448317e-19)
            self.assertEqual(hsp.annotations["identity"], 42)
            self.assertEqual(hsp.annotations["positive"], 45)
            self.assertEqual(hsp.annotations["gaps"], 1)
            hsp = hit[1]
            self.assertAlmostEqual(hsp.score, 53.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 25.0238098036637)
            self.assertAlmostEqual(hsp.annotations["evalue"], 5.57283114448317e-19)
            self.assertEqual(hsp.annotations["identity"], 13)
            self.assertEqual(hsp.annotations["positive"], 13)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[53, 70],
                              [ 0, 17]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 17))
            self.assertEqual(repr(hsp.query.seq), "Seq('RKLVSRALRCAVGLNKS')")
            self.assertEqual(hsp.query.id, "5")
            self.assertEqual(
                hsp.query.description,
                "gi|5052071|gb|AF067555.1|AF067555 Phlox stansburyi internal transcribed spacer 1, 5.8S ribosomal RNA gene, and internal transcribed spacer 2, complete sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(17))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "5:455..505")
            self.assertEqual(
                repr(hsp.target.seq), "Seq({53: 'RKLVSRVLPHAVGLNPS'}, length=80)"
            )
            self.assertEqual(hsp.target.id, "gi|110740644|dbj|BAE98425.1|")
            self.assertEqual(hsp.target.name, "BAE98425")
            self.assertEqual(
                hsp.target.description, "hypothetical protein [Arabidopsis thaliana]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(hsp.annotations["midline"], "RKLVSR L  AVGLN S")
            self.assertEqual(
                str(hsp),
                """\
gi|110740        53 RKLVSRVLPHAVGLNPS 70
                  0 ||||||.|..|||||.| 17
5                 0 RKLVSRALRCAVGLNKS 17
""",
            )
            hit = record[1]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|226453533|gb|EEH50844.1|")
            self.assertEqual(hit.target.name, "EEH50844")
            self.assertEqual(
                hit.target.description,
                "predicted protein [Micromonas pusilla CCMP1545]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=81)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 238.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 96.2857313483741)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.69151855577931e-18)
            self.assertEqual(hsp.annotations["identity"], 42)
            self.assertEqual(hsp.annotations["positive"], 45)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 0, 49],
                              [ 0, 49]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 49))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MKNVAKCDTWCELQNPVNHRVFERKLRPKPLGRGHVCLGVSHRVAPNPF')",
            )
            self.assertEqual(hsp.query.id, "5")
            self.assertEqual(
                hsp.query.description,
                "gi|5052071|gb|AF067555.1|AF067555 Phlox stansburyi internal transcribed spacer 1, 5.8S ribosomal RNA gene, and internal transcribed spacer 2, complete sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(49))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "5:283..429")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({0: 'MKNVAKCDTWCELQNPVNHRVFERKLRPKPSGRGHVCLGVTNRRPPSSF'}, length=81)",
            )
            self.assertEqual(hsp.target.id, "gi|226453533|gb|EEH50844.1|")
            self.assertEqual(hsp.target.name, "EEH50844")
            self.assertEqual(
                hsp.target.description,
                "predicted protein [Micromonas pusilla CCMP1545]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MKNVAKCDTWCELQNPVNHRVFERKLRPKP GRGHVCLGV++R  P+ F",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|226453         0 MKNVAKCDTWCELQNPVNHRVFERKLRPKPSGRGHVCLGVTNRRPPSSF 49
                  0 ||||||||||||||||||||||||||||||.|||||||||..|..|..| 49
5                 0 MKNVAKCDTWCELQNPVNHRVFERKLRPKPLGRGHVCLGVSHRVAPNPF 49
""",
            )
            hit = record[2]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|168069582|ref|XP_001786502.1|")
            self.assertEqual(hit.target.name, "XP_001786502")
            self.assertEqual(
                hit.target.description,
                "predicted protein [Physcomitrella patens subsp. patens] >gi|162661153|gb|EDQ48685.1| predicted protein [Physcomitrella patens subsp. patens]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=88)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 183.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 75.0997546729196)
            self.assertAlmostEqual(hsp.annotations["evalue"], 4.03544314604194e-12)
            self.assertEqual(hsp.annotations["identity"], 37)
            self.assertEqual(hsp.annotations["positive"], 39)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 2, 44],
                              [ 0, 42]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 42))
            self.assertEqual(
                repr(hsp.query.seq), "Seq('ASGATCVQKLDGSRDSAIHTKYRISLRSSSMREPRYPLPRVV')"
            )
            self.assertEqual(hsp.query.id, "5")
            self.assertEqual(
                hsp.query.description,
                "gi|5052071|gb|AF067555.1|AF067555 Phlox stansburyi internal transcribed spacer 1, 5.8S ribosomal RNA gene, and internal transcribed spacer 2, complete sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(42))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "complement(5:245..370)")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({2: 'ASGATCVQKLDDSRDSAIHTTYRISLRSSSLQEPRYPLLRVV'}, length=88)",
            )
            self.assertEqual(hsp.target.id, "gi|168069582|ref|XP_001786502.1|")
            self.assertEqual(hsp.target.name, "XP_001786502")
            self.assertEqual(
                hsp.target.description,
                "predicted protein [Physcomitrella patens subsp. patens] >gi|162661153|gb|EDQ48685.1| predicted protein [Physcomitrella patens subsp. patens]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"], "ASGATCVQKLD SRDSAIHT YRISLRSSS++EPRYPL RVV"
            )
            self.assertEqual(
                str(hsp),
                """\
gi|168069         2 ASGATCVQKLDDSRDSAIHTTYRISLRSSSLQEPRYPLLRVV 44
                  0 |||||||||||.||||||||.|||||||||..||||||.||| 42
5                 0 ASGATCVQKLDGSRDSAIHTKYRISLRSSSMREPRYPLPRVV 42
""",
            )
            hit = record[3]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|168068558|ref|XP_001786120.1|")
            self.assertEqual(hit.target.name, "XP_001786120")
            self.assertEqual(
                hit.target.description,
                "predicted protein [Physcomitrella patens subsp. patens] >gi|162662102|gb|EDQ49068.1| predicted protein [Physcomitrella patens subsp. patens]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=130)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 178.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 73.1737567933329)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.53346675969648e-11)
            self.assertEqual(hsp.annotations["identity"], 36)
            self.assertEqual(hsp.annotations["positive"], 39)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 2, 44],
                              [ 0, 42]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 42))
            self.assertEqual(
                repr(hsp.query.seq), "Seq('ASGATCVQKLDGSRDSAIHTKYRISLRSSSMREPRYPLPRVV')"
            )
            self.assertEqual(hsp.query.id, "5")
            self.assertEqual(
                hsp.query.description,
                "gi|5052071|gb|AF067555.1|AF067555 Phlox stansburyi internal transcribed spacer 1, 5.8S ribosomal RNA gene, and internal transcribed spacer 2, complete sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(42))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "complement(5:245..370)")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({2: 'ASGATCVQKLDDSRNSAIHTTYRISLRSSSLQEPRYPLLRVV'}, length=130)",
            )
            self.assertEqual(hsp.target.id, "gi|168068558|ref|XP_001786120.1|")
            self.assertEqual(hsp.target.name, "XP_001786120")
            self.assertEqual(
                hsp.target.description,
                "predicted protein [Physcomitrella patens subsp. patens] >gi|162662102|gb|EDQ49068.1| predicted protein [Physcomitrella patens subsp. patens]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"], "ASGATCVQKLD SR+SAIHT YRISLRSSS++EPRYPL RVV"
            )
            self.assertEqual(
                str(hsp),
                """\
gi|168068         2 ASGATCVQKLDDSRNSAIHTTYRISLRSSSLQEPRYPLLRVV 44
                  0 |||||||||||.||.|||||.|||||||||..||||||.||| 42
5                 0 ASGATCVQKLDGSRDSAIHTKYRISLRSSSMREPRYPLPRVV 42
""",
            )
            hit = record[4]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|168068926|ref|XP_001786259.1|")
            self.assertEqual(hit.target.name, "XP_001786259")
            self.assertEqual(
                hit.target.description,
                "predicted protein [Physcomitrella patens subsp. patens] >gi|168069965|ref|XP_001786641.1| predicted protein [Physcomitrella patens subsp. patens] >gi|162660807|gb|EDQ48545.1| predicted protein [Physcomitrella patens subsp. patens] >gi|162661808|gb|EDQ48929.1| predicted protein [Physcomitrella patens subsp. patens]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=148)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 178.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 73.1737567933329)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.53346675969648e-11)
            self.assertEqual(hsp.annotations["identity"], 36)
            self.assertEqual(hsp.annotations["positive"], 39)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 2, 44],
                              [ 0, 42]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 42))
            self.assertEqual(
                repr(hsp.query.seq), "Seq('ASGATCVQKLDGSRDSAIHTKYRISLRSSSMREPRYPLPRVV')"
            )
            self.assertEqual(hsp.query.id, "5")
            self.assertEqual(
                hsp.query.description,
                "gi|5052071|gb|AF067555.1|AF067555 Phlox stansburyi internal transcribed spacer 1, 5.8S ribosomal RNA gene, and internal transcribed spacer 2, complete sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(42))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "complement(5:245..370)")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({2: 'ASGATCVQKLDDSRNSAIHTTYRISLRSSSLQEPRYPLLRVV'}, length=148)",
            )
            self.assertEqual(hsp.target.id, "gi|168068926|ref|XP_001786259.1|")
            self.assertEqual(hsp.target.name, "XP_001786259")
            self.assertEqual(
                hsp.target.description,
                "predicted protein [Physcomitrella patens subsp. patens] >gi|168069965|ref|XP_001786641.1| predicted protein [Physcomitrella patens subsp. patens] >gi|162660807|gb|EDQ48545.1| predicted protein [Physcomitrella patens subsp. patens] >gi|162661808|gb|EDQ48929.1| predicted protein [Physcomitrella patens subsp. patens]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"], "ASGATCVQKLD SR+SAIHT YRISLRSSS++EPRYPL RVV"
            )
            self.assertEqual(
                str(hsp),
                """\
gi|168068         2 ASGATCVQKLDDSRNSAIHTTYRISLRSSSLQEPRYPLLRVV 44
                  0 |||||||||||.||.|||||.|||||||||..||||||.||| 42
5                 0 ASGATCVQKLDGSRDSAIHTKYRISLRSSSMREPRYPLPRVV 42
""",
            )
            hit = record[5]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|168070288|ref|XP_001786759.1|")
            self.assertEqual(hit.target.name, "XP_001786759")
            self.assertEqual(
                hit.target.description,
                "predicted protein [Physcomitrella patens subsp. patens] >gi|162660550|gb|EDQ48427.1| predicted protein [Physcomitrella patens subsp. patens]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=148)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 178.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 73.1737567933329)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.53346675969648e-11)
            self.assertEqual(hsp.annotations["identity"], 36)
            self.assertEqual(hsp.annotations["positive"], 39)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 2, 44],
                              [ 0, 42]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 42))
            self.assertEqual(
                repr(hsp.query.seq), "Seq('ASGATCVQKLDGSRDSAIHTKYRISLRSSSMREPRYPLPRVV')"
            )
            self.assertEqual(hsp.query.id, "5")
            self.assertEqual(
                hsp.query.description,
                "gi|5052071|gb|AF067555.1|AF067555 Phlox stansburyi internal transcribed spacer 1, 5.8S ribosomal RNA gene, and internal transcribed spacer 2, complete sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(42))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "complement(5:245..370)")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({2: 'ASGATCVQKLDDSRNSAIHTTYRISLRSSSLQEPRYPLLRVV'}, length=148)",
            )
            self.assertEqual(hsp.target.id, "gi|168070288|ref|XP_001786759.1|")
            self.assertEqual(hsp.target.name, "XP_001786759")
            self.assertEqual(
                hsp.target.description,
                "predicted protein [Physcomitrella patens subsp. patens] >gi|162660550|gb|EDQ48427.1| predicted protein [Physcomitrella patens subsp. patens]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"], "ASGATCVQKLD SR+SAIHT YRISLRSSS++EPRYPL RVV"
            )
            self.assertEqual(
                str(hsp),
                """\
gi|168070         2 ASGATCVQKLDDSRNSAIHTTYRISLRSSSLQEPRYPLLRVV 44
                  0 |||||||||||.||.|||||.|||||||||..||||||.||| 42
5                 0 ASGATCVQKLDGSRDSAIHTKYRISLRSSSMREPRYPLPRVV 42
""",
            )
            hit = record[6]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|168068591|ref|XP_001786133.1|")
            self.assertEqual(hit.target.name, "XP_001786133")
            self.assertEqual(
                hit.target.description,
                "predicted protein [Physcomitrella patens subsp. patens] >gi|162662081|gb|EDQ49057.1| predicted protein [Physcomitrella patens subsp. patens]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=220)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 172.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 70.8625593378288)
            self.assertAlmostEqual(hsp.annotations["evalue"], 7.61051640442713e-11)
            self.assertEqual(hsp.annotations["identity"], 42)
            self.assertEqual(hsp.annotations["positive"], 50)
            self.assertEqual(hsp.annotations["gaps"], 8)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[142, 169, 172, 183, 183, 220],
                              [  0,  27,  27,  38,  43,  80]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 83))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('RPTAHRSARETNFRSQTVESRRKWVGGDAM*DAQADVPSA*WLRAQLAFKNSMV...IRC')",
            )
            self.assertEqual(hsp.query.id, "5")
            self.assertEqual(
                hsp.query.description,
                "gi|5052071|gb|AF067555.1|AF067555 Phlox stansburyi internal transcribed spacer 1, 5.8S ribosomal RNA gene, and internal transcribed spacer 2, complete sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(80))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "complement(5:256..495)")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({142: 'RGLCHHADSDGQFHSTLPIKDIKRIGGCRDDALAGMPSDEPRAQLAFKNSMIHG...IRC'}, length=220)",
            )
            self.assertEqual(hsp.target.id, "gi|168068591|ref|XP_001786133.1|")
            self.assertEqual(hsp.target.name, "XP_001786133")
            self.assertEqual(
                hsp.target.description,
                "predicted protein [Physcomitrella patens subsp. patens] >gi|162662081|gb|EDQ49057.1| predicted protein [Physcomitrella patens subsp. patens]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "R   H +  +  F S       K +GG   DA+    +D P     RAQLAFKNSM+HGILQFT  IAFR VLHRC+S+DIRC",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|168068       142 RGLCHHADSDGQFHSTLPIKDIKRIGGCRDDALAGMPSDEP-----RAQLAFKNSMIHGI
                  0 |...|.......|.|.......|..||---||......|.|-----||||||||||.|||
5                 0 RPTAHRSARETNFRSQTVESRRKWVGG---DAM*DAQADVPSA*WLRAQLAFKNSMVHGI

gi|168068       197 LQFTLRIAFRCVLHRCKSQDIRC 220
                 60 ||||..||||.|||||.|.||||  83
5                57 LQFTPSIAFRYVLHRCESRDIRC  80
""",
            )
            hit = record[7]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|74622391|sp|Q8TGM5|ART3_YEAST")
            self.assertEqual(hit.target.name, "Q8TGM5")
            self.assertEqual(
                hit.target.description,
                "Uncharacterized protein ART3 (Antisense to ribosomal RNA transcript protein 3) >gi|18767126|gb|AAL79278.1| unknown [Saccharomyces cerevisiae]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=67)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 141.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 58.9213724843908)
            self.assertAlmostEqual(hsp.annotations["evalue"], 2.99274389212967e-07)
            self.assertEqual(hsp.annotations["identity"], 29)
            self.assertEqual(hsp.annotations["positive"], 32)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 7, 46],
                              [ 0, 39]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 39))
            self.assertEqual(
                repr(hsp.query.seq), "Seq('GATCVQKLDGSRDSAIHTKYRISLRSSSMREPRYPLPRV')"
            )
            self.assertEqual(hsp.query.id, "5")
            self.assertEqual(
                hsp.query.description,
                "gi|5052071|gb|AF067555.1|AF067555 Phlox stansburyi internal transcribed spacer 1, 5.8S ribosomal RNA gene, and internal transcribed spacer 2, complete sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(39))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "complement(5:248..364)")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({7: 'GAMCVQRFDDSRNSAIHITYRISLRSSSMREPRDPLLKV'}, length=67)",
            )
            self.assertEqual(hsp.target.id, "gi|74622391|sp|Q8TGM5|ART3_YEAST")
            self.assertEqual(hsp.target.name, "Q8TGM5")
            self.assertEqual(
                hsp.target.description,
                "Uncharacterized protein ART3 (Antisense to ribosomal RNA transcript protein 3) >gi|18767126|gb|AAL79278.1| unknown [Saccharomyces cerevisiae]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"], "GA CVQ+ D SR+SAIH  YRISLRSSSMREPR PL +V"
            )
            self.assertEqual(
                str(hsp),
                """\
gi|746223         7 GAMCVQRFDDSRNSAIHITYRISLRSSSMREPRDPLLKV 46
                  0 ||.|||..|.||.||||..||||||||||||||.||..| 39
5                 0 GATCVQKLDGSRDSAIHTKYRISLRSSSMREPRYPLPRV 39
""",
            )
            hit = record[8]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|168069944|ref|XP_001786634.1|")
            self.assertEqual(hit.target.name, "XP_001786634")
            self.assertEqual(
                hit.target.description,
                "predicted protein [Physcomitrella patens subsp. patens] >gi|162660825|gb|EDQ48552.1| predicted protein [Physcomitrella patens subsp. patens]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=138)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 137.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 57.3805741807214)
            self.assertAlmostEqual(hsp.annotations["evalue"], 8.70755166175354e-07)
            self.assertEqual(hsp.annotations["identity"], 28)
            self.assertEqual(hsp.annotations["positive"], 31)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 0, 34],
                              [ 0, 34]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 34))
            self.assertEqual(
                repr(hsp.query.seq), "Seq('KLDGSRDSAIHTKYRISLRSSSMREPRYPLPRVV')"
            )
            self.assertEqual(hsp.query.id, "5")
            self.assertEqual(
                hsp.query.description,
                "gi|5052071|gb|AF067555.1|AF067555 Phlox stansburyi internal transcribed spacer 1, 5.8S ribosomal RNA gene, and internal transcribed spacer 2, complete sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(34))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "complement(5:245..346)")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({0: 'KLDDSRNSAIHTTYRISLRSSSLQEPRYPLLRVV'}, length=138)",
            )
            self.assertEqual(hsp.target.id, "gi|168069944|ref|XP_001786634.1|")
            self.assertEqual(hsp.target.name, "XP_001786634")
            self.assertEqual(
                hsp.target.description,
                "predicted protein [Physcomitrella patens subsp. patens] >gi|162660825|gb|EDQ48552.1| predicted protein [Physcomitrella patens subsp. patens]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"], "KLD SR+SAIHT YRISLRSSS++EPRYPL RVV"
            )
            self.assertEqual(
                str(hsp),
                """\
gi|168069         0 KLDDSRNSAIHTTYRISLRSSSLQEPRYPLLRVV 34
                  0 |||.||.|||||.|||||||||..||||||.||| 34
5                 0 KLDGSRDSAIHTKYRISLRSSSMREPRYPLPRVV 34
""",
            )
            hit = record[9]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|50307717|ref|XP_453851.1|")
            self.assertEqual(hit.target.name, "XP_453851")
            self.assertEqual(
                hit.target.description, "unnamed protein product [Kluyveromyces lactis]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=54)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 134.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 56.2249754529693)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.93984013155423e-06)
            self.assertEqual(hsp.annotations["identity"], 28)
            self.assertEqual(hsp.annotations["positive"], 31)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 7, 47],
                              [ 0, 40]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 40))
            self.assertEqual(
                repr(hsp.query.seq), "Seq('GATCVQKLDGSRDSAIHTKYRISLRSSSMREPRYPLPRVV')"
            )
            self.assertEqual(hsp.query.id, "5")
            self.assertEqual(
                hsp.query.description,
                "gi|5052071|gb|AF067555.1|AF067555 Phlox stansburyi internal transcribed spacer 1, 5.8S ribosomal RNA gene, and internal transcribed spacer 2, complete sequence",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(40))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "complement(5:245..364)")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({7: 'GAMCVQRFDDSRKSAIHNTYRNSLRSSSMREPRDPLLKVL'}, length=54)",
            )
            self.assertEqual(hsp.target.id, "gi|50307717|ref|XP_453851.1|")
            self.assertEqual(hsp.target.name, "XP_453851")
            self.assertEqual(
                hsp.target.description, "unnamed protein product [Kluyveromyces lactis]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"], "GA CVQ+ D SR SAIH  YR SLRSSSMREPR PL +V+"
            )
            self.assertEqual(
                str(hsp),
                """\
gi|503077         7 GAMCVQRFDDSRKSAIHNTYRNSLRSSSMREPRDPLLKVL 47
                  0 ||.|||..|.||.||||..||.|||||||||||.||..|. 40
5                 0 GATCVQKLDGSRDSAIHTKYRISLRSSSMREPRYPLPRVV 40
""",
            )
            record = next(records)
            self.assertIsInstance(record.query, SeqRecord)
            self.assertEqual(record.query.id, "6")
            self.assertEqual(
                record.query.description,
                "gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds",
            )
            self.assertEqual(repr(record.query.seq), "Seq(None, length=309)")

            self.assertEqual(len(record.stat), 7)
            self.assertEqual(record.stat["db-num"], 8994603)
            self.assertEqual(record.stat["db-len"], -1216159329)
            self.assertEqual(record.stat["hsp-len"], 0)
            self.assertAlmostEqual(record.stat["eff-space"], 75367093081.0)
            self.assertAlmostEqual(record.stat["kappa"], 0.041)
            self.assertAlmostEqual(record.stat["lambda"], 0.267)
            self.assertAlmostEqual(record.stat["entropy"], 0.14)
            self.assertEqual(len(record), 10)
            hit = record[0]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|3176603|gb|AAC18749.1|")
            self.assertEqual(hit.target.name, "AAC18749")
            self.assertEqual(
                hit.target.description, "phytochrome A [Lathyrus odoratus]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=103)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 543.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 213.771602003167)
            self.assertAlmostEqual(hsp.annotations["evalue"], 3.7262743863676e-54)
            self.assertEqual(hsp.annotations["identity"], 103)
            self.assertEqual(hsp.annotations["positive"], 103)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 103],
                              [  0, 103]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 103))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.query.id, "6")
            self.assertEqual(
                hsp.query.description,
                "gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(103))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "6:1..309")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.target.id, "gi|3176603|gb|AAC18749.1|")
            self.assertEqual(hsp.target.name, "AAC18749")
            self.assertEqual(
                hsp.target.description, "phytochrome A [Lathyrus odoratus]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIASLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|317660         0 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
6                 0 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA

gi|317660        60 SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV 103
                 60 ||||||||||||||||||||||||||||||||||||||||||| 103
6                60 SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV 103
""",
            )
            hit = record[1]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|130188|sp|P15001.1|PHYA_PEA")
            self.assertEqual(hit.target.name, "P15001")
            self.assertEqual(
                hit.target.description,
                "RecName: Full=Phytochrome A >gi|169132|gb|AAA33682.1| phytochrome [Pisum sativum] >gi|295830|emb|CAA32242.1| phytochrome apoprotein [Pisum sativum] >gi|51173514|gb|AAT97643.1| phytochrome A apoprotein [Pisum sativum] >gi|226757|prf||1604466A phytochrome",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=1124)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 530.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 208.764007516241)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.1987013044853e-52)
            self.assertEqual(hsp.annotations["identity"], 101)
            self.assertEqual(hsp.annotations["positive"], 102)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[275, 378],
                              [  0, 103]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 103))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.query.id, "6")
            self.assertEqual(
                hsp.query.description,
                "gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(103))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "6:1..309")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({275: 'QAARFLFMKNKVRMIVDCNAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV'}, length=1124)",
            )
            self.assertEqual(hsp.target.id, "gi|130188|sp|P15001.1|PHYA_PEA")
            self.assertEqual(hsp.target.name, "P15001")
            self.assertEqual(
                hsp.target.description,
                "RecName: Full=Phytochrome A >gi|169132|gb|AAA33682.1| phytochrome [Pisum sativum] >gi|295830|emb|CAA32242.1| phytochrome apoprotein [Pisum sativum] >gi|51173514|gb|AAT97643.1| phytochrome A apoprotein [Pisum sativum] >gi|226757|prf||1604466A phytochrome",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "QAARFLFMKNKVRMIVDC+AKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIASLVMAVVVNDSDEDGDS DAVLPQKKKRLWGLVVCHNTTPRFV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|130188       275 QAARFLFMKNKVRMIVDCNAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA
                  0 ||||||||||||||||||.|||||||||||||||||||||||||||||||||||||||||
6                 0 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA

gi|130188       335 SLVMAVVVNDSDEDGDSADAVLPQKKKRLWGLVVCHNTTPRFV 378
                 60 |||||||||||||||||.||||||||||||||||||||||||| 103
6                60 SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV 103
""",
            )
            hit = record[2]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|2499555|sp|P93673.1|PHYA_LATSA")
            self.assertEqual(hit.target.name, "P93673")
            self.assertEqual(
                hit.target.description,
                "RecName: Full=Phytochrome type A >gi|1848273|gb|AAB47994.1| phytochrome type A [Lathyrus sativus]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=1124)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 530.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 208.764007516241)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.1987013044853e-52)
            self.assertEqual(hsp.annotations["identity"], 101)
            self.assertEqual(hsp.annotations["positive"], 102)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[275, 378],
                              [  0, 103]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 103))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.query.id, "6")
            self.assertEqual(
                hsp.query.description,
                "gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(103))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "6:1..309")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({275: 'QAARFLFMKNKVRMIVDCNAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV'}, length=1124)",
            )
            self.assertEqual(hsp.target.id, "gi|2499555|sp|P93673.1|PHYA_LATSA")
            self.assertEqual(hsp.target.name, "P93673")
            self.assertEqual(
                hsp.target.description,
                "RecName: Full=Phytochrome type A >gi|1848273|gb|AAB47994.1| phytochrome type A [Lathyrus sativus]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "QAARFLFMKNKVRMIVDC+AKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIASLVMAVVVNDSDEDGDS DAVLPQKKKRLWGLVVCHNTTPRFV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|249955       275 QAARFLFMKNKVRMIVDCNAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA
                  0 ||||||||||||||||||.|||||||||||||||||||||||||||||||||||||||||
6                 0 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA

gi|249955       335 SLVMAVVVNDSDEDGDSADAVLPQKKKRLWGLVVCHNTTPRFV 378
                 60 |||||||||||||||||.||||||||||||||||||||||||| 103
6                60 SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV 103
""",
            )
            hit = record[3]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|3176595|gb|AAC18745.1|")
            self.assertEqual(hit.target.name, "AAC18745")
            self.assertEqual(
                hit.target.description,
                "phytochrome A [Lennea melanocarpa] >gi|3176597|gb|AAC18746.1| phytochrome A [Hebestigma cubense] >gi|3176609|gb|AAC18752.1| phytochrome A [Sesbania cochichinensis] >gi|3176611|gb|AAC18753.1| phytochrome A [Sesbania emerus]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=103)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 528.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 207.993608364407)
            self.assertAlmostEqual(hsp.annotations["evalue"], 2.04467473791515e-52)
            self.assertEqual(hsp.annotations["identity"], 100)
            self.assertEqual(hsp.annotations["positive"], 101)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 103],
                              [  0, 103]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 103))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.query.id, "6")
            self.assertEqual(
                hsp.query.description,
                "gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(103))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "6:1..309")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.target.id, "gi|3176595|gb|AAC18745.1|")
            self.assertEqual(hsp.target.name, "AAC18745")
            self.assertEqual(
                hsp.target.description,
                "phytochrome A [Lennea melanocarpa] >gi|3176597|gb|AAC18746.1| phytochrome A [Hebestigma cubense] >gi|3176609|gb|AAC18752.1| phytochrome A [Sesbania cochichinensis] >gi|3176611|gb|AAC18753.1| phytochrome A [Sesbania emerus]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIASLVMAVVVNDSDEDGDS DAV PQK+KRLWGLVVCHNTTPRFV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|317659         0 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
6                 0 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA

gi|317659        60 SLVMAVVVNDSDEDGDSSDAVQPQKRKRLWGLVVCHNTTPRFV 103
                 60 |||||||||||||||||.|||.|||.||||||||||||||||| 103
6                60 SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV 103
""",
            )
            hit = record[4]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|1711106|gb|AAC18675.1|")
            self.assertEqual(hit.target.name, "AAC18675")
            self.assertEqual(hit.target.description, "phytochrome A [Sophora affinis]")
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=210)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 528.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 207.993608364407)
            self.assertAlmostEqual(hsp.annotations["evalue"], 2.04467473791515e-52)
            self.assertEqual(hsp.annotations["identity"], 100)
            self.assertEqual(hsp.annotations["positive"], 101)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 40, 143],
                              [  0, 103]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 103))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.query.id, "6")
            self.assertEqual(
                hsp.query.description,
                "gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(103))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "6:1..309")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({40: 'QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV'}, length=210)",
            )
            self.assertEqual(hsp.target.id, "gi|1711106|gb|AAC18675.1|")
            self.assertEqual(hsp.target.name, "AAC18675")
            self.assertEqual(hsp.target.description, "phytochrome A [Sophora affinis]")
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIASLVMAVVVNDSDEDGDS DAV PQK+KRLWGLVVCHNTTPRFV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|171110        40 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
6                 0 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA

gi|171110       100 SLVMAVVVNDSDEDGDSSDAVQPQKRKRLWGLVVCHNTTPRFV 143
                 60 |||||||||||||||||.|||.|||.||||||||||||||||| 103
6                60 SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV 103
""",
            )
            hit = record[5]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|1711090|gb|AAC18670.1|")
            self.assertEqual(hit.target.name, "AAC18670")
            self.assertEqual(
                hit.target.description, "phytochrome A [Myrospermum sousanum]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=210)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 525.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 206.838009636654)
            self.assertAlmostEqual(hsp.annotations["evalue"], 4.55506009801166e-52)
            self.assertEqual(hsp.annotations["identity"], 99)
            self.assertEqual(hsp.annotations["positive"], 101)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 40, 143],
                              [  0, 103]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 103))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.query.id, "6")
            self.assertEqual(
                hsp.query.description,
                "gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(103))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "6:1..309")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({40: 'QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV'}, length=210)",
            )
            self.assertEqual(hsp.target.id, "gi|1711090|gb|AAC18670.1|")
            self.assertEqual(hsp.target.name, "AAC18670")
            self.assertEqual(
                hsp.target.description, "phytochrome A [Myrospermum sousanum]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIASLV+AVVVNDSDEDGDS DAV PQK+KRLWGLVVCHNTTPRFV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|171109        40 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
6                 0 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA

gi|171109       100 SLVLAVVVNDSDEDGDSSDAVQPQKRKRLWGLVVCHNTTPRFV 143
                 60 |||.|||||||||||||.|||.|||.||||||||||||||||| 103
6                60 SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV 103
""",
            )
            hit = record[6]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|3176605|gb|AAC18750.1|")
            self.assertEqual(hit.target.name, "AAC18750")
            self.assertEqual(
                hit.target.description, "phytochrome A [Hybosema robustum]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=103)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 524.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 206.452810060737)
            self.assertAlmostEqual(hsp.annotations["evalue"], 5.94909272347008e-52)
            self.assertEqual(hsp.annotations["identity"], 99)
            self.assertEqual(hsp.annotations["positive"], 100)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 103],
                              [  0, 103]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 103))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.query.id, "6")
            self.assertEqual(
                hsp.query.description,
                "gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(103))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "6:1..309")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('QATRFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.target.id, "gi|3176605|gb|AAC18750.1|")
            self.assertEqual(hsp.target.name, "AAC18750")
            self.assertEqual(
                hsp.target.description, "phytochrome A [Hybosema robustum]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "QA RFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIASLVMAVVVNDSDEDGDS DAV PQK+KRLWGLVVCHNTTPRFV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|317660         0 QATRFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA
                  0 ||.|||||||||||||||||||||||||||||||||||||||||||||||||||||||||
6                 0 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA

gi|317660        60 SLVMAVVVNDSDEDGDSSDAVQPQKRKRLWGLVVCHNTTPRFV 103
                 60 |||||||||||||||||.|||.|||.||||||||||||||||| 103
6                60 SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV 103
""",
            )
            hit = record[7]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|3176454|gb|AAC18668.1|")
            self.assertEqual(hit.target.name, "AAC18668")
            self.assertEqual(
                hit.target.description, "phytochrome A [Cyclolobium nutans]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=207)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 523.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 206.06761048482)
            self.assertAlmostEqual(hsp.annotations["evalue"], 7.76975571582328e-52)
            self.assertEqual(hsp.annotations["identity"], 99)
            self.assertEqual(hsp.annotations["positive"], 101)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 37, 140],
                              [  0, 103]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 103))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.query.id, "6")
            self.assertEqual(
                hsp.query.description,
                "gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(103))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "6:1..309")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({37: 'QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV'}, length=207)",
            )
            self.assertEqual(hsp.target.id, "gi|3176454|gb|AAC18668.1|")
            self.assertEqual(hsp.target.name, "AAC18668")
            self.assertEqual(
                hsp.target.description, "phytochrome A [Cyclolobium nutans]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIASLVMAVVVNDSDEDG+S DAV PQK+KRLWGLVVCHNTTPRFV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|317645        37 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
6                 0 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA

gi|317645        97 SLVMAVVVNDSDEDGNSSDAVQPQKRKRLWGLVVCHNTTPRFV 140
                 60 |||||||||||||||.|.|||.|||.||||||||||||||||| 103
6                60 SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV 103
""",
            )
            hit = record[8]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|3176523|gb|AAC18709.1|")
            self.assertEqual(hit.target.name, "AAC18709")
            self.assertEqual(
                hit.target.description, "phytochrome A [Millettia richardiana]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=139)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 521.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 205.297211332985)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.3253195915005e-51)
            self.assertEqual(hsp.annotations["identity"], 98)
            self.assertEqual(hsp.annotations["positive"], 101)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[ 36, 139],
                              [  0, 103]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 103))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.query.id, "6")
            self.assertEqual(
                hsp.query.description,
                "gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(103))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "6:1..309")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({36: 'QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV'}, length=139)",
            )
            self.assertEqual(hsp.target.id, "gi|3176523|gb|AAC18709.1|")
            self.assertEqual(hsp.target.name, "AAC18709")
            self.assertEqual(
                hsp.target.description, "phytochrome A [Millettia richardiana]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIASLVMAVVVND++EDGDS DAV PQK+KRLWGLVVCHNTTPRFV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|317652        36 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
6                 0 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA

gi|317652        96 SLVMAVVVNDNEEDGDSSDAVQPQKRKRLWGLVVCHNTTPRFV 139
                 60 ||||||||||..|||||.|||.|||.||||||||||||||||| 103
6                60 SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV 103
""",
            )
            hit = record[9]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|3176494|gb|AAC18693.1|")
            self.assertEqual(hit.target.name, "AAC18693")
            self.assertEqual(
                hit.target.description, "phytochrome A [Callerya atropurpurea]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=177)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 520.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 204.912011757068)
            self.assertAlmostEqual(hsp.annotations["evalue"], 1.73092099081406e-51)
            self.assertEqual(hsp.annotations["identity"], 98)
            self.assertEqual(hsp.annotations["positive"], 101)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  7, 110],
                              [  0, 103]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 103))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV')",
            )
            self.assertEqual(hsp.query.id, "6")
            self.assertEqual(
                hsp.query.description,
                "gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(103))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "6:1..309")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq({7: 'QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMA...RFV'}, length=177)",
            )
            self.assertEqual(hsp.target.id, "gi|3176494|gb|AAC18693.1|")
            self.assertEqual(hsp.target.name, "AAC18693")
            self.assertEqual(
                hsp.target.description, "phytochrome A [Callerya atropurpurea]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIASLVMAVVVNDS+EDGDS +AV PQK+KRLWGLVVCHNTTPRFV",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|317649         7 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
6                 0 QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA

gi|317649        67 SLVMAVVVNDSEEDGDSSEAVQPQKRKRLWGLVVCHNTTPRFV 110
                 60 |||||||||||.|||||..||.|||.||||||||||||||||| 103
6                60 SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV 103
""",
            )
            record = next(records)
            self.assertIsInstance(record.query, SeqRecord)
            self.assertEqual(record.query.id, "7")
            self.assertEqual(
                record.query.description,
                "gi|5817701|gb|AF142731.1|AF142731 Wisteria frutescens maturase-like protein (matK) gene, complete cds; chloroplast gene for chloroplast product",
            )
            self.assertEqual(repr(record.query.seq), "Seq(None, length=2551)")

            self.assertEqual(len(record.stat), 7)
            self.assertEqual(record.stat["db-num"], 8994603)
            self.assertEqual(record.stat["db-len"], -1216159329)
            self.assertEqual(record.stat["hsp-len"], 0)
            self.assertAlmostEqual(record.stat["eff-space"], 1251086325060.0)
            self.assertAlmostEqual(record.stat["kappa"], 0.041)
            self.assertAlmostEqual(record.stat["lambda"], 0.267)
            self.assertAlmostEqual(record.stat["entropy"], 0.14)
            self.assertEqual(len(record), 10)
            hit = record[0]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|27805603|sp|Q9TKP6.1|MATK_WISFR")
            self.assertEqual(hit.target.name, "Q9TKP6")
            self.assertEqual(
                hit.target.description,
                "RecName: Full=Maturase K; AltName: Full=Intron maturase >gi|5817759|gb|AAD52902.1|AF142731_1 maturase-like protein [Wisteria frutescens]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=506)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 2451.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 948.732392853477)
            self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
            self.assertEqual(hsp.annotations["identity"], 506)
            self.assertEqual(hsp.annotations["positive"], 506)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 506],
                              [  0, 506]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 506))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.query.id, "7")
            self.assertEqual(
                hsp.query.description,
                "gi|5817701|gb|AF142731.1|AF142731 Wisteria frutescens maturase-like protein (matK) gene, complete cds; chloroplast gene for chloroplast product",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(506))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "7:727..2244")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.target.id, "gi|27805603|sp|Q9TKP6.1|MATK_WISFR")
            self.assertEqual(hsp.target.name, "Q9TKP6")
            self.assertEqual(
                hsp.target.description,
                "RecName: Full=Maturase K; AltName: Full=Intron maturase >gi|5817759|gb|AAD52902.1|AF142731_1 maturase-like protein [Wisteria frutescens]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRLITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIVKSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASFFHLLRFFLYHFSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSVFFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHYFIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIKKLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSSKKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPRTSSTLQRLHRNRIWYLDILFSNDLVNHE",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|278056         0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7                 0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL

gi|278056        60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7                60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV

gi|278056       120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASFFHLLRFF
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||........
7               120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASXXXXXXXX

gi|278056       180 LYHFSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV
                180 ....||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               180 XXXXSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV

gi|278056       240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY

gi|278056       300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK

gi|278056       360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS

gi|278056       420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPRTS
                420 ||||||||||||||||||||||||||||||||||||....................||||
7               420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGXXXXXXXXXXXXXXXXXXXXPRTS

gi|278056       480 STLQRLHRNRIWYLDILFSNDLVNHE 506
                480 |||||||||||||||||||||||||| 506
7               480 STLQRLHRNRIWYLDILFSNDLVNHE 506
""",
            )
            hit = record[1]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|171909144|gb|ACB58148.1|")
            self.assertEqual(hit.target.name, "ACB58148")
            self.assertEqual(hit.target.description, "maturase K [Wisteria frutescens]")
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=506)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 2445.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 946.421195397973)
            self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
            self.assertEqual(hsp.annotations["identity"], 505)
            self.assertEqual(hsp.annotations["positive"], 505)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 506],
                              [  0, 506]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 506))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.query.id, "7")
            self.assertEqual(
                hsp.query.description,
                "gi|5817701|gb|AF142731.1|AF142731 Wisteria frutescens maturase-like protein (matK) gene, complete cds; chloroplast gene for chloroplast product",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(506))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "7:727..2244")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKYSL...NHE')",
            )
            self.assertEqual(hsp.target.id, "gi|171909144|gb|ACB58148.1|")
            self.assertEqual(hsp.target.name, "ACB58148")
            self.assertEqual(hsp.target.description, "maturase K [Wisteria frutescens]")
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNK SLLIVKRLITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIVKSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASFFHLLRFFLYHFSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSVFFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHYFIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIKKLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSSKKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPRTSSTLQRLHRNRIWYLDILFSNDLVNHE",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|171909         0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKYSLLIVKRL
                  0 |||||||||||||||||||||||||||||||||||||||||||||||||||.||||||||
7                 0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL

gi|171909        60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7                60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV

gi|171909       120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASFFHLLRFF
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||........
7               120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASXXXXXXXX

gi|171909       180 LYHFSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV
                180 ....||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               180 XXXXSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV

gi|171909       240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY

gi|171909       300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK

gi|171909       360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS

gi|171909       420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPRTS
                420 ||||||||||||||||||||||||||||||||||||....................||||
7               420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGXXXXXXXXXXXXXXXXXXXXPRTS

gi|171909       480 STLQRLHRNRIWYLDILFSNDLVNHE 506
                480 |||||||||||||||||||||||||| 506
7               480 STLQRLHRNRIWYLDILFSNDLVNHE 506
""",
            )
            hit = record[2]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|171909146|gb|ACB58149.1|")
            self.assertEqual(hit.target.name, "ACB58149")
            self.assertEqual(
                hit.target.description,
                "maturase K [Wisteria frutescens] >gi|171909148|gb|ACB58150.1| maturase K [Wisteria frutescens var. macrostachya]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=506)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 2443.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 945.650796246138)
            self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
            self.assertEqual(hsp.annotations["identity"], 505)
            self.assertEqual(hsp.annotations["positive"], 505)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 506],
                              [  0, 506]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 506))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.query.id, "7")
            self.assertEqual(
                hsp.query.description,
                "gi|5817701|gb|AF142731.1|AF142731 Wisteria frutescens maturase-like protein (matK) gene, complete cds; chloroplast gene for chloroplast product",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(506))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "7:727..2244")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.target.id, "gi|171909146|gb|ACB58149.1|")
            self.assertEqual(hsp.target.name, "ACB58149")
            self.assertEqual(
                hsp.target.description,
                "maturase K [Wisteria frutescens] >gi|171909148|gb|ACB58150.1| maturase K [Wisteria frutescens var. macrostachya]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRLITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIVKSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASFFHLLRFFLYHFSNRNSLITP KSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSVFFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHYFIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIKKLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSSKKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPRTSSTLQRLHRNRIWYLDILFSNDLVNHE",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|171909         0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7                 0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL

gi|171909        60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7                60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV

gi|171909       120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASFFHLLRFF
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||........
7               120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASXXXXXXXX

gi|171909       180 LYHFSNRNSLITPIKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV
                180 ....|||||||||.||||||||||||||||||||||||||||||||||||||||||||||
7               180 XXXXSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV

gi|171909       240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY

gi|171909       300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK

gi|171909       360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS
                360 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS

gi|171909       420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPRTS
                420 ||||||||||||||||||||||||||||||||||||....................||||
7               420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGXXXXXXXXXXXXXXXXXXXXPRTS

gi|171909       480 STLQRLHRNRIWYLDILFSNDLVNHE 506
                480 |||||||||||||||||||||||||| 506
7               480 STLQRLHRNRIWYLDILFSNDLVNHE 506
""",
            )
            hit = record[3]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|171909132|gb|ACB58142.1|")
            self.assertEqual(hit.target.name, "ACB58142")
            self.assertEqual(hit.target.description, "maturase K [Callerya megasperma]")
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=506)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 2439.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 944.109997942469)
            self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
            self.assertEqual(hsp.annotations["identity"], 501)
            self.assertEqual(hsp.annotations["positive"], 504)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 506],
                              [  0, 506]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 506))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.query.id, "7")
            self.assertEqual(
                hsp.query.description,
                "gi|5817701|gb|AF142731.1|AF142731 Wisteria frutescens maturase-like protein (matK) gene, complete cds; chloroplast gene for chloroplast product",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(506))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "7:727..2244")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.target.id, "gi|171909132|gb|ACB58142.1|")
            self.assertEqual(hsp.target.name, "ACB58142")
            self.assertEqual(hsp.target.description, "maturase K [Callerya megasperma]")
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRLITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIVKSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASFFHLLRFFLY++ NRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSVFFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHYFIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIKKLDIIVPIIPLIRSLAKAKFCNVLGHP+SKSVWADSSDFDIIDRFLRICRNLSHYYNGSSKKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPR SSTLQRLHRNRIWYLDILFSNDLVNHE",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|171909         0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7                 0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL

gi|171909        60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7                60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV

gi|171909       120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASFFHLLRFF
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||........
7               120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASXXXXXXXX

gi|171909       180 LYNYCNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV
                180 .....|||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               180 XXXXSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV

gi|171909       240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY

gi|171909       300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK

gi|171909       360 KLDIIVPIIPLIRSLAKAKFCNVLGHPISKSVWADSSDFDIIDRFLRICRNLSHYYNGSS
                360 |||||||||||||||||||||||||||.||||||||||||||||||||||||||||||||
7               360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS

gi|171909       420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPRAS
                420 ||||||||||||||||||||||||||||||||||||....................||.|
7               420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGXXXXXXXXXXXXXXXXXXXXPRTS

gi|171909       480 STLQRLHRNRIWYLDILFSNDLVNHE 506
                480 |||||||||||||||||||||||||| 506
7               480 STLQRLHRNRIWYLDILFSNDLVNHE 506
""",
            )
            hit = record[4]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|5817760|gb|AAD52903.1|AF142732_1")
            self.assertEqual(hit.target.name, "AAD52903")
            self.assertEqual(
                hit.target.description,
                "maturase-like protein [Wisteria sinensis] >gi|171909136|gb|ACB58144.1| maturase K [Wisteria brachybotrys] >gi|171909138|gb|ACB58145.1| maturase K [Wisteria floribunda] >gi|171909140|gb|ACB58146.1| maturase K [Wisteria floribunda] >gi|171909142|gb|ACB58147.1| maturase K [Wisteria floribunda] >gi|171909150|gb|ACB58151.1| maturase K [Wisteria sinensis] >gi|171909152|gb|ACB58152.1| maturase K [Wisteria sinensis] >gi|171909154|gb|ACB58153.1| maturase K [Wisteria sinensis] >gi|171909156|gb|ACB58154.1| maturase K [Wisteria villosa] >gi|171909158|gb|ACB58155.1| maturase K [Wisteria villosa] >gi|171909160|gb|ACB58156.1| maturase K [Wisteria villosa]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=506)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 2418.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 936.020806848204)
            self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
            self.assertEqual(hsp.annotations["identity"], 498)
            self.assertEqual(hsp.annotations["positive"], 500)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 506],
                              [  0, 506]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 506))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.query.id, "7")
            self.assertEqual(
                hsp.query.description,
                "gi|5817701|gb|AF142731.1|AF142731 Wisteria frutescens maturase-like protein (matK) gene, complete cds; chloroplast gene for chloroplast product",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(506))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "7:727..2244")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDKKSSL...NHE')",
            )
            self.assertEqual(hsp.target.id, "gi|5817760|gb|AAD52903.1|AF142732_1")
            self.assertEqual(hsp.target.name, "AAD52903")
            self.assertEqual(
                hsp.target.description,
                "maturase-like protein [Wisteria sinensis] >gi|171909136|gb|ACB58144.1| maturase K [Wisteria brachybotrys] >gi|171909138|gb|ACB58145.1| maturase K [Wisteria floribunda] >gi|171909140|gb|ACB58146.1| maturase K [Wisteria floribunda] >gi|171909142|gb|ACB58147.1| maturase K [Wisteria floribunda] >gi|171909150|gb|ACB58151.1| maturase K [Wisteria sinensis] >gi|171909152|gb|ACB58152.1| maturase K [Wisteria sinensis] >gi|171909154|gb|ACB58153.1| maturase K [Wisteria sinensis] >gi|171909156|gb|ACB58154.1| maturase K [Wisteria villosa] >gi|171909158|gb|ACB58155.1| maturase K [Wisteria villosa] >gi|171909160|gb|ACB58156.1| maturase K [Wisteria villosa]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYD KSSLLIVKRLITRMYQQNHLIISANDSNKNPFLGYN NFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIVKSYHNLRSIHSIFPFLEDK TY NYVSDIRIPYPIHLEILVQILRYWVKDASFFHLLRFFLY+F NRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSVFFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHYFIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIKKLDIIVPIIPLIRSLAKAKFCNVLGHP+SKSVWADSSDFDIIDRFLRICRNLSHYYNGSSKKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPR SSTLQRLHRNRIWYLDILFSNDLVNHE",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|581776         0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDKKSSLLIVKRL
                  0 |||||||||||||||||||||||||||||||||||||||||||||||||.||||||||||
7                 0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL

gi|581776        60 ITRMYQQNHLIISANDSNKNPFLGYNNNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV
                 60 ||||||||||||||||||||||||||.|||||||||||||||||||||||||||||||||
7                60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV

gi|581776       120 KSYHNLRSIHSIFPFLEDKLTYFNYVSDIRIPYPIHLEILVQILRYWVKDASFFHLLRFF
                120 |||||||||||||||||||.||.|||||||||||||||||||||||||||||........
7               120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASXXXXXXXX

gi|581776       180 LYNFCNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV
                180 .....|||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               180 XXXXSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV

gi|581776       240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY

gi|581776       300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK

gi|581776       360 KLDIIVPIIPLIRSLAKAKFCNVLGHPISKSVWADSSDFDIIDRFLRICRNLSHYYNGSS
                360 |||||||||||||||||||||||||||.||||||||||||||||||||||||||||||||
7               360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS

gi|581776       420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPRAS
                420 ||||||||||||||||||||||||||||||||||||....................||.|
7               420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGXXXXXXXXXXXXXXXXXXXXPRTS

gi|581776       480 STLQRLHRNRIWYLDILFSNDLVNHE 506
                480 |||||||||||||||||||||||||| 506
7               480 STLQRLHRNRIWYLDILFSNDLVNHE 506
""",
            )
            hit = record[5]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|171909134|gb|ACB58143.1|")
            self.assertEqual(hit.target.name, "ACB58143")
            self.assertEqual(
                hit.target.description, "maturase K [Wisteria brachybotrys]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=506)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 2398.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 928.316815329857)
            self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
            self.assertEqual(hsp.annotations["identity"], 496)
            self.assertEqual(hsp.annotations["positive"], 498)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 506],
                              [  0, 506]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 506))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.query.id, "7")
            self.assertEqual(
                hsp.query.description,
                "gi|5817701|gb|AF142731.1|AF142731 Wisteria frutescens maturase-like protein (matK) gene, complete cds; chloroplast gene for chloroplast product",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(506))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "7:727..2244")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDKKSSL...NHE')",
            )
            self.assertEqual(hsp.target.id, "gi|171909134|gb|ACB58143.1|")
            self.assertEqual(hsp.target.name, "ACB58143")
            self.assertEqual(
                hsp.target.description, "maturase K [Wisteria brachybotrys]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYD KSSLLIVKRLITRMYQQNHLIISANDSNKNPFLGYN  FYSQIISDGFAVVVEIPFFLQLSSSLEEAEIVKSYHNLRSIHSIFPFLEDK TY NYVSDIRIPYPIHLEILVQILRY VKDASFFHLLRFFLY+F NRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSVFFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHYFIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIKKLDIIVPIIPLIRSLAKAKFCNVLGHP+SKSVWADSSDFDIIDRFLRICRNLSHYYNGSSKKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPR SSTLQRLHRNRIWYLDILFSNDLVNHE",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|171909         0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDKKSSLLIVKRL
                  0 |||||||||||||||||||||||||||||||||||||||||||||||||.||||||||||
7                 0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL

gi|171909        60 ITRMYQQNHLIISANDSNKNPFLGYNNKFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV
                 60 ||||||||||||||||||||||||||..||||||||||||||||||||||||||||||||
7                60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV

gi|171909       120 KSYHNLRSIHSIFPFLEDKLTYFNYVSDIRIPYPIHLEILVQILRYRVKDASFFHLLRFF
                120 |||||||||||||||||||.||.|||||||||||||||||||||||.|||||........
7               120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASXXXXXXXX

gi|171909       180 LYNFCNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV
                180 .....|||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               180 XXXXSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV

gi|171909       240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY
                240 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY

gi|171909       300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK

gi|171909       360 KLDIIVPIIPLIRSLAKAKFCNVLGHPISKSVWADSSDFDIIDRFLRICRNLSHYYNGSS
                360 |||||||||||||||||||||||||||.||||||||||||||||||||||||||||||||
7               360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS

gi|171909       420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPRAS
                420 ||||||||||||||||||||||||||||||||||||....................||.|
7               420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGXXXXXXXXXXXXXXXXXXXXPRTS

gi|171909       480 STLQRLHRNRIWYLDILFSNDLVNHE 506
                480 |||||||||||||||||||||||||| 506
7               480 STLQRLHRNRIWYLDILFSNDLVNHE 506
""",
            )
            hit = record[6]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|5817761|gb|AAD52904.1|AF142733_1")
            self.assertEqual(hit.target.name, "AAD52904")
            self.assertEqual(
                hit.target.description, "maturase-like protein [Callerya reticulata]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=506)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 2390.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 925.235218722518)
            self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
            self.assertEqual(hsp.annotations["identity"], 493)
            self.assertEqual(hsp.annotations["positive"], 498)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 506],
                              [  0, 506]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 506))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.query.id, "7")
            self.assertEqual(
                hsp.query.description,
                "gi|5817701|gb|AF142731.1|AF142731 Wisteria frutescens maturase-like protein (matK) gene, complete cds; chloroplast gene for chloroplast product",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(506))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "7:727..2244")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('MKEYQAYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.target.id, "gi|5817761|gb|AAD52904.1|AF142733_1")
            self.assertEqual(hsp.target.name, "AAD52904")
            self.assertEqual(
                hsp.target.description, "maturase-like protein [Callerya reticulata]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MKEYQ YLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRLITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQL+SSLEEAEIVKSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASFFHLLRFFLY+F NRNSLITPKKSISTFSK NPRLFLFLYNFYV EYESIF FLRNQSSHLR KSFSVFFERIFFYAKREHL+KVFPKDFSSTLTFFKDPFIHYVRYQ KSILASKNAPLLMNKWKHYFIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIKKLDIIVPIIPLIRSLAKAKFCNVLGHP+SKSVWADSSDFDIIDRFLRICRNLSHYYNGSSKKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPR SSTL+RLHRNRIWYLDILFSNDLVNHE",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|581776         0 MKEYQAYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL
                  0 |||||.||||||||||||||||||||||||||||||||||||||||||||||||||||||
7                 0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL

gi|581776        60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLNSSLEEAEIV
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||.|||||||||
7                60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV

gi|581776       120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASFFHLLRFF
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||........
7               120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASXXXXXXXX

gi|581776       180 LYNFCNRNSLITPKKSISTFSKCNPRLFLFLYNFYVWEYESIFLFLRNQSSHLRFKSFSV
                180 .....|||||||||||||||||.|||||||||||||.||||||.||||||||||.|||||
7               180 XXXXSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV

gi|581776       240 FFERIFFYAKREHLLKVFPKDFSSTLTFFKDPFIHYVRYQEKSILASKNAPLLMNKWKHY
                240 ||||||||||||||.|||||||||||||||||||||||||.|||||||||||||||||||
7               240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY

gi|581776       300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK

gi|581776       360 KLDIIVPIIPLIRSLAKAKFCNVLGHPISKSVWADSSDFDIIDRFLRICRNLSHYYNGSS
                360 |||||||||||||||||||||||||||.||||||||||||||||||||||||||||||||
7               360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS

gi|581776       420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGSEELLEEFFTEEEEILSLIFPRAS
                420 ||||||||||||||||||||||||||||||||||||....................||.|
7               420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGXXXXXXXXXXXXXXXXXXXXPRTS

gi|581776       480 STLKRLHRNRIWYLDILFSNDLVNHE 506
                480 |||.|||||||||||||||||||||| 506
7               480 STLQRLHRNRIWYLDILFSNDLVNHE 506
""",
            )
            hit = record[7]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|5817762|gb|AAD52905.1|AF142734_1")
            self.assertEqual(hit.target.name, "AAD52905")
            self.assertEqual(
                hit.target.description, "maturase-like protein [Callerya atropurpurea]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=506)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 2301.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 890.952456465874)
            self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
            self.assertEqual(hsp.annotations["identity"], 472)
            self.assertEqual(hsp.annotations["positive"], 488)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 506],
                              [  0, 506]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 506))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.query.id, "7")
            self.assertEqual(
                hsp.query.description,
                "gi|5817701|gb|AF142731.1|AF142731 Wisteria frutescens maturase-like protein (matK) gene, complete cds; chloroplast gene for chloroplast product",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(506))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "7:727..2244")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYTYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.target.id, "gi|5817762|gb|AAD52905.1|AF142734_1")
            self.assertEqual(hsp.target.name, "AAD52905")
            self.assertEqual(
                hsp.target.description, "maturase-like protein [Callerya atropurpurea]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MKEYQVYLERDRSRQQDFLYPLIFREY YGLAYSHDFNRSIFVENVGYDNKSSLLIVKRLITRMYQQNHLIIS NDSNKNPFLGYNKNFYSQIIS+ FA+V EIPFF QLSSSLE+AEIVKSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDA FFHLLR FLY+F N N++ TPKKSISTFS+SNPR FLFLYNFYVCEYESIF FLRN+SSHLRLKSFSVFFERIFFYAKREHLV+VF KDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHYFIHLWQ FFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTF+IEI IKKLDIIVPIIPLIRSLAKAKFCNVLGHP+SK VWADSSDFDII+RFLRICRNLSHYYNGSSKKK+LYRIKYILRLSCIKTLACKHKSTVRAFLK+ GSEELLEEFFTEEEEILSLIFPR SSTLQ+LHRNRIWYLDILF+NDLVNHE",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|581776         0 MKEYQVYLERDRSRQQDFLYPLIFREYTYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL
                  0 |||||||||||||||||||||||||||.||||||||||||||||||||||||||||||||
7                 0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL

gi|581776        60 ITRMYQQNHLIISPNDSNKNPFLGYNKNFYSQIISEVFAIVAEIPFFRQLSSSLEQAEIV
                 60 |||||||||||||.|||||||||||||||||||||..||.|.|||||.|||||||.||||
7                60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV

gi|581776       120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDAPFFHLLRLF
                120 |||||||||||||||||||||||||||||||||||||||||||||||||||.........
7               120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASXXXXXXXX

gi|581776       180 LYNFCNWNTVFTPKKSISTFSRSNPRFFLFLYNFYVCEYESIFLFLRNKSSHLRLKSFSV
                180 .....|.|...||||||||||.||||.||||||||||||||||.||||.|||||||||||
7               180 XXXXSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV

gi|581776       240 FFERIFFYAKREHLVEVFAKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY
                240 |||||||||||||||.||.|||||||||||||||||||||||||||||||||||||||||
7               240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY

gi|581776       300 FIHLWQSFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFIIEIGIK
                300 ||||||.||||||||||||||||||||||||||||||||||||||||||||||.|||.||
7               300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK

gi|581776       360 KLDIIVPIIPLIRSLAKAKFCNVLGHPISKPVWADSSDFDIIERFLRICRNLSHYYNGSS
                360 |||||||||||||||||||||||||||.||.|||||||||||.|||||||||||||||||
7               360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS

gi|581776       420 KKKSLYRIKYILRLSCIKTLACKHKSTVRAFLKRLGSEELLEEFFTEEEEILSLIFPRAS
                420 |||.|||||||||||||||||||||||||||||..|....................||.|
7               420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGXXXXXXXXXXXXXXXXXXXXPRTS

gi|581776       480 STLQKLHRNRIWYLDILFTNDLVNHE 506
                480 ||||.|||||||||||||.||||||| 506
7               480 STLQRLHRNRIWYLDILFSNDLVNHE 506
""",
            )
            hit = record[8]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|152014012|gb|ABS20107.1|")
            self.assertEqual(hit.target.name, "ABS20107")
            self.assertEqual(
                hit.target.description, "maturase-like protein [Astragalus uliginosus]"
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=506)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 2293.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 887.870859858535)
            self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
            self.assertEqual(hsp.annotations["identity"], 470)
            self.assertEqual(hsp.annotations["positive"], 487)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 506],
                              [  0, 506]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 506))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.query.id, "7")
            self.assertEqual(
                hsp.query.description,
                "gi|5817701|gb|AF142731.1|AF142731 Wisteria frutescens maturase-like protein (matK) gene, complete cds; chloroplast gene for chloroplast product",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(506))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "7:727..2244")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('MKEYQVFLERDRSRQQDFLYPLIFREYVYGLAYSHDFNRSTFVENVGYDNKYSL...NHE')",
            )
            self.assertEqual(hsp.target.id, "gi|152014012|gb|ABS20107.1|")
            self.assertEqual(hsp.target.name, "ABS20107")
            self.assertEqual(
                hsp.target.description, "maturase-like protein [Astragalus uliginosus]"
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MKEYQV+LERDRSRQQDFLYPLIFREY+YGLAYSHDFNRS FVENVGYDNK SLLIVKRLITRMYQQNHLIISANDS KNPFLGYNKNFYSQIIS+GFA+VVEIPFFLQ SSSL+EAEIVKSY NLRSIHSIFPFLEDKF YLNYVSDIRIPYPIHLEILVQILRYWVKDA FFHLLR FLY+F NRNS +TPKKSISTFSKSNPRLFLFLYNFYVCEYESIF FLR +SSHLRLKSFSVFFERIFFYAKREHLV+VF KDFSSTLTFFKDP IHYVRYQGKSILASKNAPLLMNKWKHYFIHLW+CFFDVWSQPGTIHI QLSEHSF+ LGYFSNVRLNRSVVRSQMLQNTFLIEIV KKLDIIVPIIP+IRSLAKAKFCNVLGHP+SK+VWADSSDFDIIDRFLRICRNLSHYYNGSSKKK+LYRIKYILRLSCIKTLACKHKSTVRAFLK+SGSEELLEEFFTEEEEILSLIFPR SSTLQ+LH NRIWYLDILFSNDLVNHE",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|152014         0 MKEYQVFLERDRSRQQDFLYPLIFREYVYGLAYSHDFNRSTFVENVGYDNKYSLLIVKRL
                  0 ||||||.||||||||||||||||||||.||||||||||||.||||||||||.||||||||
7                 0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL

gi|152014        60 ITRMYQQNHLIISANDSKKNPFLGYNKNFYSQIISEGFAIVVEIPFFLQFSSSLKEAEIV
                 60 |||||||||||||||||.|||||||||||||||||.|||.|||||||||.||||.|||||
7                60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV

gi|152014       120 KSYKNLRSIHSIFPFLEDKFPYLNYVSDIRIPYPIHLEILVQILRYWVKDAPFFHLLRLF
                120 |||.||||||||||||||||.||||||||||||||||||||||||||||||.........
7               120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASXXXXXXXX

gi|152014       180 LYNFCNRNSFLTPKKSISTFSKSNPRLFLFLYNFYVCEYESIFLFLRKKSSHLRLKSFSV
                180 .....||||..||||||||||||||||||||||||||||||||.|||..|||||||||||
7               180 XXXXSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV

gi|152014       240 FFERIFFYAKREHLVEVFAKDFSSTLTFFKDPLIHYVRYQGKSILASKNAPLLMNKWKHY
                240 |||||||||||||||.||.|||||||||||||.|||||||||||||||||||||||||||
7               240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY

gi|152014       300 FIHLWECFFDVWSQPGTIHIKQLSEHSFYLLGYFSNVRLNRSVVRSQMLQNTFLIEIVSK
                300 |||||.||||||||||||||.|||||||..||||||||||||||||||||||||||||.|
7               300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK

gi|152014       360 KLDIIVPIIPIIRSLAKAKFCNVLGHPISKAVWADSSDFDIIDRFLRICRNLSHYYNGSS
                360 ||||||||||.||||||||||||||||.||.|||||||||||||||||||||||||||||
7               360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS

gi|152014       420 KKKSLYRIKYILRLSCIKTLACKHKSTVRAFLKRSGSEELLEEFFTEEEEILSLIFPRAS
                420 |||.|||||||||||||||||||||||||||||.||....................||.|
7               420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGXXXXXXXXXXXXXXXXXXXXPRTS

gi|152014       480 STLQKLHGNRIWYLDILFSNDLVNHE 506
                480 ||||.||.|||||||||||||||||| 506
7               480 STLQRLHRNRIWYLDILFSNDLVNHE 506
""",
            )
            hit = record[9]
            self.assertIsInstance(hit.target, SeqRecord)
            self.assertEqual(hit.target.id, "gi|146197442|dbj|BAF57483.1|")
            self.assertEqual(hit.target.name, "BAF57483")
            self.assertEqual(
                hit.target.description,
                "maturase [Glycyrrhiza uralensis] >gi|146197444|dbj|BAF57484.1| maturase [Glycyrrhiza glabra] >gi|152014018|gb|ABS20110.1| maturase-like protein [Glycyrrhiza pallidiflora]",
            )
            self.assertEqual(repr(hit.target.seq), "Seq(None, length=506)")
            self.assertEqual(len(hit), 1)
            hsp = hit[0]
            self.assertAlmostEqual(hsp.score, 2292.0)
            self.assertAlmostEqual(hsp.annotations["bit score"], 887.485660282618)
            self.assertAlmostEqual(hsp.annotations["evalue"], 0.0)
            self.assertEqual(hsp.annotations["identity"], 471)
            self.assertEqual(hsp.annotations["positive"], 489)
            self.assertEqual(hsp.annotations["gaps"], 0)
            self.assertTrue(
                np.array_equal(
                    hsp.coordinates,
                    # fmt: off
                    np.array([[  0, 506],
                              [  0, 506]])
                    # fmt: on
                )
            )
            self.assertEqual(hsp.shape, (2, 506))
            self.assertEqual(
                repr(hsp.query.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSL...NHE')",
            )
            self.assertEqual(hsp.query.id, "7")
            self.assertEqual(
                hsp.query.description,
                "gi|5817701|gb|AF142731.1|AF142731 Wisteria frutescens maturase-like protein (matK) gene, complete cds; chloroplast gene for chloroplast product",
            )
            self.assertEqual(len(hsp.query.features), 1)
            feature = hsp.query.features[0]
            self.assertEqual(
                repr(feature.location),
                "SimpleLocation(ExactPosition(0), ExactPosition(506))",
            )
            self.assertEqual(feature.type, "CDS")
            self.assertEqual(len(feature.qualifiers), 1)
            self.assertEqual(feature.qualifiers["coded_by"], "7:727..2244")
            self.assertEqual(
                repr(hsp.target.seq),
                "Seq('MKEYQVYLERDRSRQQDFLYPLIFREYIYGIAYSHNLNRSIFVENVGYDNKFSL...NNE')",
            )
            self.assertEqual(hsp.target.id, "gi|146197442|dbj|BAF57483.1|")
            self.assertEqual(hsp.target.name, "BAF57483")
            self.assertEqual(
                hsp.target.description,
                "maturase [Glycyrrhiza uralensis] >gi|146197444|dbj|BAF57484.1| maturase [Glycyrrhiza glabra] >gi|152014018|gb|ABS20110.1| maturase-like protein [Glycyrrhiza pallidiflora]",
            )
            self.assertEqual(len(hsp.target.features), 0)
            self.assertEqual(
                hsp.annotations["midline"],
                "MKEYQVYLERDRSRQQDFLYPLIFREYIYG+AYSH+ NRSIFVENVGYDNK SLLIVKRLITRMYQQNHLIISANDSNKNPF GYNKN YSQ+ISDGFAVVVEIPFFLQ SSSLEEAEIVKSY+NLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDA FFHLLR FLY+F N NSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIF FLRN+SSHLRLKSFSVFFERIFFYAKREHLV VF KD+S TLT FKDPFIHYVRYQGK+ILAS+NAPLLMNKWKHYFIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIKKLDIIVPIIPLIRSLAKAKFCNVLGHP+SK VWADSSDF+II+RFLRICRNLSHYY+GSSKKK+LYRIKYILRLSCIKTLACKHKSTVRAFLK+ GSEELLEEFFTEEEEILSLIFP+ SSTLQ+LHRNRIWYLDILFSNDLVN+E",
            )
            self.assertEqual(
                str(hsp),
                """\
gi|146197         0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGIAYSHNLNRSIFVENVGYDNKFSLLIVKRL
                  0 ||||||||||||||||||||||||||||||.||||..||||||||||||||.||||||||
7                 0 MKEYQVYLERDRSRQQDFLYPLIFREYIYGLAYSHDFNRSIFVENVGYDNKSSLLIVKRL

gi|146197        60 ITRMYQQNHLIISANDSNKNPFSGYNKNIYSQLISDGFAVVVEIPFFLQFSSSLEEAEIV
                 60 ||||||||||||||||||||||.|||||.|||.||||||||||||||||.||||||||||
7                60 ITRMYQQNHLIISANDSNKNPFLGYNKNFYSQIISDGFAVVVEIPFFLQLSSSLEEAEIV

gi|146197       120 KSYNNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDAPFFHLLRLF
                120 |||.|||||||||||||||||||||||||||||||||||||||||||||||.........
7               120 KSYHNLRSIHSIFPFLEDKFTYLNYVSDIRIPYPIHLEILVQILRYWVKDASXXXXXXXX

gi|146197       180 LYNFCNWNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFLFLRNKSSHLRLKSFSV
                180 .....|.||||||||||||||||||||||||||||||||||||.||||.|||||||||||
7               180 XXXXSNRNSLITPKKSISTFSKSNPRLFLFLYNFYVCEYESIFRFLRNQSSHLRLKSFSV

gi|146197       240 FFERIFFYAKREHLVDVFAKDYSPTLTLFKDPFIHYVRYQGKAILASRNAPLLMNKWKHY
                240 |||||||||||||||.||.||.|.|||.||||||||||||||.||||.||||||||||||
7               240 FFERIFFYAKREHLVKVFPKDFSSTLTFFKDPFIHYVRYQGKSILASKNAPLLMNKWKHY

gi|146197       300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK
                300 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
7               300 FIHLWQCFFDVWSQPGTIHINQLSEHSFHFLGYFSNVRLNRSVVRSQMLQNTFLIEIVIK

gi|146197       360 KLDIIVPIIPLIRSLAKAKFCNVLGHPISKPVWADSSDFEIIERFLRICRNLSHYYSGSS
                360 |||||||||||||||||||||||||||.||.||||||||.||.|||||||||||||.|||
7               360 KLDIIVPIIPLIRSLAKAKFCNVLGHPLSKSVWADSSDFDIIDRFLRICRNLSHYYNGSS

gi|146197       420 KKKSLYRIKYILRLSCIKTLACKHKSTVRAFLKRLGSEELLEEFFTEEEEILSLIFPKAS
                420 |||.|||||||||||||||||||||||||||||..|....................|..|
7               420 KKKNLYRIKYILRLSCIKTLACKHKSTVRAFLKKSGXXXXXXXXXXXXXXXXXXXXPRTS

gi|146197       480 STLQKLHRNRIWYLDILFSNDLVNNE 506
                480 ||||.|||||||||||||||||||.| 506
7               480 STLQRLHRNRIWYLDILFSNDLVNHE 506
""",
            )

    def test_xml_2900_blastx_001(self):
        """Parsing BLASTX 2.9.0+ (xml_2900_blastx_001.xml)."""
        filename = "xml_2900_blastx_001.xml"
        datafile = os.path.join("Blast", filename)
        with open(datafile, "rb") as handle:
            records = Blast.parse(handle)
            self.check_xml_2900_blastx_001_records(records)
        with Blast.parse(datafile) as records:
            self.check_xml_2900_blastx_001_records(records)
        with open(datafile, "rb") as handle:
            record = Blast.read(handle)
        self.check_xml_2900_blastx_001_record(record)
        record = Blast.read(datafile)
        self.check_xml_2900_blastx_001_record(record)

    def check_xml_2900_blastx_001_records(self, records):
        self.assertEqual(records.program, "blastx")
        self.assertEqual(records.version, "BLASTX 2.9.0+")
        self.assertEqual(
            records.reference,
            'Stephen F. Altschul, Thomas L. Madden, Alejandro A. Sch&auml;ffer, Jinghui Zhang, Zheng Zhang, Webb Miller, and David J. Lipman (1997), "Gapped BLAST and PSI-BLAST: a new generation of protein database search programs", Nucleic Acids Res. 25:3389-3402.',
        )
        self.assertEqual(records.db, "nr")
        self.assertIsInstance(records.query, SeqRecord)
        self.assertEqual(records.query.id, "AI021773.1")
        self.assertEqual(
            records.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(repr(records.query.seq), "Seq(None, length=365)")
        self.assertEqual(len(records.param), 5)
        self.assertEqual(records.param["matrix"], "BLOSUM62")
        self.assertAlmostEqual(records.param["expect"], 10.0)
        self.assertEqual(records.param["gap-open"], 11)
        self.assertEqual(records.param["gap-extend"], 1)
        self.assertEqual(records.param["filter"], "F")
        record = next(records)
        self.assertRaises(StopIteration, next, records)
        self.check_xml_2900_blastx_001_record(record)

    def check_xml_2900_blastx_001_record(self, record):
        self.assertEqual(record.num, 1)

        self.assertIsInstance(record.query, SeqRecord)
        self.assertEqual(record.query.id, "AI021773.1")
        self.assertEqual(
            record.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(repr(record.query.seq), "Seq(None, length=365)")

        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 197469652)
        self.assertEqual(record.stat["db-len"], 71133367251)
        self.assertEqual(record.stat["hsp-len"], 0)
        self.assertAlmostEqual(record.stat["eff-space"], 0.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.041)
        self.assertAlmostEqual(record.stat["lambda"], 0.267)
        self.assertAlmostEqual(record.stat["entropy"], 0.14)
        self.assertEqual(len(record), 10)

        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1530504495|emb|VDM03167.1|")
        self.assertEqual(hit.target.name, "VDM03167")
        self.assertEqual(
            hit.target.description,
            "unnamed protein product, partial [Schistocephalus solidus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=132)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 408.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 161.77)
        self.assertAlmostEqual(hsp.annotations["evalue"], 8.11609e-49)
        self.assertEqual(hsp.annotations["identity"], 81)
        self.assertEqual(hsp.annotations["positive"], 83)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 108],
                          [  0, 108]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 108))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSY...LTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(108))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MADEEVQALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSY...LTE'}, length=132)",
        )
        self.assertEqual(hsp.target.id, "gi|1530504495|emb|VDM03167.1|")
        self.assertEqual(hsp.target.name, "VDM03167")
        self.assertEqual(
            hsp.target.description,
            "unnamed protein product, partial [Schistocephalus solidus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MADEEVQALVVDNGSGMCKAG       ++  P               G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|153050         0 MADEEVQALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSYVGDEAQ
                  0 |||||||||||||||||||||...........|...............|.||||||||||
AI021773.         0 MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSYVGDEAQ

gi|153050        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
                 60 |||||||||||||||||||||||||||||||||||||||||||||||| 108
AI021773.        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
""",
        )
        hit = record[1]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|510859078|gb|EPB74633.1|")
        self.assertEqual(hit.target.name, "EPB74633")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein ANCCEY_06263 [Ancylostoma ceylanicum]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=119)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 405.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 160.614)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.40046e-48)
        self.assertEqual(hsp.annotations["identity"], 81)
        self.assertEqual(hsp.annotations["positive"], 85)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 115],
                          [  0, 115]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 115))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSY...RKP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(115))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..364")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MCDDDVAALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSY...LKP'}, length=119)",
        )
        self.assertEqual(hsp.target.id, "gi|510859078|gb|EPB74633.1|")
        self.assertEqual(hsp.target.name, "EPB74633")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein ANCCEY_06263 [Ancylostoma ceylanicum]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "M D++V ALVVDNGSGMCKAG       ++  P               G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE H I KP",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|510859         0 MCDDDVAALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSYVGDEAQ
                  0 |.|..|.||||||||||||||...........|...............|.||||||||||
AI021773.         0 MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSYVGDEAQ

gi|510859        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTEAHSILKP 115
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||.|.|.|| 115
AI021773.        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTELHCIRKP 115
""",
        )
        hit = record[2]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|684409690|ref|XP_009175831.1|")
        self.assertEqual(hit.target.name, "XP_009175831")
        self.assertEqual(
            hit.target.description,
            "hypothetical protein T265_11027 [Opisthorchis viverrini] >gi|663044098|gb|KER20427.1| hypothetical protein T265_11027 [Opisthorchis viverrini]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=246)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 413.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 163.696)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.40404e-48)
        self.assertEqual(hsp.annotations["identity"], 81)
        self.assertEqual(hsp.annotations["positive"], 83)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 108],
                          [  0, 108]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 108))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSY...LTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(108))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MADEEVQALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSY...LTE'}, length=246)",
        )
        self.assertEqual(hsp.target.id, "gi|684409690|ref|XP_009175831.1|")
        self.assertEqual(hsp.target.name, "XP_009175831")
        self.assertEqual(
            hsp.target.description,
            "hypothetical protein T265_11027 [Opisthorchis viverrini] >gi|663044098|gb|KER20427.1| hypothetical protein T265_11027 [Opisthorchis viverrini]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MADEEVQALVVDNGSGMCKAG       ++  P               G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|684409         0 MADEEVQALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSYVGDEAQ
                  0 |||||||||||||||||||||...........|...............|.||||||||||
AI021773.         0 MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSYVGDEAQ

gi|684409        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
                 60 |||||||||||||||||||||||||||||||||||||||||||||||| 108
AI021773.        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
""",
        )
        hit = record[3]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|449710331|gb|EMD49430.1|")
        self.assertEqual(hit.target.name, "EMD49430")
        self.assertEqual(
            hit.target.description,
            "actin, putative, partial [Entamoeba histolytica KU27]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=124)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 401.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 159.073)
        self.assertAlmostEqual(hsp.annotations["evalue"], 9.0486e-48)
        self.assertEqual(hsp.annotations["identity"], 78)
        self.assertEqual(hsp.annotations["positive"], 81)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 108],
                          [  0, 108]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 108))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSY...LTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(108))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MGDEEVQALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHVSVMAGMGQKDAY...LTE'}, length=124)",
        )
        self.assertEqual(hsp.target.id, "gi|449710331|gb|EMD49430.1|")
        self.assertEqual(hsp.target.name, "EMD49430")
        self.assertEqual(
            hsp.target.description,
            "actin, putative, partial [Entamoeba histolytica KU27]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "M DEEVQALVVDNGSGMCKAG       ++  P               G KD+YVGDEAQSKRGILTLKYPIEHGIV NWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|449710         0 MGDEEVQALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHVSVMAGMGQKDAYVGDEAQ
                  0 |.|||||||||||||||||||...........|...............|.||.|||||||
AI021773.         0 MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSYVGDEAQ

gi|449710        60 SKRGILTLKYPIEHGIVNNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
                 60 |||||||||||||||||.|||||||||||||||||||||||||||||| 108
AI021773.        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
""",
        )
        hit = record[4]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|257215766|emb|CAX83035.1|")
        self.assertEqual(hit.target.name, "CAX83035")
        self.assertEqual(
            hit.target.description, "Actin-2, partial [Schistosoma japonicum]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=252)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 411.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 162.925)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.00219e-47)
        self.assertEqual(hsp.annotations["identity"], 81)
        self.assertEqual(hsp.annotations["positive"], 83)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 108],
                          [  0, 108]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 108))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSY...LTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(108))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MADEEVQALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSY...LTE'}, length=252)",
        )
        self.assertEqual(hsp.target.id, "gi|257215766|emb|CAX83035.1|")
        self.assertEqual(hsp.target.name, "CAX83035")
        self.assertEqual(
            hsp.target.description, "Actin-2, partial [Schistosoma japonicum]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MADEEVQALVVDNGSGMCKAG       ++  P               G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|257215         0 MADEEVQALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSYVGDEAQ
                  0 |||||||||||||||||||||...........|...............|.||||||||||
AI021773.         0 MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSYVGDEAQ

gi|257215        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
                 60 |||||||||||||||||||||||||||||||||||||||||||||||| 108
AI021773.        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
""",
        )
        hit = record[5]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1535393712|emb|VDP83060.1|")
        self.assertEqual(hit.target.name, "VDP83060")
        self.assertEqual(
            hit.target.description,
            "unnamed protein product, partial [Echinostoma caproni]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=209)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 407.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 161.384)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.16397e-47)
        self.assertEqual(hsp.annotations["identity"], 80)
        self.assertEqual(hsp.annotations["positive"], 83)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 108],
                          [  0, 108]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 108))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSY...LTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(108))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MADDEVQALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSY...LTE'}, length=209)",
        )
        self.assertEqual(hsp.target.id, "gi|1535393712|emb|VDP83060.1|")
        self.assertEqual(hsp.target.name, "VDP83060")
        self.assertEqual(
            hsp.target.description,
            "unnamed protein product, partial [Echinostoma caproni]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MAD+EVQALVVDNGSGMCKAG       ++  P               G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|153539         0 MADDEVQALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSYVGDEAQ
                  0 |||.|||||||||||||||||...........|...............|.||||||||||
AI021773.         0 MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSYVGDEAQ

gi|153539        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
                 60 |||||||||||||||||||||||||||||||||||||||||||||||| 108
AI021773.        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
""",
        )
        hit = record[6]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|312773|emb|CAA50205.1|")
        self.assertEqual(hit.target.name, "CAA50205")
        self.assertEqual(
            hit.target.description, "actin, partial [Entamoeba histolytica]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=137)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 401.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 159.073)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.25869e-47)
        self.assertEqual(hsp.annotations["identity"], 78)
        self.assertEqual(hsp.annotations["positive"], 81)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 108],
                          [  0, 108]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 108))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSY...LTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(108))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MGDEEVQALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHVSVMAGMGQKDAY...LTE'}, length=137)",
        )
        self.assertEqual(hsp.target.id, "gi|312773|emb|CAA50205.1|")
        self.assertEqual(hsp.target.name, "CAA50205")
        self.assertEqual(
            hsp.target.description, "actin, partial [Entamoeba histolytica]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "M DEEVQALVVDNGSGMCKAG       ++  P               G KD+YVGDEAQSKRGILTLKYPIEHGIV NWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|312773         0 MGDEEVQALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHVSVMAGMGQKDAYVGDEAQ
                  0 |.|||||||||||||||||||...........|...............|.||.|||||||
AI021773.         0 MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSYVGDEAQ

gi|312773        60 SKRGILTLKYPIEHGIVNNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
                 60 |||||||||||||||||.|||||||||||||||||||||||||||||| 108
AI021773.        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
""",
        )
        hit = record[7]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1530341495|emb|VDN44756.1|")
        self.assertEqual(hit.target.name, "VDN44756")
        self.assertEqual(
            hit.target.description,
            "unnamed protein product, partial [Dibothriocephalus latus]",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=145)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 400.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 158.688)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.78336e-47)
        self.assertEqual(hsp.annotations["identity"], 78)
        self.assertEqual(hsp.annotations["positive"], 82)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 108],
                          [  0, 108]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 108))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSY...LTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(108))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MGDEDVQALVIDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSY...LTE'}, length=145)",
        )
        self.assertEqual(hsp.target.id, "gi|1530341495|emb|VDN44756.1|")
        self.assertEqual(hsp.target.name, "VDN44756")
        self.assertEqual(
            hsp.target.description,
            "unnamed protein product, partial [Dibothriocephalus latus]",
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "M DE+VQALV+DNGSGMCKAG       ++  P               G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|153034         0 MGDEDVQALVIDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSYVGDEAQ
                  0 |.||.|||||.||||||||||...........|...............|.||||||||||
AI021773.         0 MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSYVGDEAQ

gi|153034        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
                 60 |||||||||||||||||||||||||||||||||||||||||||||||| 108
AI021773.        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
""",
        )
        hit = record[8]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1524877828|ref|XP_027046469.1|")
        self.assertEqual(hit.target.name, "XP_027046469")
        self.assertEqual(
            hit.target.description, "actin-1, partial [Pocillopora damicornis]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=122)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 398.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 157.918)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.93331e-47)
        self.assertEqual(hsp.annotations["identity"], 78)
        self.assertEqual(hsp.annotations["positive"], 82)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 108],
                          [  0, 108]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 108))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSY...LTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(108))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MADEEVAALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSY...LTE'}, length=122)",
        )
        self.assertEqual(hsp.target.id, "gi|1524877828|ref|XP_027046469.1|")
        self.assertEqual(hsp.target.name, "XP_027046469")
        self.assertEqual(
            hsp.target.description, "actin-1, partial [Pocillopora damicornis]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MADEEV ALVVDNGSGMCKAG       ++  P               G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELR+APEEHP+LLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|152487         0 MADEEVAALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSYVGDEAQ
                  0 ||||||.||||||||||||||...........|...............|.||||||||||
AI021773.         0 MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSYVGDEAQ

gi|152487        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRIAPEEHPILLTE 108
                 60 ||||||||||||||||||||||||||||||||||||.||||||.|||| 108
AI021773.        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
""",
        )
        hit = record[9]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1524877860|ref|XP_027046487.1|")
        self.assertEqual(hit.target.name, "XP_027046487")
        self.assertEqual(
            hit.target.description, "actin-1-like [Pocillopora damicornis]"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=134)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 399.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 158.303)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.36088e-47)
        self.assertEqual(hsp.annotations["identity"], 79)
        self.assertEqual(hsp.annotations["positive"], 82)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 108],
                          [  0, 108]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 108))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSY...LTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(108))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq({0: 'MADEDVAALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSY...LTE'}, length=134)",
        )
        self.assertEqual(hsp.target.id, "gi|1524877860|ref|XP_027046487.1|")
        self.assertEqual(hsp.target.name, "XP_027046487")
        self.assertEqual(
            hsp.target.description, "actin-1-like [Pocillopora damicornis]"
        )
        self.assertEqual(len(hsp.target.features), 0)
        self.assertEqual(
            hsp.annotations["midline"],
            "MADE+V ALVVDNGSGMCKAG       ++  P               G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|152487         0 MADEDVAALVVDNGSGMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKDSYVGDEAQ
                  0 ||||.|.||||||||||||||...........|...............|.||||||||||
AI021773.         0 MADEEVQALVVDNGSGMCKAGIRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSYVGDEAQ

gi|152487        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
                 60 |||||||||||||||||||||||||||||||||||||||||||||||| 108
AI021773.        60 SKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE 108
""",
        )


class TestTBlastn(unittest.TestCase):
    """Test the Blast XML parser for tblastn output."""

    def test_xml_2900_tblastn_001(self):
        """Parsing TBLASTN 2.9.0+ (xml_2900_tblastn_001.xml)."""
        filename = "xml_2900_tblastn_001.xml"
        datafile = os.path.join("Blast", filename)
        with open(datafile, "rb") as handle:
            records = Blast.parse(handle)
            self.check_xml_2900_tblastn_001_records(records)
        with Blast.parse(datafile) as records:
            self.check_xml_2900_tblastn_001_records(records)
        with open(datafile, "rb") as handle:
            record = Blast.read(handle)
        self.check_xml_2900_tblastn_001_record(record)
        record = Blast.read(datafile)
        self.check_xml_2900_tblastn_001_record(record)

    def check_xml_2900_tblastn_001_records(self, records):
        self.assertEqual(records.program, "tblastn")
        self.assertEqual(records.version, "TBLASTN 2.9.0+")
        self.assertEqual(
            records.reference,
            'Stephen F. Altschul, Thomas L. Madden, Alejandro A. Sch&auml;ffer, Jinghui Zhang, Zheng Zhang, Webb Miller, and David J. Lipman (1997), "Gapped BLAST and PSI-BLAST: a new generation of protein database search programs", Nucleic Acids Res. 25:3389-3402.',
        )
        self.assertEqual(records.db, "nr")
        self.assertIsInstance(records.query, SeqRecord)
        self.assertEqual(records.query.id, "CAJ99216.1")
        self.assertEqual(
            records.query.description, "tim [Helicobacter acinonychis str. Sheeba]"
        )
        self.assertEqual(repr(records.query.seq), "Seq(None, length=234)")
        self.assertEqual(len(records.param), 5)
        self.assertEqual(records.param["matrix"], "BLOSUM62")
        self.assertAlmostEqual(records.param["expect"], 10.0)
        self.assertEqual(records.param["gap-open"], 11)
        self.assertEqual(records.param["gap-extend"], 1)
        self.assertEqual(records.param["filter"], "F")
        record = next(records)
        self.assertRaises(StopIteration, next, records)
        self.check_xml_2900_tblastn_001_record(record)

    def check_xml_2900_tblastn_001_record(self, record):
        self.assertEqual(record.num, 1)

        self.assertIsInstance(record.query, SeqRecord)
        self.assertEqual(record.query.id, "CAJ99216.1")
        self.assertEqual(
            record.query.description, "tim [Helicobacter acinonychis str. Sheeba]"
        )
        self.assertEqual(repr(record.query.seq), "Seq(None, length=234)")

        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 51302476)
        self.assertEqual(record.stat["db-len"], 204305995260)
        self.assertEqual(record.stat["hsp-len"], 0)
        self.assertAlmostEqual(record.stat["eff-space"], 0.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.041)
        self.assertAlmostEqual(record.stat["lambda"], 0.267)
        self.assertAlmostEqual(record.stat["entropy"], 0.14)
        self.assertEqual(len(record), 10)

        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|109713861|emb|AM260522.1|")
        self.assertEqual(hit.target.name, "AM260522")
        self.assertEqual(
            hit.target.description,
            "Helicobacter acinonychis str. Sheeba complete genome, strain Sheeba",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1553927)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1228.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 477.633)
        self.assertAlmostEqual(hsp.annotations["evalue"], 8.53508e-152)
        self.assertEqual(hsp.annotations["identity"], 234)
        self.assertEqual(hsp.annotations["positive"], 234)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 234],
                          [  0, 234]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 234))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.query.id, "CAJ99216.1")
        self.assertEqual(
            hsp.query.description, "tim [Helicobacter acinonychis str. Sheeba]"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.target.id, "gi|109713861|emb|AM260522.1|")
        self.assertEqual(hsp.target.name, "AM260522")
        self.assertEqual(
            hsp.target.description,
            "Helicobacter acinonychis str. Sheeba complete genome, strain Sheeba",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1553927))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "gi|109713861|emb|AM260522.1|:325802..326503",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQNAYPKDCGAFTGEITSKHLEELKINTLLIGHSERRVLLKESPNFLKEKFDFFKDKKFKIVYCIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHGFLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|109713         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQN
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
CAJ99216.         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQN

gi|109713        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRVLLKESPNFLKEKFDFFKDKKFKIVY
                 60 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
CAJ99216.        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRVLLKESPNFLKEKFDFFKDKKFKIVY

gi|109713       120 CIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHG
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
CAJ99216.       120 CIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHG

gi|109713       180 FLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL 234
                180 |||||||||||||||||||||||||||||||||||||||||||||||||||||| 234
CAJ99216.       180 FLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL 234
""",
        )
        hit = record[1]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1336928286|emb|LT900055.1|")
        self.assertEqual(hit.target.name, "LT900055")
        self.assertEqual(
            hit.target.description,
            "Helicobacter acinonychis isolate 212_9 genome assembly, chromosome: I",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1550239)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1219.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 474.167)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.37046e-150)
        self.assertEqual(hsp.annotations["identity"], 232)
        self.assertEqual(hsp.annotations["positive"], 232)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 234],
                          [  0, 234]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 234))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.query.id, "CAJ99216.1")
        self.assertEqual(
            hsp.query.description, "tim [Helicobacter acinonychis str. Sheeba]"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.target.id, "gi|1336928286|emb|LT900055.1|")
        self.assertEqual(hsp.target.name, "LT900055")
        self.assertEqual(
            hsp.target.description,
            "Helicobacter acinonychis isolate 212_9 genome assembly, chromosome: I",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1550239))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "gi|1336928286|emb|LT900055.1|:325704..326405",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQNAYPKDCGAFTGEITSKHLEELKINTLLIGHSERR LLKESPNFLKEKFDFFKDKKFKIVYCIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHGFLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGS SLELENFKTIISFL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|133692         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQN
                  0 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
CAJ99216.         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQN

gi|133692        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRALLKESPNFLKEKFDFFKDKKFKIVY
                 60 ||||||||||||||||||||||||||||||||||.|||||||||||||||||||||||||
CAJ99216.        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRVLLKESPNFLKEKFDFFKDKKFKIVY

gi|133692       120 CIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHG
                120 ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
CAJ99216.       120 CIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHG

gi|133692       180 FLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSASLELENFKTIISFL 234
                180 |||||||||||||||||||||||||||||||||||||||.|||||||||||||| 234
CAJ99216.       180 FLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL 234
""",
        )
        hit = record[2]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1033012332|gb|CP011486.1|")
        self.assertEqual(hit.target.name, "CP011486")
        self.assertEqual(
            hit.target.description, "Helicobacter pylori strain K26A1, complete genome"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1570310)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1164.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 452.981)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.45778e-143)
        self.assertEqual(hsp.annotations["identity"], 221)
        self.assertEqual(hsp.annotations["positive"], 224)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 234],
                          [  0, 234]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 234))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.query.id, "CAJ99216.1")
        self.assertEqual(
            hsp.query.description, "tim [Helicobacter acinonychis str. Sheeba]"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.target.id, "gi|1033012332|gb|CP011486.1|")
        self.assertEqual(hsp.target.name, "CP011486")
        self.assertEqual(
            hsp.target.description, "Helicobacter pylori strain K26A1, complete genome"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1570310))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "gi|1033012332|gb|CP011486.1|:196043..196744",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLG QNAYPKDCGAFTGEITSKHLEELKINTLLIGHSERR LLKESP+FLKEKFDFFKDK FKI+YCIGEDLKTREKGL AVKEFLNEQLENIDL Y NLIVAYEPIWAIGT KSASLEDIYLTHGFLKQ LNQK PLLYGGSVNTQNAKEILGIDSVDGLL+GS SLELENFKTIISFL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|103301         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGAQN
                  0 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||.||
CAJ99216.         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQN

gi|103301        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRTLLKESPSFLKEKFDFFKDKNFKIIY
                 60 ||||||||||||||||||||||||||||||||||.||||||.||||||||||||.|||.|
CAJ99216.        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRVLLKESPNFLKEKFDFFKDKKFKIVY

gi|103301       120 CIGEDLKTREKGLAAVKEFLNEQLENIDLSYHNLIVAYEPIWAIGTKKSASLEDIYLTHG
                120 |||||||||||||.|||||||||||||||.|.||||||||||||||.|||||||||||||
CAJ99216.       120 CIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHG

gi|103301       180 FLKQILNQKTPLLYGGSVNTQNAKEILGIDSVDGLLVGSASLELENFKTIISFL 234
                180 ||||.||||.||||||||||||||||||||||||||.||.|||||||||||||| 234
CAJ99216.       180 FLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL 234
""",
        )
        hit = record[3]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1559948212|dbj|AP017633.1|")
        self.assertEqual(hit.target.name, "AP017633")
        self.assertEqual(
            hit.target.description,
            "Helicobacter pylori DNA, complete genome, strain: PMSS1",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1603093)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1136.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 442.195)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.08706e-139)
        self.assertEqual(hsp.annotations["identity"], 218)
        self.assertEqual(hsp.annotations["positive"], 223)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 234],
                          [  0, 234]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 234))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.query.id, "CAJ99216.1")
        self.assertEqual(
            hsp.query.description, "tim [Helicobacter acinonychis str. Sheeba]"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHFDRVFVFPDFLGLLPNSFLHF...SFL')",
        )
        self.assertEqual(hsp.target.id, "gi|1559948212|dbj|AP017633.1|")
        self.assertEqual(hsp.target.name, "AP017633")
        self.assertEqual(
            hsp.target.description,
            "Helicobacter pylori DNA, complete genome, strain: PMSS1",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1603093))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "gi|1559948212|dbj|AP017633.1|:1330168..1330869",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQH DRVFVFPDFLGLLPN+FLHFTLGVQNAYP+DCGAFTGEITSKHLEELKI+TLLIGHSERRVLLKESP+FLKEKFDFFKDK FKIVYCIGEDL TREKG  AVKEFLNEQLENIDL+Y NLIVAYEPIWAIGT KSASLEDIYLTHGFLKQ LNQK PLLYGGSVNTQNAKEILGIDSVDGLLIGS S ELENFKTIISFL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|155994         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHFDRVFVFPDFLGLLPNSFLHFTLGVQN
                  0 |||||||||||||||||||||||||||||||||.|||||||||||||||.||||||||||
CAJ99216.         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQN

gi|155994        60 AYPRDCGAFTGEITSKHLEELKIHTLLIGHSERRVLLKESPSFLKEKFDFFKDKNFKIVY
                 60 |||.|||||||||||||||||||.|||||||||||||||||.||||||||||||.|||||
CAJ99216.        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRVLLKESPNFLKEKFDFFKDKKFKIVY

gi|155994       120 CIGEDLTTREKGFKAVKEFLNEQLENIDLNYSNLIVAYEPIWAIGTKKSASLEDIYLTHG
                120 ||||||.|||||..|||||||||||||||.|.||||||||||||||.|||||||||||||
CAJ99216.       120 CIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHG

gi|155994       180 FLKQILNQKTPLLYGGSVNTQNAKEILGIDSVDGLLIGSASWELENFKTIISFL 234
                180 ||||.||||.|||||||||||||||||||||||||||||.|.|||||||||||| 234
CAJ99216.       180 FLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL 234
""",
        )
        hit = record[4]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1143706535|gb|CP018823.1|")
        self.assertEqual(hit.target.name, "CP018823")
        self.assertEqual(
            hit.target.description, "Helicobacter pylori strain PMSS1 complete genome"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1618480)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1136.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 442.195)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.08707e-139)
        self.assertEqual(hsp.annotations["identity"], 218)
        self.assertEqual(hsp.annotations["positive"], 223)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 234],
                          [  0, 234]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 234))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.query.id, "CAJ99216.1")
        self.assertEqual(
            hsp.query.description, "tim [Helicobacter acinonychis str. Sheeba]"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHFDRVFVFPDFLGLLPNSFLHF...SFL')",
        )
        self.assertEqual(hsp.target.id, "gi|1143706535|gb|CP018823.1|")
        self.assertEqual(hsp.target.name, "CP018823")
        self.assertEqual(
            hsp.target.description, "Helicobacter pylori strain PMSS1 complete genome"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1618480))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "gi|1143706535|gb|CP018823.1|:190464..191165",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQH DRVFVFPDFLGLLPN+FLHFTLGVQNAYP+DCGAFTGEITSKHLEELKI+TLLIGHSERRVLLKESP+FLKEKFDFFKDK FKIVYCIGEDL TREKG  AVKEFLNEQLENIDL+Y NLIVAYEPIWAIGT KSASLEDIYLTHGFLKQ LNQK PLLYGGSVNTQNAKEILGIDSVDGLLIGS S ELENFKTIISFL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|114370         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHFDRVFVFPDFLGLLPNSFLHFTLGVQN
                  0 |||||||||||||||||||||||||||||||||.|||||||||||||||.||||||||||
CAJ99216.         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQN

gi|114370        60 AYPRDCGAFTGEITSKHLEELKIHTLLIGHSERRVLLKESPSFLKEKFDFFKDKNFKIVY
                 60 |||.|||||||||||||||||||.|||||||||||||||||.||||||||||||.|||||
CAJ99216.        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRVLLKESPNFLKEKFDFFKDKKFKIVY

gi|114370       120 CIGEDLTTREKGFKAVKEFLNEQLENIDLNYSNLIVAYEPIWAIGTKKSASLEDIYLTHG
                120 ||||||.|||||..|||||||||||||||.|.||||||||||||||.|||||||||||||
CAJ99216.       120 CIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHG

gi|114370       180 FLKQILNQKTPLLYGGSVNTQNAKEILGIDSVDGLLIGSASWELENFKTIISFL 234
                180 ||||.||||.|||||||||||||||||||||||||||||.|.|||||||||||| 234
CAJ99216.       180 FLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL 234
""",
        )
        hit = record[5]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1149039824|gb|CP009259.1|")
        self.assertEqual(hit.target.name, "CP009259")
        self.assertEqual(
            hit.target.description, "Helicobacter pylori SS1, complete genome"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1619098)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1136.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 442.195)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.08707e-139)
        self.assertEqual(hsp.annotations["identity"], 218)
        self.assertEqual(hsp.annotations["positive"], 223)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 234],
                          [  0, 234]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 234))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.query.id, "CAJ99216.1")
        self.assertEqual(
            hsp.query.description, "tim [Helicobacter acinonychis str. Sheeba]"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHFDRVFVFPDFLGLLPNSFLHF...SFL')",
        )
        self.assertEqual(hsp.target.id, "gi|1149039824|gb|CP009259.1|")
        self.assertEqual(hsp.target.name, "CP009259")
        self.assertEqual(
            hsp.target.description, "Helicobacter pylori SS1, complete genome"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1619098))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "gi|1149039824|gb|CP009259.1|:190465..191166",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQH DRVFVFPDFLGLLPN+FLHFTLGVQNAYP+DCGAFTGEITSKHLEELKI+TLLIGHSERRVLLKESP+FLKEKFDFFKDK FKIVYCIGEDL TREKG  AVKEFLNEQLENIDL+Y NLIVAYEPIWAIGT KSASLEDIYLTHGFLKQ LNQK PLLYGGSVNTQNAKEILGIDSVDGLLIGS S ELENFKTIISFL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|114903         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHFDRVFVFPDFLGLLPNSFLHFTLGVQN
                  0 |||||||||||||||||||||||||||||||||.|||||||||||||||.||||||||||
CAJ99216.         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQN

gi|114903        60 AYPRDCGAFTGEITSKHLEELKIHTLLIGHSERRVLLKESPSFLKEKFDFFKDKNFKIVY
                 60 |||.|||||||||||||||||||.|||||||||||||||||.||||||||||||.|||||
CAJ99216.        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRVLLKESPNFLKEKFDFFKDKKFKIVY

gi|114903       120 CIGEDLTTREKGFKAVKEFLNEQLENIDLNYSNLIVAYEPIWAIGTKKSASLEDIYLTHG
                120 ||||||.|||||..|||||||||||||||.|.||||||||||||||.|||||||||||||
CAJ99216.       120 CIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHG

gi|114903       180 FLKQILNQKTPLLYGGSVNTQNAKEILGIDSVDGLLIGSASWELENFKTIISFL 234
                180 ||||.||||.|||||||||||||||||||||||||||||.|.|||||||||||| 234
CAJ99216.       180 FLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL 234
""",
        )
        hit = record[6]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1560269298|gb|CP035106.1|")
        self.assertEqual(hit.target.name, "CP035106")
        self.assertEqual(
            hit.target.description,
            "Helicobacter pylori strain Hpbs3 chromosome, complete genome",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1514674)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1133.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 441.039)
        self.assertAlmostEqual(hsp.annotations["evalue"], 5.81854e-139)
        self.assertEqual(hsp.annotations["identity"], 215)
        self.assertEqual(hsp.annotations["positive"], 224)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 234],
                          [  0, 234]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 234))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.query.id, "CAJ99216.1")
        self.assertEqual(
            hsp.query.description, "tim [Helicobacter acinonychis str. Sheeba]"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLEELEKTLKPQHSDRVFVFPDFLGLLPNSFLHF...SFL')",
        )
        self.assertEqual(hsp.target.id, "gi|1560269298|gb|CP035106.1|")
        self.assertEqual(hsp.target.name, "CP035106")
        self.assertEqual(
            hsp.target.description,
            "Helicobacter pylori strain Hpbs3 chromosome, complete genome",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1514674))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "gi|1560269298|gb|CP035106.1|:1231590..1232291",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "MTKIAMANFKSAMPIFKSHAYL+ELEKTLKPQH DRVFVFPDFLGLLPN+FLHFTLGVQNAYP+DCGAFTGEITS+HLEELKINTLLIGHSERR+LLKESP+FLKEKFDFFK K FKIVYCIGE+L TREKG  AVKEFLNEQLENIDL+Y NL+VAYEPIWAIGT KSASLEDIYLTHGFLKQ LNQK PLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156026         0 MTKIAMANFKSAMPIFKSHAYLEELEKTLKPQHSDRVFVFPDFLGLLPNSFLHFTLGVQN
                  0 ||||||||||||||||||||||.||||||||||.|||||||||||||||.||||||||||
CAJ99216.         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQN

gi|156026        60 AYPRDCGAFTGEITSQHLEELKINTLLIGHSERRLLLKESPSFLKEKFDFFKSKNFKIVY
                 60 |||.|||||||||||.||||||||||||||||||.||||||.||||||||||.|.|||||
CAJ99216.        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRVLLKESPNFLKEKFDFFKDKKFKIVY

gi|156026       120 CIGEELTTREKGFKAVKEFLNEQLENIDLNYPNLVVAYEPIWAIGTKKSASLEDIYLTHG
                120 ||||.|.|||||..|||||||||||||||.|.||.|||||||||||.|||||||||||||
CAJ99216.       120 CIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHG

gi|156026       180 FLKQVLNQKTPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL 234
                180 ||||.||||.|||||||||||||||||||||||||||||||||||||||||||| 234
CAJ99216.       180 FLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL 234
""",
        )
        hit = record[7]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1540258434|emb|LR134517.1|")
        self.assertEqual(hit.target.name, "LR134517")
        self.assertEqual(
            hit.target.description,
            "Helicobacter pylori strain NCTC13345 genome assembly, chromosome: 1",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1644315)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1131.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 440.269)
        self.assertAlmostEqual(hsp.annotations["evalue"], 9.62198e-139)
        self.assertEqual(hsp.annotations["identity"], 216)
        self.assertEqual(hsp.annotations["positive"], 222)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 234],
                          [  0, 234]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 234))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.query.id, "CAJ99216.1")
        self.assertEqual(
            hsp.query.description, "tim [Helicobacter acinonychis str. Sheeba]"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHFDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.target.id, "gi|1540258434|emb|LR134517.1|")
        self.assertEqual(hsp.target.name, "LR134517")
        self.assertEqual(
            hsp.target.description,
            "Helicobacter pylori strain NCTC13345 genome assembly, chromosome: 1",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1644315))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "gi|1540258434|emb|LR134517.1|:363062..363763",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQH DRVFVFPDFLGLLPNAFLHFTLG QNAYP+DCGAFTGEITSKHLEELKI+TLLIGHSERR LLKESP+FLKEKFDFFKDK FKIVYC+GEDL TREKG  AVKEFL+EQLENIDL+Y NLIVAYEPIWAIGT KSASLEDIYLTHGFLKQ LNQK PLLYGGSVNTQNAKEILGIDSVDGLLIGS SLELENFKTIISFL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|154025         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHFDRVFVFPDFLGLLPNAFLHFTLGAQN
                  0 |||||||||||||||||||||||||||||||||.|||||||||||||||||||||||.||
CAJ99216.         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQN

gi|154025        60 AYPRDCGAFTGEITSKHLEELKIHTLLIGHSERRALLKESPSFLKEKFDFFKDKNFKIVY
                 60 |||.|||||||||||||||||||.||||||||||.||||||.||||||||||||.|||||
CAJ99216.        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRVLLKESPNFLKEKFDFFKDKKFKIVY

gi|154025       120 CVGEDLTTREKGFRAVKEFLSEQLENIDLNYSNLIVAYEPIWAIGTKKSASLEDIYLTHG
                120 |.||||.|||||..||||||.||||||||.|.||||||||||||||.|||||||||||||
CAJ99216.       120 CIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHG

gi|154025       180 FLKQILNQKTPLLYGGSVNTQNAKEILGIDSVDGLLIGSASLELENFKTIISFL 234
                180 ||||.||||.|||||||||||||||||||||||||||||.|||||||||||||| 234
CAJ99216.       180 FLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL 234
""",
        )
        hit = record[8]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1033005233|gb|CP011487.1|")
        self.assertEqual(hit.target.name, "CP011487")
        self.assertEqual(
            hit.target.description, "Helicobacter pylori strain PNG84A, complete genome"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1531450)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1129.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 439.499)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.21067e-138)
        self.assertEqual(hsp.annotations["identity"], 215)
        self.assertEqual(hsp.annotations["positive"], 221)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 234],
                          [  0, 234]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 234))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.query.id, "CAJ99216.1")
        self.assertEqual(
            hsp.query.description, "tim [Helicobacter acinonychis str. Sheeba]"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHFDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.target.id, "gi|1033005233|gb|CP011487.1|")
        self.assertEqual(hsp.target.name, "CP011487")
        self.assertEqual(
            hsp.target.description, "Helicobacter pylori strain PNG84A, complete genome"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1531450))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "gi|1033005233|gb|CP011487.1|:161806..162507",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQH DRVFVFPDFLGLLPNAFLHFTLGVQNAYP+DCGAFTGEITSKHLEELKINTLLIGHSERR+LLKESP+FLKEKFDFFK K FKI+YCIGE+L TREK   AVKEFLNEQLENIDLDY NL+VAYEPIWAIG  KSASLEDIYLTHGFLKQ LNQK PLLYGGSVNTQNAKEILGIDSVDGLLIGS SLELENFKTIISFL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|103300         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHFDRVFVFPDFLGLLPNAFLHFTLGVQN
                  0 |||||||||||||||||||||||||||||||||.||||||||||||||||||||||||||
CAJ99216.         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQN

gi|103300        60 AYPRDCGAFTGEITSKHLEELKINTLLIGHSERRMLLKESPSFLKEKFDFFKSKNFKIIY
                 60 |||.||||||||||||||||||||||||||||||.||||||.||||||||||.|.|||.|
CAJ99216.        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRVLLKESPNFLKEKFDFFKDKKFKIVY

gi|103300       120 CIGEELTTREKSFKAVKEFLNEQLENIDLDYPNLVVAYEPIWAIGAKKSASLEDIYLTHG
                120 ||||.|.||||...|||||||||||||||||.||.||||||||||..|||||||||||||
CAJ99216.       120 CIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHG

gi|103300       180 FLKQILNQKTPLLYGGSVNTQNAKEILGIDSVDGLLIGSASLELENFKTIISFL 234
                180 ||||.||||.|||||||||||||||||||||||||||||.|||||||||||||| 234
CAJ99216.       180 FLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL 234
""",
        )
        hit = record[9]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1509197163|gb|CP025748.1|")
        self.assertEqual(hit.target.name, "CP025748")
        self.assertEqual(
            hit.target.description, "Helicobacter pylori strain Hp_TH2099 chromosome"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1667396)")
        self.assertEqual(len(hit), 1)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 1128.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 439.113)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.2539e-138)
        self.assertEqual(hsp.annotations["identity"], 216)
        self.assertEqual(hsp.annotations["positive"], 220)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 234],
                          [  0, 234]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 234))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHF...SFL')",
        )
        self.assertEqual(hsp.query.id, "CAJ99216.1")
        self.assertEqual(
            hsp.query.description, "tim [Helicobacter acinonychis str. Sheeba]"
        )
        self.assertEqual(len(hsp.query.features), 0)
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHFDRVFVFPDFLGLLPNSFLHF...SFL')",
        )
        self.assertEqual(hsp.target.id, "gi|1509197163|gb|CP025748.1|")
        self.assertEqual(hsp.target.name, "CP025748")
        self.assertEqual(
            hsp.target.description, "Helicobacter pylori strain Hp_TH2099 chromosome"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1667396))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "gi|1509197163|gb|CP025748.1|:200718..201419",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQH DRVFVFPDFLGLLPN+FLHFTLG QNAYPKDCGAFTGEITSKHLEELKINTLLIGHSERR LLKESPNFLKEKFDFFK K FKIVYCIGE+L TREKG  AVKEFLNEQLENIDL+Y NL+VAYEPIWAIGT KSASLEDIYLTHGFLKQ LNQK PLLYGGSVN QNAKEILGIDSVDGLLIGS SLELENFKTIISFL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|150919         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHFDRVFVFPDFLGLLPNSFLHFTLGAQN
                  0 |||||||||||||||||||||||||||||||||.|||||||||||||||.|||||||.||
CAJ99216.         0 MTKIAMANFKSAMPIFKSHAYLKELEKTLKPQHCDRVFVFPDFLGLLPNAFLHFTLGVQN

gi|150919        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRALLKESPNFLKEKFDFFKSKNFKIVY
                 60 ||||||||||||||||||||||||||||||||||.|||||||||||||||||.|.|||||
CAJ99216.        60 AYPKDCGAFTGEITSKHLEELKINTLLIGHSERRVLLKESPNFLKEKFDFFKDKKFKIVY

gi|150919       120 CIGEELTTREKGFKAVKEFLNEQLENIDLNYPNLVVAYEPIWAIGTKKSASLEDIYLTHG
                120 ||||.|.|||||..|||||||||||||||.|.||.|||||||||||.|||||||||||||
CAJ99216.       120 CIGEDLKTREKGLGAVKEFLNEQLENIDLDYQNLIVAYEPIWAIGTGKSASLEDIYLTHG

gi|150919       180 FLKQILNQKTPLLYGGSVNVQNAKEILGIDSVDGLLIGSASLELENFKTIISFL 234
                180 ||||.||||.|||||||||.|||||||||||||||||||.|||||||||||||| 234
CAJ99216.       180 FLKQHLNQKMPLLYGGSVNTQNAKEILGIDSVDGLLIGSTSLELENFKTIISFL 234
""",
        )


class TestTBlastx(unittest.TestCase):
    """Test the Blast XML parser for tblastx output."""

    def test_xml_2900_tblastx_001(self):
        """Parsing TBLASTX 2.9.0+ (xml_2900_tblastx_001.xml)."""
        filename = "xml_2900_tblastx_001.xml"
        datafile = os.path.join("Blast", filename)
        with open(datafile, "rb") as handle:
            records = Blast.parse(handle)
            self.check_xml_2900_tblastx_001_records(records)
        with Blast.parse(datafile) as records:
            self.check_xml_2900_tblastx_001_records(records)
        with open(datafile, "rb") as handle:
            record = Blast.read(handle)
        self.check_xml_2900_tblastx_001_record(record)
        record = Blast.read(datafile)
        self.check_xml_2900_tblastx_001_record(record)

    def check_xml_2900_tblastx_001_records(self, records):
        self.assertEqual(records.program, "tblastx")
        self.assertEqual(records.version, "TBLASTX 2.9.0+")
        self.assertEqual(
            records.reference,
            'Stephen F. Altschul, Thomas L. Madden, Alejandro A. Sch&auml;ffer, Jinghui Zhang, Zheng Zhang, Webb Miller, and David J. Lipman (1997), "Gapped BLAST and PSI-BLAST: a new generation of protein database search programs", Nucleic Acids Res. 25:3389-3402.',
        )
        self.assertEqual(records.db, "nr")
        self.assertIsInstance(records.query, SeqRecord)
        self.assertEqual(records.query.id, "AI021773.1")
        self.assertEqual(
            records.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(repr(records.query.seq), "Seq(None, length=365)")
        self.assertEqual(len(records.param), 5)
        self.assertEqual(records.param["matrix"], "BLOSUM62")
        self.assertAlmostEqual(records.param["expect"], 10.0)
        self.assertEqual(records.param["gap-open"], 11)
        self.assertEqual(records.param["gap-extend"], 1)
        self.assertEqual(records.param["filter"], "F")
        record = next(records)
        self.assertRaises(StopIteration, next, records)
        self.check_xml_2900_tblastx_001_record(record)

    def check_xml_2900_tblastx_001_record(self, record):
        self.assertEqual(record.num, 1)

        self.assertIsInstance(record.query, SeqRecord)
        self.assertEqual(record.query.id, "AI021773.1")
        self.assertEqual(
            record.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(repr(record.query.seq), "Seq(None, length=365)")

        self.assertEqual(len(record.stat), 7)
        self.assertEqual(record.stat["db-num"], 51302476)
        self.assertEqual(record.stat["db-len"], 204305995260)
        self.assertEqual(record.stat["hsp-len"], 0)
        self.assertAlmostEqual(record.stat["eff-space"], 0.0)
        self.assertAlmostEqual(record.stat["kappa"], 0.133956144488482)
        self.assertAlmostEqual(record.stat["lambda"], 0.317605957635731)
        self.assertAlmostEqual(record.stat["entropy"], 0.401214524497119)
        self.assertEqual(len(record), 10)

        hit = record[0]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hit.target.name, "XM_012666578")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=2403)")
        self.assertEqual(len(hit), 12)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 325.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 151.818)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.79607e-61)
        self.assertEqual(hsp.annotations["identity"], 59)
        self.assertEqual(hsp.annotations["positive"], 59)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:164..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hsp.target.name, "XM_012666578")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2403))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1580143357|ref|XM_012666578.2|:352..531"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE
                  0 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
AI021773.         0 GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE

gi|158014        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 174.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 82.6285)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.79607e-61)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:66..173")
        self.assertEqual(
            repr(hsp.target.seq), "Seq('GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hsp.target.name, "XM_012666578")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2403))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1580143357|ref|XM_012666578.2|:253..360"
        )
        self.assertEqual(
            hsp.annotations["midline"], "G  K GFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
                  0 |..|.||||||||||||||||||||||||||||||| 36
AI021773.         0 GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
""",
        )
        hsp = hit[2]
        self.assertAlmostEqual(hsp.score, 97.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 47.3464)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.79607e-61)
        self.assertEqual(hsp.annotations["identity"], 19)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 21],
                          [ 0, 21]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 21))
        self.assertEqual(repr(hsp.query.seq), "Seq('MADEEVQALVVDNGSGMCKAG')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(21))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..82")
        self.assertEqual(repr(hsp.target.seq), "Seq('MCDEEVAALVVDNGSGMCKAG')")
        self.assertEqual(hsp.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hsp.target.name, "XM_012666578")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2403))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1580143357|ref|XM_012666578.2|:208..270"
        )
        self.assertEqual(hsp.annotations["midline"], "M DEEV ALVVDNGSGMCKAG")
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 MCDEEVAALVVDNGSGMCKAG 21
                  0 |.||||.|||||||||||||| 21
AI021773.         0 MADEEVQALVVDNGSGMCKAG 21
""",
        )
        hsp = hit[3]
        self.assertAlmostEqual(hsp.score, 236.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 111.037)
        self.assertAlmostEqual(hsp.annotations["evalue"], 8.2679e-39)
        self.assertEqual(hsp.annotations["identity"], 50)
        self.assertEqual(hsp.annotations["positive"], 53)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 61],
                          [ 0, 61]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 61))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('SSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSP...FDP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(61))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:163..345)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('ASVRRTGCSSGATRSSL*NV*CQIFSMSSQLVTIPCSIGYLSVRMPLLD*ASSP...FCP')",
        )
        self.assertEqual(hsp.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hsp.target.name, "XM_012666578")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2403))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1580143357|ref|XM_012666578.2|:351..533)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+SV RTGCSSGATR+SL*NV*CQIFSMSSQ VTIPCSIGY SVR+P  D ASSPT* SF P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 ASVRRTGCSSGATRSSL*NV*CQIFSMSSQLVTIPCSIGYLSVRMPLLD*ASSPT*ESFC
                  0 .||.||||||||||.|||||||||||||||.|||||||||.|||.|..|.||||||.||.
AI021773.         0 SSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSPT*LSFD

gi|158014        60 P 61
                 60 | 61
AI021773.        60 P 61
""",
        )
        hsp = hit[4]
        self.assertAlmostEqual(hsp.score, 109.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 52.8449)
        self.assertAlmostEqual(hsp.annotations["evalue"], 8.2679e-39)
        self.assertEqual(hsp.annotations["identity"], 23)
        self.assertEqual(hsp.annotations["positive"], 26)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:65..172)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('FCPIPTMTPW*RGLPTIEGKTARGASSPAKPALHIP')"
        )
        self.assertEqual(hsp.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hsp.target.name, "XM_012666578")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2403))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1580143357|ref|XM_012666578.2|:252..359)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "F PIPT+TP  RG PT+EG TA GASSPA P+   P"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 FCPIPTMTPW*RGLPTIEGKTARGASSPAKPALHIP 36
                  0 |.||||.||..||.||.||.||.||||||.|....| 36
AI021773.         0 F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP 36
""",
        )
        hsp = hit[5]
        self.assertAlmostEqual(hsp.score, 89.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 43.6807)
        self.assertAlmostEqual(hsp.annotations["evalue"], 8.2679e-39)
        self.assertEqual(hsp.annotations["identity"], 19)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 24],
                          [ 0, 24]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 24))
        self.assertEqual(repr(hsp.query.seq), "Seq('PALHIPDPLSTTRA*TSSSAMIIF')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(24))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:10..81)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('PALHIPDPLSTTSAATSSSHMFAF')")
        self.assertEqual(hsp.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hsp.target.name, "XM_012666578")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2403))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1580143357|ref|XM_012666578.2|:198..269)",
        )
        self.assertEqual(hsp.annotations["midline"], "PALHIPDPLSTT A TSSS M  F")
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 PALHIPDPLSTTSAATSSSHMFAF 24
                  0 ||||||||||||.|.||||.|..| 24
AI021773.         0 PALHIPDPLSTTRA*TSSSAMIIF 24
""",
        )
        hsp = hit[6]
        self.assertAlmostEqual(hsp.score, 180.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 85.3777)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.20724e-16)
        self.assertEqual(hsp.annotations["identity"], 31)
        self.assertEqual(hsp.annotations["positive"], 44)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 56],
                          [ 0, 56]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 56))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('QQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(56))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:170..337)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('EKDRMFLWSYSQLIVERVMPDLLHVVPVGNNTVFNWIFER*NASLGLSLVTDVRIF')",
        )
        self.assertEqual(hsp.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hsp.target.name, "XM_012666578")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2403))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1580143357|ref|XM_012666578.2|:358..525)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "++DR+F WS++Q IVE VMPDLLHV+PV +NTVF+W+F+  N +  L  +TDV +F",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 EKDRMFLWSYSQLIVERVMPDLLHVVPVGNNTVFNWIFER*NASLGLSLVTDVRIF 56
                  0 ..||.|.||..|.|||.||||||||.||..||||.|.|...|....|...|||..| 56
AI021773.         0 QQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF 56
""",
        )
        hsp = hit[7]
        self.assertAlmostEqual(hsp.score, 58.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 29.4763)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.20724e-16)
        self.assertEqual(hsp.annotations["identity"], 11)
        self.assertEqual(hsp.annotations["positive"], 22)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 32],
                          [ 0, 32]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 32))
        self.assertEqual(repr(hsp.query.seq), "Seq('LTHTNHHTLMSRSSNDGREYCSWCIITSESQL')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(32))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:75..170)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('LSHTNHDTLVTWPADD*RKDSTRSVVSGEASL')"
        )
        self.assertEqual(hsp.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hsp.target.name, "XM_012666578")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2403))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1580143357|ref|XM_012666578.2|:262..357)",
        )
        self.assertEqual(hsp.annotations["midline"], "L+HTNH TL++  ++D R+  +  +++ E+ L")
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 LSHTNHDTLVTWPADD*RKDSTRSVVSGEASL 32
                  0 |.||||.||......|.|..........|..| 32
AI021773.         0 LTHTNHHTLMSRSSNDGREYCSWCIITSESQL 32
""",
        )
        hsp = hit[8]
        self.assertAlmostEqual(hsp.score, 140.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 67.0494)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.02356e-10)
        self.assertEqual(hsp.annotations["identity"], 31)
        self.assertEqual(hsp.annotations["positive"], 39)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 55],
                          [ 0, 55]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 55))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('KRQLRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(55))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:169..333")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('KRFLRR*RGSVQERHSNAQISN*TRYCYQLGRHGEDLASHVLQ*AASSSRGTSGP')",
        )
        self.assertEqual(hsp.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hsp.target.name, "XM_012666578")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2403))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1580143357|ref|XM_012666578.2|:357..521"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "KR LRR*  +++  +S+ +I N TRYC +LG HGEDLASH+LQ* A  SR T  P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 KRFLRR*RGSVQERHSNAQISN*TRYCYQLGRHGEDLASHVLQ*AASSSRGTSGP 55
                  0 ||.||||........|...|.|.||||..||.||||||||.|||.|..||.|..| 55
AI021773.         0 KRQLRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCP 55
""",
        )
        hsp = hit[9]
        self.assertAlmostEqual(hsp.score, 52.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 26.727)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.02356e-10)
        self.assertEqual(hsp.annotations["identity"], 8)
        self.assertEqual(hsp.annotations["positive"], 13)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 20],
                          [ 0, 20]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 20))
        self.assertEqual(repr(hsp.query.seq), "Seq('IPFHRWTTSTSRCDGWYGSK')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(20))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:113..172")
        self.assertEqual(repr(hsp.target.seq), "Seq('LSFNRRQATSPGCHGWYGTK')")
        self.assertEqual(hsp.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hsp.target.name, "XM_012666578")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2403))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1580143357|ref|XM_012666578.2|:300..359"
        )
        self.assertEqual(hsp.annotations["midline"], "+ F+R   ++  C GWYG+K")
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 LSFNRRQATSPGCHGWYGTK 20
                  0 ..|.|.......|.||||.| 20
AI021773.         0 IPFHRWTTSTSRCDGWYGSK 20
""",
        )
        hsp = hit[10]
        self.assertAlmostEqual(hsp.score, 122.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 58.8016)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.4978e-05)
        self.assertEqual(hsp.annotations["identity"], 29)
        self.assertEqual(hsp.annotations["positive"], 34)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 55],
                          [ 0, 55]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 55))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('QKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLS')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(55))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:168..332")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('KKILTSVTRLSPREAF*RSNIQLNTVLLPTGTTWRRSGITRSTMSCE*LQRNIRS')",
        )
        self.assertEqual(hsp.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hsp.target.name, "XM_012666578")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2403))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1580143357|ref|XM_012666578.2|:356..520"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+K  TSV + +    F   N Q NTVL  TG TWRRSGIT STM+C  LQ+N  S",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 KKILTSVTRLSPREAF*RSNIQLNTVLLPTGTTWRRSGITRSTMSCE*LQRNIRS 55
                  0 .|..|||........|...|.|.||||..||.||||||||.|||.|..||.|..| 55
AI021773.         0 QKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLS 55
""",
        )
        hsp = hit[11]
        self.assertAlmostEqual(hsp.score, 113.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 54.6777)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.000261134)
        self.assertEqual(hsp.annotations["identity"], 24)
        self.assertEqual(hsp.annotations["positive"], 25)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('GQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLGI')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:225..332)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('GPDVPLELLAAHCRTCDARSSPCRPSW*QYRVQLDI')"
        )
        self.assertEqual(hsp.target.id, "gi|1580143357|ref|XM_012666578.2|")
        self.assertEqual(hsp.target.name, "XM_012666578")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2403))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1580143357|ref|XM_012666578.2|:413..520)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "G  V LE  A HCR CDARSSPC PS  QYRV+L I"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 GPDVPLELLAAHCRTCDARSSPCRPSW*QYRVQLDI 36
                  0 |..|.||..|.|||.||||||||.||..||||.|.| 36
AI021773.         0 GQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLGI 36
""",
        )
        hit = record[1]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hit.target.name, "XM_012666577")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=2364)")
        self.assertEqual(len(hit), 12)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 325.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 151.818)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.79763e-61)
        self.assertEqual(hsp.annotations["identity"], 59)
        self.assertEqual(hsp.annotations["positive"], 59)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:164..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hsp.target.name, "XM_012666577")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2364))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1580143358|ref|XM_012666577.2|:313..492"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE
                  0 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
AI021773.         0 GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE

gi|158014        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 174.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 82.6285)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.79763e-61)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:66..173")
        self.assertEqual(
            repr(hsp.target.seq), "Seq('GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hsp.target.name, "XM_012666577")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2364))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1580143358|ref|XM_012666577.2|:214..321"
        )
        self.assertEqual(
            hsp.annotations["midline"], "G  K GFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
                  0 |..|.||||||||||||||||||||||||||||||| 36
AI021773.         0 GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
""",
        )
        hsp = hit[2]
        self.assertAlmostEqual(hsp.score, 97.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 47.3464)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.79763e-61)
        self.assertEqual(hsp.annotations["identity"], 19)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 21],
                          [ 0, 21]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 21))
        self.assertEqual(repr(hsp.query.seq), "Seq('MADEEVQALVVDNGSGMCKAG')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(21))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..82")
        self.assertEqual(repr(hsp.target.seq), "Seq('MCDEEVAALVVDNGSGMCKAG')")
        self.assertEqual(hsp.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hsp.target.name, "XM_012666577")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2364))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1580143358|ref|XM_012666577.2|:169..231"
        )
        self.assertEqual(hsp.annotations["midline"], "M DEEV ALVVDNGSGMCKAG")
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 MCDEEVAALVVDNGSGMCKAG 21
                  0 |.||||.|||||||||||||| 21
AI021773.         0 MADEEVQALVVDNGSGMCKAG 21
""",
        )
        hsp = hit[3]
        self.assertAlmostEqual(hsp.score, 236.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 111.037)
        self.assertAlmostEqual(hsp.annotations["evalue"], 8.2703e-39)
        self.assertEqual(hsp.annotations["identity"], 50)
        self.assertEqual(hsp.annotations["positive"], 53)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 61],
                          [ 0, 61]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 61))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('SSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSP...FDP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(61))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:163..345)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('ASVRRTGCSSGATRSSL*NV*CQIFSMSSQLVTIPCSIGYLSVRMPLLD*ASSP...FCP')",
        )
        self.assertEqual(hsp.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hsp.target.name, "XM_012666577")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2364))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1580143358|ref|XM_012666577.2|:312..494)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+SV RTGCSSGATR+SL*NV*CQIFSMSSQ VTIPCSIGY SVR+P  D ASSPT* SF P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 ASVRRTGCSSGATRSSL*NV*CQIFSMSSQLVTIPCSIGYLSVRMPLLD*ASSPT*ESFC
                  0 .||.||||||||||.|||||||||||||||.|||||||||.|||.|..|.||||||.||.
AI021773.         0 SSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSPT*LSFD

gi|158014        60 P 61
                 60 | 61
AI021773.        60 P 61
""",
        )
        hsp = hit[4]
        self.assertAlmostEqual(hsp.score, 109.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 52.8449)
        self.assertAlmostEqual(hsp.annotations["evalue"], 8.2703e-39)
        self.assertEqual(hsp.annotations["identity"], 23)
        self.assertEqual(hsp.annotations["positive"], 26)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:65..172)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('FCPIPTMTPW*RGLPTIEGKTARGASSPAKPALHIP')"
        )
        self.assertEqual(hsp.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hsp.target.name, "XM_012666577")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2364))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1580143358|ref|XM_012666577.2|:213..320)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "F PIPT+TP  RG PT+EG TA GASSPA P+   P"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 FCPIPTMTPW*RGLPTIEGKTARGASSPAKPALHIP 36
                  0 |.||||.||..||.||.||.||.||||||.|....| 36
AI021773.         0 F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP 36
""",
        )
        hsp = hit[5]
        self.assertAlmostEqual(hsp.score, 89.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 43.6807)
        self.assertAlmostEqual(hsp.annotations["evalue"], 8.2703e-39)
        self.assertEqual(hsp.annotations["identity"], 19)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 24],
                          [ 0, 24]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 24))
        self.assertEqual(repr(hsp.query.seq), "Seq('PALHIPDPLSTTRA*TSSSAMIIF')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(24))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:10..81)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('PALHIPDPLSTTSAATSSSHMFAF')")
        self.assertEqual(hsp.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hsp.target.name, "XM_012666577")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2364))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1580143358|ref|XM_012666577.2|:159..230)",
        )
        self.assertEqual(hsp.annotations["midline"], "PALHIPDPLSTT A TSSS M  F")
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 PALHIPDPLSTTSAATSSSHMFAF 24
                  0 ||||||||||||.|.||||.|..| 24
AI021773.         0 PALHIPDPLSTTRA*TSSSAMIIF 24
""",
        )
        hsp = hit[6]
        self.assertAlmostEqual(hsp.score, 180.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 85.3777)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.20758e-16)
        self.assertEqual(hsp.annotations["identity"], 31)
        self.assertEqual(hsp.annotations["positive"], 44)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 56],
                          [ 0, 56]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 56))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('QQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(56))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:170..337)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('EKDRMFLWSYSQLIVERVMPDLLHVVPVGNNTVFNWIFER*NASLGLSLVTDVRIF')",
        )
        self.assertEqual(hsp.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hsp.target.name, "XM_012666577")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2364))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1580143358|ref|XM_012666577.2|:319..486)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "++DR+F WS++Q IVE VMPDLLHV+PV +NTVF+W+F+  N +  L  +TDV +F",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 EKDRMFLWSYSQLIVERVMPDLLHVVPVGNNTVFNWIFER*NASLGLSLVTDVRIF 56
                  0 ..||.|.||..|.|||.||||||||.||..||||.|.|...|....|...|||..| 56
AI021773.         0 QQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF 56
""",
        )
        hsp = hit[7]
        self.assertAlmostEqual(hsp.score, 58.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 29.4763)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.20758e-16)
        self.assertEqual(hsp.annotations["identity"], 11)
        self.assertEqual(hsp.annotations["positive"], 22)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 32],
                          [ 0, 32]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 32))
        self.assertEqual(repr(hsp.query.seq), "Seq('LTHTNHHTLMSRSSNDGREYCSWCIITSESQL')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(32))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:75..170)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('LSHTNHDTLVTWPADD*RKDSTRSVVSGEASL')"
        )
        self.assertEqual(hsp.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hsp.target.name, "XM_012666577")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2364))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1580143358|ref|XM_012666577.2|:223..318)",
        )
        self.assertEqual(hsp.annotations["midline"], "L+HTNH TL++  ++D R+  +  +++ E+ L")
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 LSHTNHDTLVTWPADD*RKDSTRSVVSGEASL 32
                  0 |.||||.||......|.|..........|..| 32
AI021773.         0 LTHTNHHTLMSRSSNDGREYCSWCIITSESQL 32
""",
        )
        hsp = hit[8]
        self.assertAlmostEqual(hsp.score, 140.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 67.0494)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.0243e-10)
        self.assertEqual(hsp.annotations["identity"], 31)
        self.assertEqual(hsp.annotations["positive"], 39)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 55],
                          [ 0, 55]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 55))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('KRQLRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(55))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:169..333")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('KRFLRR*RGSVQERHSNAQISN*TRYCYQLGRHGEDLASHVLQ*AASSSRGTSGP')",
        )
        self.assertEqual(hsp.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hsp.target.name, "XM_012666577")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2364))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1580143358|ref|XM_012666577.2|:318..482"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "KR LRR*  +++  +S+ +I N TRYC +LG HGEDLASH+LQ* A  SR T  P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 KRFLRR*RGSVQERHSNAQISN*TRYCYQLGRHGEDLASHVLQ*AASSSRGTSGP 55
                  0 ||.||||........|...|.|.||||..||.||||||||.|||.|..||.|..| 55
AI021773.         0 KRQLRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCP 55
""",
        )
        hsp = hit[9]
        self.assertAlmostEqual(hsp.score, 52.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 26.727)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.0243e-10)
        self.assertEqual(hsp.annotations["identity"], 8)
        self.assertEqual(hsp.annotations["positive"], 13)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 20],
                          [ 0, 20]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 20))
        self.assertEqual(repr(hsp.query.seq), "Seq('IPFHRWTTSTSRCDGWYGSK')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(20))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:113..172")
        self.assertEqual(repr(hsp.target.seq), "Seq('LSFNRRQATSPGCHGWYGTK')")
        self.assertEqual(hsp.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hsp.target.name, "XM_012666577")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2364))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1580143358|ref|XM_012666577.2|:261..320"
        )
        self.assertEqual(hsp.annotations["midline"], "+ F+R   ++  C GWYG+K")
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 LSFNRRQATSPGCHGWYGTK 20
                  0 ..|.|.......|.||||.| 20
AI021773.         0 IPFHRWTTSTSRCDGWYGSK 20
""",
        )
        hsp = hit[10]
        self.assertAlmostEqual(hsp.score, 122.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 58.8016)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.4978e-05)
        self.assertEqual(hsp.annotations["identity"], 29)
        self.assertEqual(hsp.annotations["positive"], 34)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 55],
                          [ 0, 55]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 55))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('QKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLS')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(55))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:168..332")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('KKILTSVTRLSPREAF*RSNIQLNTVLLPTGTTWRRSGITRSTMSCE*LQRNIRS')",
        )
        self.assertEqual(hsp.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hsp.target.name, "XM_012666577")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2364))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1580143358|ref|XM_012666577.2|:317..481"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+K  TSV + +    F   N Q NTVL  TG TWRRSGIT STM+C  LQ+N  S",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 KKILTSVTRLSPREAF*RSNIQLNTVLLPTGTTWRRSGITRSTMSCE*LQRNIRS 55
                  0 .|..|||........|...|.|.||||..||.||||||||.|||.|..||.|..| 55
AI021773.         0 QKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLS 55
""",
        )
        hsp = hit[11]
        self.assertAlmostEqual(hsp.score, 113.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 54.6777)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.000261134)
        self.assertEqual(hsp.annotations["identity"], 24)
        self.assertEqual(hsp.annotations["positive"], 25)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('GQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLGI')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:225..332)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('GPDVPLELLAAHCRTCDARSSPCRPSW*QYRVQLDI')"
        )
        self.assertEqual(hsp.target.id, "gi|1580143358|ref|XM_012666577.2|")
        self.assertEqual(hsp.target.name, "XM_012666577")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Monomorium pharaonis actin-5C (LOC105828314), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(2364))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1580143358|ref|XM_012666577.2|:374..481)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "G  V LE  A HCR CDARSSPC PS  QYRV+L I"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|158014         0 GPDVPLELLAAHCRTCDARSSPCRPSW*QYRVQLDI 36
                  0 |..|.||..|.|||.||||||||.||..||||.|.| 36
AI021773.         0 GQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLGI 36
""",
        )
        hit = record[2]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hit.target.name, "XM_028307359")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1791)")
        self.assertEqual(len(hit), 12)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 325.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 151.818)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.82427e-61)
        self.assertEqual(hsp.annotations["identity"], 59)
        self.assertEqual(hsp.annotations["positive"], 59)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:164..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hsp.target.name, "XM_028307359")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1791))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279040|ref|XM_028307359.1|:492..671"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE
                  0 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
AI021773.         0 GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE

gi|159027        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 174.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 82.6285)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.82427e-61)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:66..173")
        self.assertEqual(
            repr(hsp.target.seq), "Seq('GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hsp.target.name, "XM_028307359")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1791))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279040|ref|XM_028307359.1|:393..500"
        )
        self.assertEqual(
            hsp.annotations["midline"], "G  K GFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
                  0 |..|.||||||||||||||||||||||||||||||| 36
AI021773.         0 GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
""",
        )
        hsp = hit[2]
        self.assertAlmostEqual(hsp.score, 97.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 47.3464)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.82427e-61)
        self.assertEqual(hsp.annotations["identity"], 19)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 21],
                          [ 0, 21]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 21))
        self.assertEqual(repr(hsp.query.seq), "Seq('MADEEVQALVVDNGSGMCKAG')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(21))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..82")
        self.assertEqual(repr(hsp.target.seq), "Seq('MCDEEVAALVVDNGSGMCKAG')")
        self.assertEqual(hsp.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hsp.target.name, "XM_028307359")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1791))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279040|ref|XM_028307359.1|:348..410"
        )
        self.assertEqual(hsp.annotations["midline"], "M DEEV ALVVDNGSGMCKAG")
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 MCDEEVAALVVDNGSGMCKAG 21
                  0 |.||||.|||||||||||||| 21
AI021773.         0 MADEEVQALVVDNGSGMCKAG 21
""",
        )
        hsp = hit[3]
        self.assertAlmostEqual(hsp.score, 220.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 103.706)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.80057e-37)
        self.assertEqual(hsp.annotations["identity"], 47)
        self.assertEqual(hsp.annotations["positive"], 52)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 64],
                          [ 0, 64]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 64))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('IQWSSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCA...FDP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(64))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:163..354)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('LRGASVRRTGCSSGATRSSL*KVWCQIFSMSSQFVTIPCSMGYFRVRIPLLLWA...FCP')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hsp.target.name, "XM_028307359")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1791))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279040|ref|XM_028307359.1|:491..682)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "++ +SV RTGCSSGATR+SL* V CQIFSMSSQFVTIPCS+GYF VRIP    ASSPT  SF P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 LRGASVRRTGCSSGATRSSL*KVWCQIFSMSSQFVTIPCSMGYFRVRIPLLLWASSPTYE
                  0 ....||.||||||||||.|||.|.||||||||||||||||.|||.||||....|||||..
AI021773.         0 IQWSSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSPT*L

gi|159027        60 SFCP 64
                 60 ||.| 64
AI021773.        60 SFDP 64
""",
        )
        hsp = hit[4]
        self.assertAlmostEqual(hsp.score, 121.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 58.3434)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.80057e-37)
        self.assertEqual(hsp.annotations["identity"], 24)
        self.assertEqual(hsp.annotations["positive"], 28)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:65..172)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('FCPMPTITPWWRGRPTIDGNTARGASSPAKPALHIP')"
        )
        self.assertEqual(hsp.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hsp.target.name, "XM_028307359")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1791))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279040|ref|XM_028307359.1|:392..499)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "F P+PTITP  RGRPT++GNTA GASSPA P+   P"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 FCPMPTITPWWRGRPTIDGNTARGASSPAKPALHIP 36
                  0 |.|.|||||..|||||..||||.||||||.|....| 36
AI021773.         0 F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP 36
""",
        )
        hsp = hit[5]
        self.assertAlmostEqual(hsp.score, 80.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 39.5569)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.80057e-37)
        self.assertEqual(hsp.annotations["identity"], 16)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 22],
                          [ 0, 22]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 22))
        self.assertEqual(repr(hsp.query.seq), "Seq('PALHIPDPLSTTRA*TSSSAMI')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(22))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:16..81)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('PALHIPEPLSTTNAATSSSHIV')")
        self.assertEqual(hsp.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hsp.target.name, "XM_028307359")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1791))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279040|ref|XM_028307359.1|:344..409)",
        )
        self.assertEqual(hsp.annotations["midline"], "PALHIP+PLSTT A TSSS ++")
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 PALHIPEPLSTTNAATSSSHIV 22
                  0 ||||||.|||||.|.||||... 22
AI021773.         0 PALHIPDPLSTTRA*TSSSAMI 22
""",
        )
        hsp = hit[6]
        self.assertAlmostEqual(hsp.score, 157.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 74.8389)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.23146e-16)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 42)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 57],
                          [ 0, 57]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 57))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('LGQQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAV')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(57))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:173..343)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('LCEKDWVFLGGDTEFIVEGVVPDLLHVIPVRDDSVFDGVFQSEDTSLALGLVTDVRV')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hsp.target.name, "XM_028307359")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1791))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279040|ref|XM_028307359.1|:501..671)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "L ++D VF    T+FIVE V+PDLLHVIPVR ++VFD VFQ E+T+  L  +TDV V",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 LCEKDWVFLGGDTEFIVEGVVPDLLHVIPVRDDSVFDGVFQSEDTSLALGLVTDVRV 57
                  0 |...|.||....|.||||.|.||||||||||...|||.|||.|.|...|...|||.| 57
AI021773.         0 LGQQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAV 57
""",
        )
        hsp = hit[7]
        self.assertAlmostEqual(hsp.score, 77.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 38.1822)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.23146e-16)
        self.assertEqual(hsp.annotations["identity"], 14)
        self.assertEqual(hsp.annotations["positive"], 25)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 33],
                          [ 0, 33]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 33))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('LLTHTNHHTLMSRSSNDGREYCSWCIITSESQL')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(33))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:75..173)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('LLSHANHHTLVARAAHDRWEHGAGRVVTRETGL')"
        )
        self.assertEqual(hsp.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hsp.target.name, "XM_028307359")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1791))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279040|ref|XM_028307359.1|:402..500)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "LL+H NHHTL++R+++D  E+ +  ++T E+ L"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 LLSHANHHTLVARAAHDRWEHGAGRVVTRETGL 33
                  0 ||.|.|||||..|...|..|.......|.|..| 33
AI021773.         0 LLTHTNHHTLMSRSSNDGREYCSWCIITSESQL 33
""",
        )
        hsp = hit[8]
        self.assertAlmostEqual(hsp.score, 140.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 67.0494)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.03695e-10)
        self.assertEqual(hsp.annotations["identity"], 32)
        self.assertEqual(hsp.annotations["positive"], 37)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('LRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAPLYP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:178..357")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('VRR*RGPEQERYPHSEIPHRTRNRHELG*HGEDLAPHLLQ*TPCRPRGTPSPSHRGTPQP')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hsp.target.name, "XM_028307359")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1791))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279040|ref|XM_028307359.1|:506..685"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+RR*    +  Y H+EIP+RTR   ELG*HGEDLA H+LQ*  C  R TP P  R    P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 VRR*RGPEQERYPHSEIPHRTRNRHELG*HGEDLAPHLLQ*TPCRPRGTPSPSHRGTPQP
                  0 .|||.......|.|.|||.|||...||||||||||.|.|||..|..|.||.|..|....|
AI021773.         0 LRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAPLYP

gi|159027        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[9]
        self.assertAlmostEqual(hsp.score, 52.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 26.727)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.03695e-10)
        self.assertEqual(hsp.annotations["identity"], 8)
        self.assertEqual(hsp.annotations["positive"], 12)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 20],
                          [ 0, 20]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 20))
        self.assertEqual(repr(hsp.query.seq), "Seq('IPFHRWTTSTSRCDGWYGSK')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(20))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:113..172")
        self.assertEqual(repr(hsp.target.seq), "Seq('VPIDRGPPSPPGCDGWHGTE')")
        self.assertEqual(hsp.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hsp.target.name, "XM_028307359")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1791))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279040|ref|XM_028307359.1|:440..499"
        )
        self.assertEqual(hsp.annotations["midline"], "+P  R   S   CDGW+G++")
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 VPIDRGPPSPPGCDGWHGTE 20
                  0 .|..|...|...||||.|.. 20
AI021773.         0 IPFHRWTTSTSRCDGWYGSK 20
""",
        )
        hsp = hit[10]
        self.assertAlmostEqual(hsp.score, 136.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 65.2165)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.75538e-07)
        self.assertEqual(hsp.annotations["identity"], 29)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 52],
                          [ 0, 52]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 52))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLGISV*EYHVSIVLHHRRS')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(52))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:177..332)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GLGVPRGRHGVHCRRCGARSSPCHPSS*RFRVRWGISE*GYLSCSGPRHRRT')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hsp.target.name, "XM_028307359")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1791))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279040|ref|XM_028307359.1|:505..660)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G GV    H +HCR C ARSSPCHPSS ++RVR GIS * Y       HRR+",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 GLGVPRGRHGVHCRRCGARSSPCHPSS*RFRVRWGISE*GYLSCSGPRHRRT 52
                  0 |.||....|..|||.|.||||||||||...|||.|||.|.|.......|||. 52
AI021773.         0 GQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLGISV*EYHVSIVLHHRRS 52
""",
        )
        hsp = hit[11]
        self.assertAlmostEqual(hsp.score, 127.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 61.0927)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.06042e-06)
        self.assertEqual(hsp.annotations["identity"], 31)
        self.assertEqual(hsp.annotations["positive"], 35)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 55],
                          [ 0, 55]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 55))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('QKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLS')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(55))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:168..332")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('RRTRTSVTRPRAREVSSL*NTPSNTESSRTGMTWRRSGTTPSTMNSVSPPRNTQS')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279040|ref|XM_028307359.1|")
        self.assertEqual(hsp.target.name, "XM_028307359")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1791))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279040|ref|XM_028307359.1|:496..660"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "++T TSV +     V S *NT SNT   RTGMTWRRSG T STMN V   +NT S",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 RRTRTSVTRPRAREVSSL*NTPSNTESSRTGMTWRRSGTTPSTMNSVSPPRNTQS 55
                  0 ..|.|||.......|.|.|||.|||...||||||||||.|.||||.|....||.| 55
AI021773.         0 QKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLS 55
""",
        )
        hit = record[3]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hit.target.name, "XM_028307358")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1677)")
        self.assertEqual(len(hit), 12)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 325.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 151.818)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.83062e-61)
        self.assertEqual(hsp.annotations["identity"], 59)
        self.assertEqual(hsp.annotations["positive"], 59)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:164..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hsp.target.name, "XM_028307358")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1677))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279038|ref|XM_028307358.1|:378..557"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE
                  0 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
AI021773.         0 GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE

gi|159027        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 174.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 82.6285)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.83062e-61)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:66..173")
        self.assertEqual(
            repr(hsp.target.seq), "Seq('GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hsp.target.name, "XM_028307358")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1677))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279038|ref|XM_028307358.1|:279..386"
        )
        self.assertEqual(
            hsp.annotations["midline"], "G  K GFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
                  0 |..|.||||||||||||||||||||||||||||||| 36
AI021773.         0 GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
""",
        )
        hsp = hit[2]
        self.assertAlmostEqual(hsp.score, 97.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 47.3464)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.83062e-61)
        self.assertEqual(hsp.annotations["identity"], 19)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 21],
                          [ 0, 21]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 21))
        self.assertEqual(repr(hsp.query.seq), "Seq('MADEEVQALVVDNGSGMCKAG')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(21))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..82")
        self.assertEqual(repr(hsp.target.seq), "Seq('MCDEEVAALVVDNGSGMCKAG')")
        self.assertEqual(hsp.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hsp.target.name, "XM_028307358")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1677))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279038|ref|XM_028307358.1|:234..296"
        )
        self.assertEqual(hsp.annotations["midline"], "M DEEV ALVVDNGSGMCKAG")
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 MCDEEVAALVVDNGSGMCKAG 21
                  0 |.||||.|||||||||||||| 21
AI021773.         0 MADEEVQALVVDNGSGMCKAG 21
""",
        )
        hsp = hit[3]
        self.assertAlmostEqual(hsp.score, 220.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 103.706)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.8064e-37)
        self.assertEqual(hsp.annotations["identity"], 47)
        self.assertEqual(hsp.annotations["positive"], 52)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 64],
                          [ 0, 64]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 64))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('IQWSSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCA...FDP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(64))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:163..354)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('LRGASVRRTGCSSGATRSSL*KVWCQIFSMSSQFVTIPCSMGYFRVRIPLLLWA...FCP')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hsp.target.name, "XM_028307358")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1677))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279038|ref|XM_028307358.1|:377..568)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "++ +SV RTGCSSGATR+SL* V CQIFSMSSQFVTIPCS+GYF VRIP    ASSPT  SF P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 LRGASVRRTGCSSGATRSSL*KVWCQIFSMSSQFVTIPCSMGYFRVRIPLLLWASSPTYE
                  0 ....||.||||||||||.|||.|.||||||||||||||||.|||.||||....|||||..
AI021773.         0 IQWSSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSPT*L

gi|159027        60 SFCP 64
                 60 ||.| 64
AI021773.        60 SFDP 64
""",
        )
        hsp = hit[4]
        self.assertAlmostEqual(hsp.score, 121.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 58.3434)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.8064e-37)
        self.assertEqual(hsp.annotations["identity"], 24)
        self.assertEqual(hsp.annotations["positive"], 28)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:65..172)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('FCPMPTITPWWRGRPTIDGNTARGASSPAKPALHIP')"
        )
        self.assertEqual(hsp.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hsp.target.name, "XM_028307358")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1677))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279038|ref|XM_028307358.1|:278..385)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "F P+PTITP  RGRPT++GNTA GASSPA P+   P"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 FCPMPTITPWWRGRPTIDGNTARGASSPAKPALHIP 36
                  0 |.|.|||||..|||||..||||.||||||.|....| 36
AI021773.         0 F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP 36
""",
        )
        hsp = hit[5]
        self.assertAlmostEqual(hsp.score, 80.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 39.5569)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.8064e-37)
        self.assertEqual(hsp.annotations["identity"], 16)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 22],
                          [ 0, 22]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 22))
        self.assertEqual(repr(hsp.query.seq), "Seq('PALHIPDPLSTTRA*TSSSAMI')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(22))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:16..81)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('PALHIPEPLSTTNAATSSSHIV')")
        self.assertEqual(hsp.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hsp.target.name, "XM_028307358")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1677))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279038|ref|XM_028307358.1|:230..295)",
        )
        self.assertEqual(hsp.annotations["midline"], "PALHIP+PLSTT A TSSS ++")
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 PALHIPEPLSTTNAATSSSHIV 22
                  0 ||||||.|||||.|.||||... 22
AI021773.         0 PALHIPDPLSTTRA*TSSSAMI 22
""",
        )
        hsp = hit[6]
        self.assertAlmostEqual(hsp.score, 157.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 74.8389)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.23631e-16)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 42)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 57],
                          [ 0, 57]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 57))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('LGQQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAV')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(57))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:173..343)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('LCEKDWVFLGGDTEFIVEGVVPDLLHVIPVRDDSVFDGVFQSEDTSLALGLVTDVRV')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hsp.target.name, "XM_028307358")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1677))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279038|ref|XM_028307358.1|:387..557)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "L ++D VF    T+FIVE V+PDLLHVIPVR ++VFD VFQ E+T+  L  +TDV V",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 LCEKDWVFLGGDTEFIVEGVVPDLLHVIPVRDDSVFDGVFQSEDTSLALGLVTDVRV 57
                  0 |...|.||....|.||||.|.||||||||||...|||.|||.|.|...|...|||.| 57
AI021773.         0 LGQQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAV 57
""",
        )
        hsp = hit[7]
        self.assertAlmostEqual(hsp.score, 77.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 38.1822)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.23631e-16)
        self.assertEqual(hsp.annotations["identity"], 14)
        self.assertEqual(hsp.annotations["positive"], 25)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 33],
                          [ 0, 33]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 33))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('LLTHTNHHTLMSRSSNDGREYCSWCIITSESQL')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(33))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:75..173)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('LLSHANHHTLVARAAHDRWEHGAGRVVTRETGL')"
        )
        self.assertEqual(hsp.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hsp.target.name, "XM_028307358")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1677))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279038|ref|XM_028307358.1|:288..386)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "LL+H NHHTL++R+++D  E+ +  ++T E+ L"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 LLSHANHHTLVARAAHDRWEHGAGRVVTRETGL 33
                  0 ||.|.|||||..|...|..|.......|.|..| 33
AI021773.         0 LLTHTNHHTLMSRSSNDGREYCSWCIITSESQL 33
""",
        )
        hsp = hit[8]
        self.assertAlmostEqual(hsp.score, 140.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 67.0494)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.03996e-10)
        self.assertEqual(hsp.annotations["identity"], 32)
        self.assertEqual(hsp.annotations["positive"], 37)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('LRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAPLYP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:178..357")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('VRR*RGPEQERYPHSEIPHRTRNRHELG*HGEDLAPHLLQ*TPCRPRGTPSPSHRGTPQP')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hsp.target.name, "XM_028307358")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1677))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279038|ref|XM_028307358.1|:392..571"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+RR*    +  Y H+EIP+RTR   ELG*HGEDLA H+LQ*  C  R TP P  R    P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 VRR*RGPEQERYPHSEIPHRTRNRHELG*HGEDLAPHLLQ*TPCRPRGTPSPSHRGTPQP
                  0 .|||.......|.|.|||.|||...||||||||||.|.|||..|..|.||.|..|....|
AI021773.         0 LRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAPLYP

gi|159027        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[9]
        self.assertAlmostEqual(hsp.score, 52.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 26.727)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.03996e-10)
        self.assertEqual(hsp.annotations["identity"], 8)
        self.assertEqual(hsp.annotations["positive"], 12)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 20],
                          [ 0, 20]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 20))
        self.assertEqual(repr(hsp.query.seq), "Seq('IPFHRWTTSTSRCDGWYGSK')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(20))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:113..172")
        self.assertEqual(repr(hsp.target.seq), "Seq('VPIDRGPPSPPGCDGWHGTE')")
        self.assertEqual(hsp.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hsp.target.name, "XM_028307358")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1677))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279038|ref|XM_028307358.1|:326..385"
        )
        self.assertEqual(hsp.annotations["midline"], "+P  R   S   CDGW+G++")
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 VPIDRGPPSPPGCDGWHGTE 20
                  0 .|..|...|...||||.|.. 20
AI021773.         0 IPFHRWTTSTSRCDGWYGSK 20
""",
        )
        hsp = hit[10]
        self.assertAlmostEqual(hsp.score, 136.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 65.2165)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.75538e-07)
        self.assertEqual(hsp.annotations["identity"], 29)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 52],
                          [ 0, 52]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 52))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLGISV*EYHVSIVLHHRRS')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(52))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:177..332)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GLGVPRGRHGVHCRRCGARSSPCHPSS*RFRVRWGISE*GYLSCSGPRHRRT')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hsp.target.name, "XM_028307358")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1677))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279038|ref|XM_028307358.1|:391..546)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G GV    H +HCR C ARSSPCHPSS ++RVR GIS * Y       HRR+",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 GLGVPRGRHGVHCRRCGARSSPCHPSS*RFRVRWGISE*GYLSCSGPRHRRT 52
                  0 |.||....|..|||.|.||||||||||...|||.|||.|.|.......|||. 52
AI021773.         0 GQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLGISV*EYHVSIVLHHRRS 52
""",
        )
        hsp = hit[11]
        self.assertAlmostEqual(hsp.score, 127.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 61.0927)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.06042e-06)
        self.assertEqual(hsp.annotations["identity"], 31)
        self.assertEqual(hsp.annotations["positive"], 35)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 55],
                          [ 0, 55]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 55))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('QKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLS')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(55))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:168..332")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('RRTRTSVTRPRAREVSSL*NTPSNTESSRTGMTWRRSGTTPSTMNSVSPPRNTQS')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279038|ref|XM_028307358.1|")
        self.assertEqual(hsp.target.name, "XM_028307358")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin-5C (LOC114354797), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1677))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279038|ref|XM_028307358.1|:382..546"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "++T TSV +     V S *NT SNT   RTGMTWRRSG T STMN V   +NT S",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 RRTRTSVTRPRAREVSSL*NTPSNTESSRTGMTWRRSGTTPSTMNSVSPPRNTQS 55
                  0 ..|.|||.......|.|.|||.|||...||||||||||.|.||||.|....||.| 55
AI021773.         0 QKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLS 55
""",
        )
        hit = record[4]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hit.target.name, "XM_028307351")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1599)")
        self.assertEqual(len(hit), 12)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 325.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 151.818)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.83523e-61)
        self.assertEqual(hsp.annotations["identity"], 59)
        self.assertEqual(hsp.annotations["positive"], 59)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:164..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hsp.target.name, "XM_028307351")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279025|ref|XM_028307351.1|:389..568"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE
                  0 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
AI021773.         0 GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE

gi|159027        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 174.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 82.6285)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.83523e-61)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:66..173")
        self.assertEqual(
            repr(hsp.target.seq), "Seq('GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hsp.target.name, "XM_028307351")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279025|ref|XM_028307351.1|:290..397"
        )
        self.assertEqual(
            hsp.annotations["midline"], "G  K GFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
                  0 |..|.||||||||||||||||||||||||||||||| 36
AI021773.         0 GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
""",
        )
        hsp = hit[2]
        self.assertAlmostEqual(hsp.score, 97.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 47.3464)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.83523e-61)
        self.assertEqual(hsp.annotations["identity"], 19)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 21],
                          [ 0, 21]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 21))
        self.assertEqual(repr(hsp.query.seq), "Seq('MADEEVQALVVDNGSGMCKAG')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(21))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..82")
        self.assertEqual(repr(hsp.target.seq), "Seq('MCDEEVAALVVDNGSGMCKAG')")
        self.assertEqual(hsp.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hsp.target.name, "XM_028307351")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279025|ref|XM_028307351.1|:245..307"
        )
        self.assertEqual(hsp.annotations["midline"], "M DEEV ALVVDNGSGMCKAG")
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 MCDEEVAALVVDNGSGMCKAG 21
                  0 |.||||.|||||||||||||| 21
AI021773.         0 MADEEVQALVVDNGSGMCKAG 21
""",
        )
        hsp = hit[3]
        self.assertAlmostEqual(hsp.score, 225.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 105.997)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.26469e-39)
        self.assertEqual(hsp.annotations["identity"], 48)
        self.assertEqual(hsp.annotations["positive"], 52)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 61],
                          [ 0, 61]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 61))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('SSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSP...FDP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(61))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:163..345)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('ASVRRTGCSSGATRSSL*KV*CQIFSMSSQFVTIPCSMGYLSVRMPLLLWASSP...FCP')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hsp.target.name, "XM_028307351")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279025|ref|XM_028307351.1|:388..570)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+SV RTGCSSGATR+SL* V*CQIFSMSSQFVTIPCS+GY SVR+P    ASSPT* SF P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 ASVRRTGCSSGATRSSL*KV*CQIFSMSSQFVTIPCSMGYLSVRMPLLLWASSPT*ESFC
                  0 .||.||||||||||.|||.||||||||||||||||||.||.|||.|....||||||.||.
AI021773.         0 SSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSPT*LSFD

gi|159027        60 P 61
                 60 | 61
AI021773.        60 P 61
""",
        )
        hsp = hit[4]
        self.assertAlmostEqual(hsp.score, 121.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 58.3434)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.26469e-39)
        self.assertEqual(hsp.annotations["identity"], 24)
        self.assertEqual(hsp.annotations["positive"], 28)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:65..172)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('FCPMPTITPWWRGRPTIDGNTARGASSPAKPALHIP')"
        )
        self.assertEqual(hsp.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hsp.target.name, "XM_028307351")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279025|ref|XM_028307351.1|:289..396)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "F P+PTITP  RGRPT++GNTA GASSPA P+   P"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 FCPMPTITPWWRGRPTIDGNTARGASSPAKPALHIP 36
                  0 |.|.|||||..|||||..||||.||||||.|....| 36
AI021773.         0 F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP 36
""",
        )
        hsp = hit[5]
        self.assertAlmostEqual(hsp.score, 91.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 44.5971)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.26469e-39)
        self.assertEqual(hsp.annotations["identity"], 18)
        self.assertEqual(hsp.annotations["positive"], 22)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 26],
                          [ 0, 26]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 26))
        self.assertEqual(repr(hsp.query.seq), "Seq('PALHIPDPLSTTRA*TSSSAMIIFQL')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(26))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "complement(AI021773.1:4..81)")
        self.assertEqual(repr(hsp.target.seq), "Seq('PALHIPDPLSTTNAATSSSHILVYLL')")
        self.assertEqual(hsp.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hsp.target.name, "XM_028307351")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279025|ref|XM_028307351.1|:229..306)",
        )
        self.assertEqual(hsp.annotations["midline"], "PALHIPDPLSTT A TSSS ++++ L")
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 PALHIPDPLSTTNAATSSSHILVYLL 26
                  0 ||||||||||||.|.||||......| 26
AI021773.         0 PALHIPDPLSTTRA*TSSSAMIIFQL 26
""",
        )
        hsp = hit[6]
        self.assertAlmostEqual(hsp.score, 167.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 79.421)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.27039e-16)
        self.assertEqual(hsp.annotations["identity"], 34)
        self.assertEqual(hsp.annotations["positive"], 43)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 57],
                          [ 0, 57]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 57))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GQQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(57))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:170..340)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GKKDWVFLGSDTEFIVEGVMPDLLHVIPVCDDSVFDGVFECEDASLALGLISDVGVF')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hsp.target.name, "XM_028307351")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279025|ref|XM_028307351.1|:395..565)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G++D VF  S T+FIVE VMPDLLHVIPV  ++VFD VF+CE+ +  L  I+DV VF",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 GKKDWVFLGSDTEFIVEGVMPDLLHVIPVCDDSVFDGVFECEDASLALGLISDVGVF 57
                  0 |..|.||..|.|.||||.|||||||||||....|||.||.||.....|..|.||.|| 57
AI021773.         0 GQQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF 57
""",
        )
        hsp = hit[7]
        self.assertAlmostEqual(hsp.score, 69.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 34.5166)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.27039e-16)
        self.assertEqual(hsp.annotations["identity"], 13)
        self.assertEqual(hsp.annotations["positive"], 23)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 32],
                          [ 0, 32]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 32))
        self.assertEqual(repr(hsp.query.seq), "Seq('LTHTNHHTLMSRSSNDGREYCSWCIITSESQL')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(32))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:75..170)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('LSHANHHTLVARAAHDRWEHGAGRVIARETGL')"
        )
        self.assertEqual(hsp.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hsp.target.name, "XM_028307351")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279025|ref|XM_028307351.1|:299..394)",
        )
        self.assertEqual(hsp.annotations["midline"], "L+H NHHTL++R+++D  E+ +  +I  E+ L")
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 LSHANHHTLVARAAHDRWEHGAGRVIARETGL 32
                  0 |.|.|||||..|...|..|......|..|..| 32
AI021773.         0 LTHTNHHTLMSRSSNDGREYCSWCIITSESQL 32
""",
        )
        hsp = hit[8]
        self.assertAlmostEqual(hsp.score, 160.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 76.2135)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.96635e-13)
        self.assertEqual(hsp.annotations["identity"], 36)
        self.assertEqual(hsp.annotations["positive"], 44)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 64],
                          [ 0, 64]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 64))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('KRQLRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPC...YPK')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(64))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:169..360")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('KRLLRRR*GPEQERHPHTQIPHRTRNRHKLG*HGEDLASHLLQ*TPCRSRGTPS...EPQ')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hsp.target.name, "XM_028307351")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279025|ref|XM_028307351.1|:394..585"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "KR LRR *   +  + HT+IP+RTR   +LG*HGEDLASH+LQ*  C SR TP P  R+P  P+",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 KRLLRRR*GPEQERHPHTQIPHRTRNRHKLG*HGEDLASHLLQ*TPCRSRGTPSPSYRSP
                  0 ||.|||.|........||.||.|||....|||||||||||.|||..|.||.||.|..|.|
AI021773.         0 KRQLRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAP

gi|159027        60 PEPQ 64
                 60 ..|. 64
AI021773.        60 LYPK 64
""",
        )
        hsp = hit[9]
        self.assertAlmostEqual(hsp.score, 53.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 27.1852)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.96635e-13)
        self.assertEqual(hsp.annotations["identity"], 8)
        self.assertEqual(hsp.annotations["positive"], 12)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 20],
                          [ 0, 20]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 20))
        self.assertEqual(repr(hsp.query.seq), "Seq('IPFHRWTTSTSRCDGWYGSK')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(20))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:113..172")
        self.assertEqual(repr(hsp.target.seq), "Seq('VPIDRGPPAPPGCDGWHGTK')")
        self.assertEqual(hsp.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hsp.target.name, "XM_028307351")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279025|ref|XM_028307351.1|:337..396"
        )
        self.assertEqual(hsp.annotations["midline"], "+P  R   +   CDGW+G+K")
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 VPIDRGPPAPPGCDGWHGTK 20
                  0 .|..|.......||||.|.| 20
AI021773.         0 IPFHRWTTSTSRCDGWYGSK 20
""",
        )
        hsp = hit[10]
        self.assertAlmostEqual(hsp.score, 142.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 67.9658)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.61074e-08)
        self.assertEqual(hsp.annotations["identity"], 29)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 48],
                          [ 0, 48]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 48))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('FGYNGARSTGQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLGISV*')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(48))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:216..359)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('WGSGGLR*EGLGVPRERHGVHCRRCDARSSPCHPSL*RFRVRWGI*V*')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hsp.target.name, "XM_028307351")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1590279025|ref|XM_028307351.1|:441..584)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+G  G R  G GV  E H +HCR CDARSSPCHPS  ++RVR GI V*",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 WGSGGLR*EGLGVPRERHGVHCRRCDARSSPCHPSL*RFRVRWGI*V* 48
                  0 .|..|.|..|.||..|.|..|||.|||||||||||....|||.||.|| 48
AI021773.         0 FGYNGARSTGQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLGISV* 48
""",
        )
        hsp = hit[11]
        self.assertAlmostEqual(hsp.score, 141.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 67.5076)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.58672e-08)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 37)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 58],
                          [ 0, 58]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 58))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('QKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLSC*P')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(58))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:168..341")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('KKTPTSEMRPRAREASSHSNTPSNTESSQTGMTWRRSGITPSTMNSVSLPRNTQSFLP')",
        )
        self.assertEqual(hsp.target.id, "gi|1590279025|ref|XM_028307351.1|")
        self.assertEqual(hsp.target.name, "XM_028307351")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Ostrinia furnacalis actin, cytoplasmic A3a (LOC114354791), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1590279025|ref|XM_028307351.1|:393..566"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+KT TS M+       SH NT SNT   +TGMTWRRSGIT STMN V L +NT S  P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|159027         0 KKTPTSEMRPRAREASSHSNTPSNTESSQTGMTWRRSGITPSTMNSVSLPRNTQSFLP 58
                  0 .||.||.|........||.||.|||....|||||||||||.||||.|.|..||.|..| 58
AI021773.         0 QKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLSC*P 58
""",
        )
        hit = record[5]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hit.target.name, "MK210584")
        self.assertEqual(
            hit.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1131)")
        self.assertEqual(len(hit), 18)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 325.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 151.818)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.86904e-61)
        self.assertEqual(hsp.annotations["identity"], 59)
        self.assertEqual(hsp.annotations["positive"], 59)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:164..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1578896738|gb|MK210584.1|:145..324"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE
                  0 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
AI021773.         0 GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE

gi|157889        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 174.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 82.6285)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.86904e-61)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:66..173")
        self.assertEqual(
            repr(hsp.target.seq), "Seq('GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1578896738|gb|MK210584.1|:46..153"
        )
        self.assertEqual(
            hsp.annotations["midline"], "G  K GFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
                  0 |..|.||||||||||||||||||||||||||||||| 36
AI021773.         0 GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
""",
        )
        hsp = hit[2]
        self.assertAlmostEqual(hsp.score, 97.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 47.3464)
        self.assertAlmostEqual(hsp.annotations["evalue"], 7.86904e-61)
        self.assertEqual(hsp.annotations["identity"], 19)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 21],
                          [ 0, 21]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 21))
        self.assertEqual(repr(hsp.query.seq), "Seq('MADEEVQALVVDNGSGMCKAG')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(21))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..82")
        self.assertEqual(repr(hsp.target.seq), "Seq('MCDEEVAALVVDNGSGMCKAG')")
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1578896738|gb|MK210584.1|:1..63"
        )
        self.assertEqual(hsp.annotations["midline"], "M DEEV ALVVDNGSGMCKAG")
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 MCDEEVAALVVDNGSGMCKAG 21
                  0 |.||||.|||||||||||||| 21
AI021773.         0 MADEEVQALVVDNGSGMCKAG 21
""",
        )
        hsp = hit[3]
        self.assertAlmostEqual(hsp.score, 238.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 111.954)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.65511e-42)
        self.assertEqual(hsp.annotations["identity"], 49)
        self.assertEqual(hsp.annotations["positive"], 55)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 66],
                          [ 0, 66]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 66))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('FRIQWSSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFD...FDP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(66))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:163..360)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('FGLSGASVNSTGCSSGATRSSL*KVWCQIFSISSQFVTIPCSMGYFNVRIPRLL...FWP')",
        )
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1578896738|gb|MK210584.1|:144..341)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "F +  +SVN TGCSSGATR+SL* V CQIFS+SSQFVTIPCS+GYF+VRIPR  CASSPT  SF P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 FGLSGASVNSTGCSSGATRSSL*KVWCQIFSISSQFVTIPCSMGYFNVRIPRLLCASSPT
                  0 |.....|||.|||||||||.|||.|.|||||.||||||||||.|||.|||||..||||||
AI021773.         0 FRIQWSSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSPT

gi|157889        60 YESFWP 66
                 60 ..||.| 66
AI021773.        60 *LSFDP 66
""",
        )
        hsp = hit[4]
        self.assertAlmostEqual(hsp.score, 133.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 63.8419)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.65511e-42)
        self.assertEqual(hsp.annotations["identity"], 26)
        self.assertEqual(hsp.annotations["positive"], 29)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:65..172)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('FWPMPTITP*CLGRPTIEGNTARGASSPAKPALHIP')"
        )
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1578896738|gb|MK210584.1|:45..152)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "F P+PTITP*C GRPT+EGNTA GASSPA P+   P"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 FWPMPTITP*CLGRPTIEGNTARGASSPAKPALHIP 36
                  0 |.|.|||||||.||||.|||||.||||||.|....| 36
AI021773.         0 F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP 36
""",
        )
        hsp = hit[5]
        self.assertAlmostEqual(hsp.score, 87.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 42.7643)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.65511e-42)
        self.assertEqual(hsp.annotations["identity"], 18)
        self.assertEqual(hsp.annotations["positive"], 18)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 19],
                          [ 0, 19]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 19))
        self.assertEqual(repr(hsp.query.seq), "Seq('PALHIPDPLSTTRA*TSSS')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(19))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:25..81)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('PALHIPDPLSTTRAATSSS')")
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1578896738|gb|MK210584.1|:6..62)",
        )
        self.assertEqual(hsp.annotations["midline"], "PALHIPDPLSTTRA TSSS")
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 PALHIPDPLSTTRAATSSS 19
                  0 ||||||||||||||.|||| 19
AI021773.         0 PALHIPDPLSTTRA*TSSS 19
""",
        )
        hsp = hit[6]
        self.assertAlmostEqual(hsp.score, 139.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 66.5912)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.17801e-21)
        self.assertEqual(hsp.annotations["identity"], 26)
        self.assertEqual(hsp.annotations["positive"], 40)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 55],
                          [ 0, 55]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 55))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('LGQQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDV')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(55))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:179..343)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('LGQQHWVLLGGNSKFIVEGVVPDLLHIVPVCDDSMLNGVLQCEDTSLALCFVSYV')",
        )
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1578896738|gb|MK210584.1|:160..324)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "LGQQ  V    +++FIVE V+PDLLH++PV  +++ + V QCE+T+  LCF++ V",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 LGQQHWVLLGGNSKFIVEGVVPDLLHIVPVCDDSMLNGVLQCEDTSLALCFVSYV 55
                  0 ||||..|.......||||.|.|||||..||........|.|||.|...|||...| 55
AI021773.         0 LGQQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDV 55
""",
        )
        hsp = hit[7]
        self.assertAlmostEqual(hsp.score, 102.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 49.6374)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.17801e-21)
        self.assertEqual(hsp.annotations["identity"], 17)
        self.assertEqual(hsp.annotations["positive"], 25)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 33],
                          [ 0, 33]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 33))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('LLTHTNHHTLMSRSSNDGREYCSWCIITSESQL')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(33))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:75..173)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('LLAHADHHTLMPWAADDRREHGAWCIVTGEASL')"
        )
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1578896738|gb|MK210584.1|:55..153)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "LL H +HHTLM  +++D RE+ +WCI+T E+ L"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 LLAHADHHTLMPWAADDRREHGAWCIVTGEASL 33
                  0 ||.|..|||||.....|.||...|||.|.|..| 33
AI021773.         0 LLTHTNHHTLMSRSSNDGREYCSWCIITSESQL 33
""",
        )
        hsp = hit[8]
        self.assertAlmostEqual(hsp.score, 66.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 33.1419)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.17801e-21)
        self.assertEqual(hsp.annotations["identity"], 13)
        self.assertEqual(hsp.annotations["positive"], 15)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 20],
                          [ 0, 20]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 20))
        self.assertEqual(repr(hsp.query.seq), "Seq('SFAHP*SIINNEGLNFFVGH')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(20))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:20..79)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('SLAHTRSIVDNEGSNFFVTH')")
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1578896738|gb|MK210584.1|:1..60)",
        )
        self.assertEqual(hsp.annotations["midline"], "S AH  SI++NEG NFFV H")
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 SLAHTRSIVDNEGSNFFVTH 20
                  0 |.||..||..|||.||||.| 20
AI021773.         0 SFAHP*SIINNEGLNFFVGH 20
""",
        )
        hsp = hit[9]
        self.assertAlmostEqual(hsp.score, 106.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 51.4703)
        self.assertAlmostEqual(hsp.annotations["evalue"], 6.47459e-10)
        self.assertEqual(hsp.annotations["identity"], 27)
        self.assertEqual(hsp.annotations["positive"], 35)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 64],
                          [ 0, 64]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 64))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('KRQLRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPC...YPK')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(64))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:169..360")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('KGLIRRRRSTKQARYPHIEVPH*AWNRHKLGRYGEDLAPHLLQ*TSSCPRGAPS...QPK')",
        )
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1578896738|gb|MK210584.1|:150..341"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "K  +RR  ST +  Y H E+P+      +LG +GEDLA H+LQ* +   R  P  VDR    PK",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 KGLIRRRRSTKQARYPHIEVPH*AWNRHKLGRYGEDLAPHLLQ*TSSCPRGAPSAVDRGS
                  0 |...||..||....|.|.|.|........||..|||||.|.|||.....|..|..|||..
AI021773.         0 KRQLRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAP

gi|157889        60 TQPK 64
                 60 ..|| 64
AI021773.        60 LYPK 64
""",
        )
        hsp = hit[10]
        self.assertAlmostEqual(hsp.score, 59.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 29.9345)
        self.assertAlmostEqual(hsp.annotations["evalue"], 6.47459e-10)
        self.assertEqual(hsp.annotations["identity"], 13)
        self.assertEqual(hsp.annotations["positive"], 16)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 30],
                          [ 0, 30]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 30))
        self.assertEqual(repr(hsp.query.seq), "Seq('IRW**CTKSSIPFHRWTTSTSRCDGWYGSK')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(30))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:83..172")
        self.assertEqual(repr(hsp.target.seq), "Seq('LRR*RCTTRRVPFDRRPPKASGCDGRHGPK')")
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1578896738|gb|MK210584.1|:63..152"
        )
        self.assertEqual(hsp.annotations["midline"], "+R * CT   +PF R     S CDG +G K")
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 LRR*RCTTRRVPFDRRPPKASGCDGRHGPK 30
                  0 .|.|.||....||.|.....|.|||..|.| 30
AI021773.         0 IRW**CTKSSIPFHRWTTSTSRCDGWYGSK 30
""",
        )
        hsp = hit[11]
        self.assertAlmostEqual(hsp.score, 54.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 27.6434)
        self.assertAlmostEqual(hsp.annotations["evalue"], 6.47459e-10)
        self.assertEqual(hsp.annotations["identity"], 11)
        self.assertEqual(hsp.annotations["positive"], 11)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 18],
                          [ 0, 18]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 18))
        self.assertEqual(repr(hsp.query.seq), "Seq('RRSSSPRC**WIRDVQSW')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(18))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:28..81")
        self.assertEqual(repr(hsp.target.seq), "Seq('RRSCCPRCRQWIWYVQGW')")
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1578896738|gb|MK210584.1|:9..62"
        )
        self.assertEqual(hsp.annotations["midline"], "RRS  PRC  WI  VQ W")
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 RRSCCPRCRQWIWYVQGW 18
                  0 |||..|||..||..||.| 18
AI021773.         0 RRSSSPRC**WIRDVQSW 18
""",
        )
        hsp = hit[12]
        self.assertAlmostEqual(hsp.score, 100.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 48.721)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.54954e-08)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 58],
                          [ 0, 58]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 58))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('QKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLSC*P')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(58))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:168..341")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('KRTHT*ETKHKASEVSSH*STPLSMESSQTGTIWRRSGTTPSTMNFELPPRSTQCC*P')",
        )
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1578896738|gb|MK210584.1|:149..322"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "++T T   KH  + V SH*+T  +    +TG  WRRSG T STMN     ++T  C*P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 KRTHT*ETKHKASEVSSH*STPLSMESSQTGTIWRRSGTTPSTMNFELPPRSTQCC*P 58
                  0 ..|.|...||....|.|||.|........||..|||||.|.||||.......|..||| 58
AI021773.         0 QKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLSC*P 58
""",
        )
        hsp = hit[13]
        self.assertAlmostEqual(hsp.score, 55.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 28.1016)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.54954e-08)
        self.assertEqual(hsp.annotations["identity"], 14)
        self.assertEqual(hsp.annotations["positive"], 15)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 30],
                          [ 0, 30]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 30))
        self.assertEqual(repr(hsp.query.seq), "Seq('SLVMMHQEQYSLPSLDDLDIKV*WLVWVKR')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(30))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:85..174")
        self.assertEqual(repr(hsp.target.seq), "Seq('SPVTMHHAPCSLRSSAAQGIRV*WSAWAKR')")
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1578896738|gb|MK210584.1|:65..154"
        )
        self.assertEqual(hsp.annotations["midline"], "S V MH    SL S     I+V*W  W KR")
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 SPVTMHHAPCSLRSSAAQGIRV*WSAWAKR 30
                  0 |.|.||....||.|.....|.|||..|.|| 30
AI021773.         0 SLVMMHQEQYSLPSLDDLDIKV*WLVWVKR 30
""",
        )
        hsp = hit[14]
        self.assertAlmostEqual(hsp.score, 50.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 25.8106)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.54954e-08)
        self.assertEqual(hsp.annotations["identity"], 11)
        self.assertEqual(hsp.annotations["positive"], 12)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 18],
                          [ 0, 18]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 18))
        self.assertEqual(repr(hsp.query.seq), "Seq('TKKFKPSLLIMDQGCAKL')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(18))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:27..80")
        self.assertEqual(repr(hsp.target.seq), "Seq('TKKLLPSLSTMDLVCARL')")
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1578896738|gb|MK210584.1|:8..61"
        )
        self.assertEqual(hsp.annotations["midline"], "TKK  PSL  MD  CA+L")
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 TKKLLPSLSTMDLVCARL 18
                  0 |||..|||..||..||.| 18
AI021773.         0 TKKFKPSLLIMDQGCAKL 18
""",
        )
        hsp = hit[15]
        self.assertAlmostEqual(hsp.score, 88.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 43.2225)
        self.assertAlmostEqual(hsp.annotations["evalue"], 6.15961e-08)
        self.assertEqual(hsp.annotations["identity"], 21)
        self.assertEqual(hsp.annotations["positive"], 26)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 50],
                          [ 0, 50]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 50))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('RSTGQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLGISV*EYHVSIVL')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(50))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:192..341)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('RSTALGAPRGQLEVHCRRCGARSSPYRPSL*RFHAQWGTSM*GYLACFVL')",
        )
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1578896738|gb|MK210584.1|:173..322)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "RST  G       +HCR C ARSSP  PS  ++  + G S+* Y    VL",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 RSTALGAPRGQLEVHCRRCGARSSPYRPSL*RFHAQWGTSM*GYLACFVL 50
                  0 |||..|........|||.|.|||||..||........|.|.|.|....|| 50
AI021773.         0 RSTGQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLGISV*EYHVSIVL 50
""",
        )
        hsp = hit[16]
        self.assertAlmostEqual(hsp.score, 60.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 30.3927)
        self.assertAlmostEqual(hsp.annotations["evalue"], 6.15961e-08)
        self.assertEqual(hsp.annotations["identity"], 13)
        self.assertEqual(hsp.annotations["positive"], 17)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 29],
                          [ 0, 29]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 29))
        self.assertEqual(repr(hsp.query.seq), "Seq('FDPYQPSHLDVEVVQRWKGILLLVHHHQR')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(29))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:85..171)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('FGPCRPSHPDALGGRRSKGTRRVVHRHRR')")
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1578896738|gb|MK210584.1|:65..151)",
        )
        self.assertEqual(hsp.annotations["midline"], "F P +PSH D    +R KG   +VH H+R")
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 FGPCRPSHPDALGGRRSKGTRRVVHRHRR 29
                  0 |.|..|||.|.....|.||....||.|.| 29
AI021773.         0 FDPYQPSHLDVEVVQRWKGILLLVHHHQR 29
""",
        )
        hsp = hit[17]
        self.assertAlmostEqual(hsp.score, 56.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 28.5598)
        self.assertAlmostEqual(hsp.annotations["evalue"], 6.15961e-08)
        self.assertEqual(hsp.annotations["identity"], 12)
        self.assertEqual(hsp.annotations["positive"], 14)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 19],
                          [ 0, 19]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 19))
        self.assertEqual(repr(hsp.query.seq), "Seq('SQLCTSLIHYQQRGLELLR')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(19))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:27..83)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('SQPCTYQIHCRQRGQQLLR')")
        self.assertEqual(hsp.target.id, "gi|1578896738|gb|MK210584.1|")
        self.assertEqual(hsp.target.name, "MK210584")
        self.assertEqual(
            hsp.target.description, "Hermetia illucens beta-actin mRNA, complete cds"
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1131))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1578896738|gb|MK210584.1|:8..64)",
        )
        self.assertEqual(hsp.annotations["midline"], "SQ CT  IH +QRG +LLR")
        self.assertEqual(
            str(hsp),
            """\
gi|157889         0 SQPCTYQIHCRQRGQQLLR 19
                  0 ||.||..||..|||..||| 19
AI021773.         0 SQLCTSLIHYQQRGLELLR 19
""",
        )
        hit = record[6]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hit.target.name, "XM_007065846")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1782)")
        self.assertEqual(len(hit), 16)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 325.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 151.818)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.22999e-61)
        self.assertEqual(hsp.annotations["identity"], 59)
        self.assertEqual(hsp.annotations["positive"], 59)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:164..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561747529|ref|XM_007065846.2|:180..359"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE
                  0 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
AI021773.         0 GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE

gi|156174        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 174.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 82.6285)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.22999e-61)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:66..173")
        self.assertEqual(
            repr(hsp.target.seq), "Seq('GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561747529|ref|XM_007065846.2|:81..188"
        )
        self.assertEqual(
            hsp.annotations["midline"], "G  K GFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
                  0 |..|.||||||||||||||||||||||||||||||| 36
AI021773.         0 GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
""",
        )
        hsp = hit[2]
        self.assertAlmostEqual(hsp.score, 101.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 49.1792)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.22999e-61)
        self.assertEqual(hsp.annotations["identity"], 20)
        self.assertEqual(hsp.annotations["positive"], 21)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 23],
                          [ 0, 23]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 23))
        self.assertEqual(repr(hsp.query.seq), "Seq('IIMADEEVQALVVDNGSGMCKAG')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(23))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:14..82")
        self.assertEqual(repr(hsp.target.seq), "Seq('IKMADEEIAALVVDNGSGMCKAG')")
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561747529|ref|XM_007065846.2|:30..98"
        )
        self.assertEqual(hsp.annotations["midline"], "I MADEE+ ALVVDNGSGMCKAG")
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 IKMADEEIAALVVDNGSGMCKAG 23
                  0 |.|||||..|||||||||||||| 23
AI021773.         0 IIMADEEVQALVVDNGSGMCKAG 23
""",
        )
        hsp = hit[3]
        self.assertAlmostEqual(hsp.score, 218.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 102.79)
        self.assertAlmostEqual(hsp.annotations["evalue"], 6.84013e-40)
        self.assertEqual(hsp.annotations["identity"], 46)
        self.assertEqual(hsp.annotations["positive"], 52)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 61],
                          [ 0, 61]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 61))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('SSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSP...FDP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(61))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:163..345)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('ASVSRTGCSSGATRSSL*KVWCQIFSMSSQLVTMPCSMGYFRVRMPLLL*ASSP...FCP')",
        )
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561747529|ref|XM_007065846.2|:179..361)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+SV+RTGCSSGATR+SL* V CQIFSMSSQ VT+PCS+GYF VR+P    ASSPT*LSF P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 ASVSRTGCSSGATRSSL*KVWCQIFSMSSQLVTMPCSMGYFRVRMPLLL*ASSPT*LSFC
                  0 .||.||||||||||.|||.|.|||||||||.||.|||.|||.||.|....|||||||||.
AI021773.         0 SSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSPT*LSFD

gi|156174        60 P 61
                 60 | 61
AI021773.        60 P 61
""",
        )
        hsp = hit[4]
        self.assertAlmostEqual(hsp.score, 135.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 64.7583)
        self.assertAlmostEqual(hsp.annotations["evalue"], 6.84013e-40)
        self.assertEqual(hsp.annotations["identity"], 26)
        self.assertEqual(hsp.annotations["positive"], 29)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:65..172)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('FCPMPTMTPWCLGRPTMEGNTARGASSPANPALHIP')"
        )
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561747529|ref|XM_007065846.2|:80..187)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "F P+PT+TP C GRPTMEGNTA GASSPANP+   P"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 FCPMPTMTPWCLGRPTMEGNTARGASSPANPALHIP 36
                  0 |.|.||.||.|.||||||||||.||||||||....| 36
AI021773.         0 F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP 36
""",
        )
        hsp = hit[5]
        self.assertAlmostEqual(hsp.score, 89.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 43.6807)
        self.assertAlmostEqual(hsp.annotations["evalue"], 6.84013e-40)
        self.assertEqual(hsp.annotations["identity"], 15)
        self.assertEqual(hsp.annotations["positive"], 20)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 24],
                          [ 0, 24]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 24))
        self.assertEqual(repr(hsp.query.seq), "Seq('PANPSFAHP*SIINNEGLNFFVGH')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(24))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:20..91)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('PSKSSFAHPGAIVNNEGGDFFIGH')")
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561747529|ref|XM_007065846.2|:36..107)",
        )
        self.assertEqual(hsp.annotations["midline"], "P+  SFAHP +I+NNEG +FF+GH")
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 PSKSSFAHPGAIVNNEGGDFFIGH 24
                  0 |...|||||..|.||||..||.|| 24
AI021773.         0 PANPSFAHP*SIINNEGLNFFVGH 24
""",
        )
        hsp = hit[6]
        self.assertAlmostEqual(hsp.score, 124.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 59.718)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.64948e-16)
        self.assertEqual(hsp.annotations["identity"], 27)
        self.assertEqual(hsp.annotations["positive"], 35)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 58],
                          [ 0, 58]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 58))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('QQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF*P')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(58))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:164..337)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('EQDRVLLRGNPQLIVESVVPDLLHVIPVGDNAMLNGILQGEDASLALSLIAHVAVLLP')",
        )
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561747529|ref|XM_007065846.2|:180..353)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+QDRV    + Q IVE V+PDLLHVIPV  N + + + Q E+ +  L  I  VAV  P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 EQDRVLLRGNPQLIVESVVPDLLHVIPVGDNAMLNGILQGEDASLALSLIAHVAVLLP 58
                  0 .||||......|.|||.|.|||||||||..|.......|.|.....|..|..|||..| 58
AI021773.         0 QQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF*P 58
""",
        )
        hsp = hit[7]
        self.assertAlmostEqual(hsp.score, 88.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 43.2225)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.64948e-16)
        self.assertEqual(hsp.annotations["identity"], 18)
        self.assertEqual(hsp.annotations["positive"], 21)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 23],
                          [ 0, 23]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 23))
        self.assertEqual(repr(hsp.query.seq), "Seq('PALHIPDPLSTTRA*TSSSAMII')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(23))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:13..81)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('PALHIPEPLSTTRAAISSSAILI')")
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561747529|ref|XM_007065846.2|:29..97)",
        )
        self.assertEqual(hsp.annotations["midline"], "PALHIP+PLSTTRA  SSSA++I")
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 PALHIPEPLSTTRAAISSSAILI 23
                  0 ||||||.|||||||..||||..| 23
AI021773.         0 PALHIPDPLSTTRA*TSSSAMII 23
""",
        )
        hsp = hit[8]
        self.assertAlmostEqual(hsp.score, 55.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 28.1016)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.64948e-16)
        self.assertEqual(hsp.annotations["identity"], 13)
        self.assertEqual(hsp.annotations["positive"], 14)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 28],
                          [ 0, 28]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 28))
        self.assertEqual(repr(hsp.query.seq), "Seq('PYQPSHLDVEVVQRWKGILLLVHHHQRI')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(28))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:82..165)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('PCPP*HPGAWGVPRWKGTRLEEHHPQQI')")
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561747529|ref|XM_007065846.2|:97..180)",
        )
        self.assertEqual(hsp.annotations["midline"], "P  P H     V RWKG  L  HH Q+I")
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 PCPP*HPGAWGVPRWKGTRLEEHHPQQI 28
                  0 |..|.|.....|.||||..|..||.|.| 28
AI021773.         0 PYQPSHLDVEVVQRWKGILLLVHHHQRI 28
""",
        )
        hsp = hit[9]
        self.assertAlmostEqual(hsp.score, 109.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 52.8449)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.27725e-15)
        self.assertEqual(hsp.annotations["identity"], 26)
        self.assertEqual(hsp.annotations["positive"], 34)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 57],
                          [ 0, 57]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 57))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GQKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLSC')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(57))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:165..335")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GRRTATWAMRLRAREASSP*SIPLSMALSPTGMTWRRSGTTLSTMSCGLPLRSTLSC')",
        )
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561747529|ref|XM_007065846.2|:181..351"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G++TAT  M+       S *+   +  L  TGMTWRRSG T STM+C    ++TLSC",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 GRRTATWAMRLRAREASSP*SIPLSMALSPTGMTWRRSGTTLSTMSCGLPLRSTLSC 57
                  0 |..|||..|........|.|.......|..|||||||||.|.|||.|......|||| 57
AI021773.         0 GQKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLSC 57
""",
        )
        hsp = hit[10]
        self.assertAlmostEqual(hsp.score, 78.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 38.6404)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.27725e-15)
        self.assertEqual(hsp.annotations["identity"], 14)
        self.assertEqual(hsp.annotations["positive"], 17)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 21],
                          [ 0, 21]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 21))
        self.assertEqual(repr(hsp.query.seq), "Seq('HGRRRSSSPRC**WIRDVQSW')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(21))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:19..81")
        self.assertEqual(repr(hsp.target.seq), "Seq('NGR*RNRRPRC*QWLRDVQSW')")
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561747529|ref|XM_007065846.2|:35..97"
        )
        self.assertEqual(hsp.annotations["midline"], "+GR R+  PRC* W+RDVQSW")
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 NGR*RNRRPRC*QWLRDVQSW 21
                  0 .||.|...||||.|.|||||| 21
AI021773.         0 HGRRRSSSPRC**WIRDVQSW 21
""",
        )
        hsp = hit[11]
        self.assertAlmostEqual(hsp.score, 73.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 36.3494)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.27725e-15)
        self.assertEqual(hsp.annotations["identity"], 14)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 35],
                          [ 0, 35]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 35))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('IRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSYVG')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(35))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:83..187")
        self.assertEqual(
            repr(hsp.target.seq), "Seq('ICWG*CSSSRVPFHRGTPQAPGCHGGHGAEGQLRG')"
        )
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561747529|ref|XM_007065846.2|:98..202"
        )
        self.assertEqual(
            hsp.annotations["midline"], "I W *C+ S +PFHR T     C G +G++    G"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 ICWG*CSSSRVPFHRGTPQAPGCHGGHGAEGQLRG 35
                  0 |.|.||..|..||||.|.....|.|..|......| 35
AI021773.         0 IRW**CTKSSIPFHRWTTSTSRCDGWYGSKDSYVG 35
""",
        )
        hsp = hit[12]
        self.assertAlmostEqual(hsp.score, 103.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 50.0956)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.1515e-08)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 58],
                          [ 0, 58]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 58))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('QLRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(58))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:175..348")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('QLRGR*GSEQERHPHPEVSH*AWHCHQLG*HGEDLAPHFLQ*AAGCP*GAPCPAH*SP')",
        )
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561747529|ref|XM_007065846.2|:191..364"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "QLR  * + +  + H E+ +   +C +LG*HGEDLA H LQ* A      PCP   +P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 QLRGR*GSEQERHPHPEVSH*AWHCHQLG*HGEDLAPHFLQ*AAGCP*GAPCPAH*SP 58
                  0 |||..|........|.|.......|..|||||||||.|.|||.|......|||....| 58
AI021773.         0 QLRR**STIETWYSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAP 58
""",
        )
        hsp = hit[13]
        self.assertAlmostEqual(hsp.score, 76.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 37.724)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.1515e-08)
        self.assertEqual(hsp.annotations["identity"], 15)
        self.assertEqual(hsp.annotations["positive"], 15)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 24],
                          [ 0, 24]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 24))
        self.assertEqual(repr(hsp.query.seq), "Seq('WPTKKFKPSLLIMDQGCAKLGFAG')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(24))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:21..92")
        self.assertEqual(repr(hsp.target.seq), "Seq('WPMKKSPPSLLTMAPGCAKLDLLG')")
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561747529|ref|XM_007065846.2|:37..108"
        )
        self.assertEqual(hsp.annotations["midline"], "WP KK  PSLL M  GCAKL   G")
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 WPMKKSPPSLLTMAPGCAKLDLLG 24
                  0 ||.||..||||.|..|||||...| 24
AI021773.         0 WPTKKFKPSLLIMDQGCAKLGFAG 24
""",
        )
        hsp = hit[14]
        self.assertAlmostEqual(hsp.score, 93.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 45.5136)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.85196e-05)
        self.assertEqual(hsp.annotations["identity"], 18)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 31],
                          [ 0, 31]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 31))
        self.assertEqual(repr(hsp.query.seq), "Seq('GARSTGQGVLLEPHAIHCRMCDARSSPCHPS')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(31))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:255..347)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('GLQ*AGQGAPQGQPAAHCRKCGARSSPCHPS')")
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561747529|ref|XM_007065846.2|:271..363)",
        )
        self.assertEqual(hsp.annotations["midline"], "G +  GQG      A HCR C ARSSPCHPS")
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 GLQ*AGQGAPQGQPAAHCRKCGARSSPCHPS 31
                  0 |....|||......|.|||.|.||||||||| 31
AI021773.         0 GARSTGQGVLLEPHAIHCRMCDARSSPCHPS 31
""",
        )
        hsp = hit[15]
        self.assertAlmostEqual(hsp.score, 64.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 32.2255)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.85196e-05)
        self.assertEqual(hsp.annotations["identity"], 13)
        self.assertEqual(hsp.annotations["positive"], 13)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 20],
                          [ 0, 20]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 20))
        self.assertEqual(repr(hsp.query.seq), "Seq('QLCTSLIHYQQRGLELLRRP')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(20))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:21..80)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('QLCTSRSHCQQRGRRFLHRP')")
        self.assertEqual(hsp.target.id, "gi|1561747529|ref|XM_007065846.2|")
        self.assertEqual(hsp.target.name, "XM_007065846")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Chelonia mydas actin, cytoplasmic type 5 (LOC102932532), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1782))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561747529|ref|XM_007065846.2|:37..96)",
        )
        self.assertEqual(hsp.annotations["midline"], "QLCTS  H QQRG   L RP")
        self.assertEqual(
            str(hsp),
            """\
gi|156174         0 QLCTSRSHCQQRGRRFLHRP 20
                  0 |||||..|.||||...|.|| 20
AI021773.         0 QLCTSLIHYQQRGLELLRRP 20
""",
        )
        hit = record[7]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1561874797|ref|XM_027858255.1|")
        self.assertEqual(hit.target.name, "XM_027858255")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: Vombatus ursinus actin, cytoplasmic type 5 (LOC114040221), mRNA",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1604)")
        self.assertEqual(len(hit), 11)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 325.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 151.818)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.0561e-61)
        self.assertEqual(hsp.annotations["identity"], 59)
        self.assertEqual(hsp.annotations["positive"], 59)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:164..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.target.id, "gi|1561874797|ref|XM_027858255.1|")
        self.assertEqual(hsp.target.name, "XM_027858255")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Vombatus ursinus actin, cytoplasmic type 5 (LOC114040221), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1604))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561874797|ref|XM_027858255.1|:255..434"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156187         0 GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE
                  0 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
AI021773.         0 GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE

gi|156187        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 174.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 82.6285)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.0561e-61)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:66..173")
        self.assertEqual(
            repr(hsp.target.seq), "Seq('GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.target.id, "gi|1561874797|ref|XM_027858255.1|")
        self.assertEqual(hsp.target.name, "XM_027858255")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Vombatus ursinus actin, cytoplasmic type 5 (LOC114040221), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1604))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561874797|ref|XM_027858255.1|:156..263"
        )
        self.assertEqual(
            hsp.annotations["midline"], "G  K GFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156187         0 GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
                  0 |..|.||||||||||||||||||||||||||||||| 36
AI021773.         0 GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
""",
        )
        hsp = hit[2]
        self.assertAlmostEqual(hsp.score, 100.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 48.721)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.0561e-61)
        self.assertEqual(hsp.annotations["identity"], 19)
        self.assertEqual(hsp.annotations["positive"], 20)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 21],
                          [ 0, 21]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 21))
        self.assertEqual(repr(hsp.query.seq), "Seq('MADEEVQALVVDNGSGMCKAG')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(21))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..82")
        self.assertEqual(repr(hsp.target.seq), "Seq('MADEEIAALVVDNGSGMCKAG')")
        self.assertEqual(hsp.target.id, "gi|1561874797|ref|XM_027858255.1|")
        self.assertEqual(hsp.target.name, "XM_027858255")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Vombatus ursinus actin, cytoplasmic type 5 (LOC114040221), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1604))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561874797|ref|XM_027858255.1|:111..173"
        )
        self.assertEqual(hsp.annotations["midline"], "MADEE+ ALVVDNGSGMCKAG")
        self.assertEqual(
            str(hsp),
            """\
gi|156187         0 MADEEIAALVVDNGSGMCKAG 21
                  0 |||||..|||||||||||||| 21
AI021773.         0 MADEEVQALVVDNGSGMCKAG 21
""",
        )
        hsp = hit[3]
        self.assertAlmostEqual(hsp.score, 222.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 104.622)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.13783e-38)
        self.assertEqual(hsp.annotations["identity"], 48)
        self.assertEqual(hsp.annotations["positive"], 53)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 66],
                          [ 0, 66]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 66))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('FRIQWSSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFD...FDP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(66))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:163..360)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('FGFRGASVSRTGCSSGATLSSL*KVWCQIFSMSSQLVTIPCSIGYFRVRMPLLL...FCP')",
        )
        self.assertEqual(hsp.target.id, "gi|1561874797|ref|XM_027858255.1|")
        self.assertEqual(hsp.target.name, "XM_027858255")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Vombatus ursinus actin, cytoplasmic type 5 (LOC114040221), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1604))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561874797|ref|XM_027858255.1|:254..451)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "F  + +SV+RTGCSSGAT +SL* V CQIFSMSSQ VTIPCSIGYF VR+P    ASSPT*LSF P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156187         0 FGFRGASVSRTGCSSGATLSSL*KVWCQIFSMSSQLVTIPCSIGYFRVRMPLLLWASSPT
                  0 |.....||.|||||||||..|||.|.|||||||||.||||||||||.||.|....|||||
AI021773.         0 FRIQWSSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSPT

gi|156187        60 *LSFCP 66
                 60 ||||.| 66
AI021773.        60 *LSFDP 66
""",
        )
        hsp = hit[4]
        self.assertAlmostEqual(hsp.score, 130.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 62.4673)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.13783e-38)
        self.assertEqual(hsp.annotations["identity"], 25)
        self.assertEqual(hsp.annotations["positive"], 28)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:65..172)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('FCPMPTMTPWCLGRPTMEGNTARGASSPAKPALHMP')"
        )
        self.assertEqual(hsp.target.id, "gi|1561874797|ref|XM_027858255.1|")
        self.assertEqual(hsp.target.name, "XM_027858255")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Vombatus ursinus actin, cytoplasmic type 5 (LOC114040221), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1604))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561874797|ref|XM_027858255.1|:155..262)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "F P+PT+TP C GRPTMEGNTA GASSPA P+   P"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156187         0 FCPMPTMTPWCLGRPTMEGNTARGASSPAKPALHMP 36
                  0 |.|.||.||.|.||||||||||.||||||.|....| 36
AI021773.         0 F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP 36
""",
        )
        hsp = hit[5]
        self.assertAlmostEqual(hsp.score, 81.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 40.0151)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.13783e-38)
        self.assertEqual(hsp.annotations["identity"], 16)
        self.assertEqual(hsp.annotations["positive"], 20)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 22],
                          [ 0, 22]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 22))
        self.assertEqual(repr(hsp.query.seq), "Seq('PALHIPDPLSTTRA*TSSSAMI')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(22))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:16..81)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('PALHMPEPLSTTRAAISSSAIL')")
        self.assertEqual(hsp.target.id, "gi|1561874797|ref|XM_027858255.1|")
        self.assertEqual(hsp.target.name, "XM_027858255")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Vombatus ursinus actin, cytoplasmic type 5 (LOC114040221), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1604))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561874797|ref|XM_027858255.1|:107..172)",
        )
        self.assertEqual(hsp.annotations["midline"], "PALH+P+PLSTTRA  SSSA++")
        self.assertEqual(
            str(hsp),
            """\
gi|156187         0 PALHMPEPLSTTRAAISSSAIL 22
                  0 ||||.|.|||||||..||||.. 22
AI021773.         0 PALHIPDPLSTTRA*TSSSAMI 22
""",
        )
        hsp = hit[6]
        self.assertAlmostEqual(hsp.score, 143.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 68.424)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.89102e-12)
        self.assertEqual(hsp.annotations["identity"], 24)
        self.assertEqual(hsp.annotations["positive"], 38)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 58],
                          [ 0, 58]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 58))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('QQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF*P')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(58))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:164..337)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('EQNRVLLWGYSELVVESVVPDFFHVIPVGDNTMLNWILQGKDAPFTLGLITHIAILLP')",
        )
        self.assertEqual(hsp.target.id, "gi|1561874797|ref|XM_027858255.1|")
        self.assertEqual(hsp.target.name, "XM_027858255")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Vombatus ursinus actin, cytoplasmic type 5 (LOC114040221), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1604))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561874797|ref|XM_027858255.1|:255..428)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+Q+RV  W +++ +VE V+PD  HVIPV  NT+ +W+ Q ++  F L  IT +A+  P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156187         0 EQNRVLLWGYSELVVESVVPDFFHVIPVGDNTMLNWILQGKDAPFTLGLITHIAILLP 58
                  0 .|.||..|......||.|.||..|||||..||...|..|.....|.|..||..|...| 58
AI021773.         0 QQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF*P 58
""",
        )
        hsp = hit[7]
        self.assertAlmostEqual(hsp.score, 61.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 30.8509)
        self.assertAlmostEqual(hsp.annotations["evalue"], 4.89102e-12)
        self.assertEqual(hsp.annotations["identity"], 12)
        self.assertEqual(hsp.annotations["positive"], 22)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 33],
                          [ 0, 33]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 33))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('LLTHTNHHTLMSRSSNDGREYCSWCIITSESQL')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(33))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:75..173)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('LLPHANHDSLVPGATHDGRKHSPRGIISGKASL')"
        )
        self.assertEqual(hsp.target.id, "gi|1561874797|ref|XM_027858255.1|")
        self.assertEqual(hsp.target.name, "XM_027858255")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Vombatus ursinus actin, cytoplasmic type 5 (LOC114040221), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1604))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561874797|ref|XM_027858255.1|:165..263)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "LL H NH +L+  +++DGR++    II+ ++ L"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156187         0 LLPHANHDSLVPGATHDGRKHSPRGIISGKASL 33
                  0 ||.|.||..|......|||......||.....| 33
AI021773.         0 LLTHTNHHTLMSRSSNDGREYCSWCIITSESQL 33
""",
        )
        hsp = hit[8]
        self.assertAlmostEqual(hsp.score, 98.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 47.8046)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.62741e-05)
        self.assertEqual(hsp.annotations["identity"], 20)
        self.assertEqual(hsp.annotations["positive"], 27)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 50],
                          [ 0, 50]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 50))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('YSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAPLYPK')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(50))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:211..360")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('HPYPEVSN*AWYCHQLG*HGKNLAPHFLQRAQSSPRGAPCSAHRSTSEPK')",
        )
        self.assertEqual(hsp.target.id, "gi|1561874797|ref|XM_027858255.1|")
        self.assertEqual(hsp.target.name, "XM_027858255")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Vombatus ursinus actin, cytoplasmic type 5 (LOC114040221), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1604))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561874797|ref|XM_027858255.1|:302..451"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+ + E+ N   YC +LG*HG++LA H LQ      R  PC   R+   PK",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156187         0 HPYPEVSN*AWYCHQLG*HGKNLAPHFLQRAQSSPRGAPCSAHRSTSEPK 50
                  0 ....|..|...||..|||||..||.|.||......|..||...|....|| 50
AI021773.         0 YSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAPLYPK 50
""",
        )
        hsp = hit[9]
        self.assertAlmostEqual(hsp.score, 56.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 28.5598)
        self.assertAlmostEqual(hsp.annotations["evalue"], 2.62741e-05)
        self.assertEqual(hsp.annotations["identity"], 9)
        self.assertEqual(hsp.annotations["positive"], 14)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 26],
                          [ 0, 26]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 26))
        self.assertEqual(repr(hsp.query.seq), "Seq('*CTKSSIPFHRWTTSTSRCDGWYGSK')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(26))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:95..172")
        self.assertEqual(repr(hsp.target.seq), "Seq('*CPSGCVSFHRGSPQAPRSHGWHGAE')")
        self.assertEqual(hsp.target.id, "gi|1561874797|ref|XM_027858255.1|")
        self.assertEqual(hsp.target.name, "XM_027858255")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Vombatus ursinus actin, cytoplasmic type 5 (LOC114040221), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1604))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561874797|ref|XM_027858255.1|:185..262"
        )
        self.assertEqual(hsp.annotations["midline"], "*C    + FHR +    R  GW+G++")
        self.assertEqual(
            str(hsp),
            """\
gi|156187         0 *CPSGCVSFHRGSPQAPRSHGWHGAE 26
                  0 ||......|||......|..||.|.. 26
AI021773.         0 *CTKSSIPFHRWTTSTSRCDGWYGSK 26
""",
        )
        hsp = hit[10]
        self.assertAlmostEqual(hsp.score, 81.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 40.0151)
        self.assertAlmostEqual(hsp.annotations["evalue"], 6.7728)
        self.assertEqual(hsp.annotations["identity"], 22)
        self.assertEqual(hsp.annotations["positive"], 32)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 57],
                          [ 0, 57]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 57))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GQKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLSC')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(57))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:165..335")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GRRIAMWVMRPRVKGASLP*SIQLSMVLSPTGMTWKKSGTTLSTTSSE*PQRSTLFC')",
        )
        self.assertEqual(hsp.target.id, "gi|1561874797|ref|XM_027858255.1|")
        self.assertEqual(hsp.target.name, "XM_027858255")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Vombatus ursinus actin, cytoplasmic type 5 (LOC114040221), mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1604))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561874797|ref|XM_027858255.1|:256..426"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G++ A  VM+         *+ Q + VL  TGMTW++SG T ST +    Q++TL C",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156187         0 GRRIAMWVMRPRVKGASLP*SIQLSMVLSPTGMTWKKSGTTLSTTSSE*PQRSTLFC 57
                  0 |...|..||..........|..|...||..|||||..||.|.||......|..||.| 57
AI021773.         0 GQKTATSVMKHNRNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLSC 57
""",
        )
        hit = record[8]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1561775767|ref|XM_027888585.1|")
        self.assertEqual(hit.target.name, "XM_027888585")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X1, mRNA",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1599)")
        self.assertEqual(len(hit), 10)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 325.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 151.818)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.05617e-61)
        self.assertEqual(hsp.annotations["identity"], 59)
        self.assertEqual(hsp.annotations["positive"], 59)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:164..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.target.id, "gi|1561775767|ref|XM_027888585.1|")
        self.assertEqual(hsp.target.name, "XM_027888585")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561775767|ref|XM_027888585.1|:268..447"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE
                  0 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
AI021773.         0 GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE

gi|156177        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 174.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 82.6285)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.05617e-61)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:66..173")
        self.assertEqual(
            repr(hsp.target.seq), "Seq('GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.target.id, "gi|1561775767|ref|XM_027888585.1|")
        self.assertEqual(hsp.target.name, "XM_027888585")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561775767|ref|XM_027888585.1|:169..276"
        )
        self.assertEqual(
            hsp.annotations["midline"], "G  K GFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
                  0 |..|.||||||||||||||||||||||||||||||| 36
AI021773.         0 GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
""",
        )
        hsp = hit[2]
        self.assertAlmostEqual(hsp.score, 100.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 48.721)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.05617e-61)
        self.assertEqual(hsp.annotations["identity"], 19)
        self.assertEqual(hsp.annotations["positive"], 20)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 21],
                          [ 0, 21]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 21))
        self.assertEqual(repr(hsp.query.seq), "Seq('MADEEVQALVVDNGSGMCKAG')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(21))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..82")
        self.assertEqual(repr(hsp.target.seq), "Seq('MADEEIAALVVDNGSGMCKAG')")
        self.assertEqual(hsp.target.id, "gi|1561775767|ref|XM_027888585.1|")
        self.assertEqual(hsp.target.name, "XM_027888585")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561775767|ref|XM_027888585.1|:124..186"
        )
        self.assertEqual(hsp.annotations["midline"], "MADEE+ ALVVDNGSGMCKAG")
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 MADEEIAALVVDNGSGMCKAG 21
                  0 |||||..|||||||||||||| 21
AI021773.         0 MADEEVQALVVDNGSGMCKAG 21
""",
        )
        hsp = hit[3]
        self.assertAlmostEqual(hsp.score, 225.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 105.997)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.43805e-40)
        self.assertEqual(hsp.annotations["identity"], 46)
        self.assertEqual(hsp.annotations["positive"], 54)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 64],
                          [ 0, 64]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 64))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('IQWSSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCA...FDP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(64))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:163..354)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('LRGASVSSTGCSSGATRSSL*KVWCQIFSMSSQLVTMPCSMGYLSVRMPLLLCA...FCP')",
        )
        self.assertEqual(hsp.target.id, "gi|1561775767|ref|XM_027888585.1|")
        self.assertEqual(hsp.target.name, "XM_027888585")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561775767|ref|XM_027888585.1|:267..458)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "++ +SV+ TGCSSGATR+SL* V CQIFSMSSQ VT+PCS+GY SVR+P   CASSPT*LSF P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 LRGASVSSTGCSSGATRSSL*KVWCQIFSMSSQLVTMPCSMGYLSVRMPLLLCASSPT*L
                  0 ....||..|||||||||.|||.|.|||||||||.||.|||.||.|||.|...||||||||
AI021773.         0 IQWSSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSPT*L

gi|156177        60 SFCP 64
                 60 ||.| 64
AI021773.        60 SFDP 64
""",
        )
        hsp = hit[4]
        self.assertAlmostEqual(hsp.score, 143.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 68.424)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.43805e-40)
        self.assertEqual(hsp.annotations["identity"], 27)
        self.assertEqual(hsp.annotations["positive"], 30)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:65..172)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('FCPMPTMTPWCRGRPTMEGNTARGASSPANPALHMP')"
        )
        self.assertEqual(hsp.target.id, "gi|1561775767|ref|XM_027888585.1|")
        self.assertEqual(hsp.target.name, "XM_027888585")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561775767|ref|XM_027888585.1|:168..275)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "F P+PT+TP CRGRPTMEGNTA GASSPANP+   P"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 FCPMPTMTPWCRGRPTMEGNTARGASSPANPALHMP 36
                  0 |.|.||.||.||||||||||||.||||||||....| 36
AI021773.         0 F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP 36
""",
        )
        hsp = hit[5]
        self.assertAlmostEqual(hsp.score, 79.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 39.0986)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.43805e-40)
        self.assertEqual(hsp.annotations["identity"], 16)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 21],
                          [ 0, 21]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 21))
        self.assertEqual(repr(hsp.query.seq), "Seq('PALHIPDPLSTTRA*TSSSAM')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(21))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:19..81)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('PALHMPEPLSTTRAAISSSAI')")
        self.assertEqual(hsp.target.id, "gi|1561775767|ref|XM_027888585.1|")
        self.assertEqual(hsp.target.name, "XM_027888585")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561775767|ref|XM_027888585.1|:123..185)",
        )
        self.assertEqual(hsp.annotations["midline"], "PALH+P+PLSTTRA  SSSA+")
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 PALHMPEPLSTTRAAISSSAI 21
                  0 ||||.|.|||||||..||||. 21
AI021773.         0 PALHIPDPLSTTRA*TSSSAM 21
""",
        )
        hsp = hit[6]
        self.assertAlmostEqual(hsp.score, 141.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 67.5076)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.58672e-08)
        self.assertEqual(hsp.annotations["identity"], 35)
        self.assertEqual(hsp.annotations["positive"], 48)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 107],
                          [  0, 107]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('WPTKKFKPSLLIMDQGCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKTAT...C*P')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(107))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:21..341")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('WRTRRSLPWWWTTARACARRGSQGMTRPAPCSPPSWGGPGTRASWWAWGRRTAT...CSP')",
        )
        self.assertEqual(hsp.target.id, "gi|1561775767|ref|XM_027888585.1|")
        self.assertEqual(hsp.target.name, "XM_027888585")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561775767|ref|XM_027888585.1|:125..445"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "W T++  P      + CA+ G  G   P    P   G P  +      G++TAT   +       S  +T S+T    TG TWRRSG T ST +C W  ++T  C P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 WRTRRSLPWWWTTARACARRGSQGMTRPAPCSPPSWGGPGTRASWWAWGRRTATWGTRRR
                  0 |.|....|........||..|..|...|....|...|.|.........|..|||......
AI021773.         0 WPTKKFKPSLLIMDQGCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKTATSVMKHN

gi|156177        60 ARGASSRSSTPSSTASSPTGTTWRRSGTTPSTTSCAWPPRSTRCCSP 107
                 60 .....|...|.|.|....||.||||||.|.||..|.|....|..|.| 107
AI021773.        60 RNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLSC*P 107
""",
        )
        hsp = hit[7]
        self.assertAlmostEqual(hsp.score, 127.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 61.0927)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.06042e-06)
        self.assertEqual(hsp.annotations["identity"], 27)
        self.assertEqual(hsp.annotations["positive"], 35)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('LGQQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF*P')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:164..343)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('LGEQHRVLLGGHAQLVVEGVVPDLLHVVPVGDDAVLDGVLEREDAPLALRLVPHVAVLLP')",
        )
        self.assertEqual(hsp.target.id, "gi|1561775767|ref|XM_027888585.1|")
        self.assertEqual(hsp.target.name, "XM_027888585")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561775767|ref|XM_027888585.1|:268..447)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "LG+Q RV    H Q +VE V+PDLLHV+PV  + V D V + E+    L  +  VAV  P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 LGEQHRVLLGGHAQLVVEGVVPDLLHVVPVGDDAVLDGVLEREDAPLALRLVPHVAVLLP
                  0 ||.|.||....|.|..||.|.||||||.||....|.|.|...|.....|.....|||..|
AI021773.         0 LGQQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF*P

gi|156177        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[8]
        self.assertAlmostEqual(hsp.score, 111.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 53.7613)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.000492871)
        self.assertEqual(hsp.annotations["identity"], 22)
        self.assertEqual(hsp.annotations["positive"], 30)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 50],
                          [ 0, 50]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 50))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('YSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAPLYPK')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(50))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:211..360")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('HPHAQVPHRARHRHQLGRHGEDLAPHLLQRAARGPRGAPGAAHRGPPQPQ')",
        )
        self.assertEqual(hsp.target.id, "gi|1561775767|ref|XM_027888585.1|")
        self.assertEqual(hsp.target.name, "XM_027888585")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561775767|ref|XM_027888585.1|:315..464"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+ H ++P+R R+  +LG HGEDLA H+LQ  A G R  P    R P  P+",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 HPHAQVPHRARHRHQLGRHGEDLAPHLLQRAARGPRGAPGAAHRGPPQPQ 50
                  0 ..|...|.|.|....||.||||||.|.||..|.|.|..|....|.|..|. 50
AI021773.         0 YSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAPLYPK 50
""",
        )
        hsp = hit[9]
        self.assertAlmostEqual(hsp.score, 88.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 43.2225)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.733207)
        self.assertEqual(hsp.annotations["identity"], 20)
        self.assertEqual(hsp.annotations["positive"], 22)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 44],
                          [ 0, 44]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 44))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('FGYNGARSTGQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLG')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(44))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:228..359)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('WG*GGPR*AAPGAPRGPRAARCRRCGARSSPCRPSW*RCRARWG')"
        )
        self.assertEqual(hsp.target.id, "gi|1561775767|ref|XM_027888585.1|")
        self.assertEqual(hsp.target.name, "XM_027888585")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X1, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1599))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561775767|ref|XM_027888585.1|:332..463)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "+G  G R    G    P A  CR C ARSSPC PS  + R R G"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 WG*GGPR*AAPGAPRGPRAARCRRCGARSSPCRPSW*RCRARWG 44
                  0 .|..|.|....|....|.|..||.|.||||||.||....|.|.| 44
AI021773.         0 FGYNGARSTGQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLG 44
""",
        )
        hit = record[9]
        self.assertIsInstance(hit.target, SeqRecord)
        self.assertEqual(hit.target.id, "gi|1561775769|ref|XM_027888595.1|")
        self.assertEqual(hit.target.name, "XM_027888595")
        self.assertEqual(
            hit.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X2, mRNA",
        )
        self.assertEqual(repr(hit.target.seq), "Seq(None, length=1596)")
        self.assertEqual(len(hit), 10)
        hsp = hit[0]
        self.assertAlmostEqual(hsp.score, 325.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 151.818)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.05624e-61)
        self.assertEqual(hsp.annotations["identity"], 59)
        self.assertEqual(hsp.annotations["positive"], 59)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:164..343")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE')",
        )
        self.assertEqual(hsp.target.id, "gi|1561775769|ref|XM_027888595.1|")
        self.assertEqual(hsp.target.name, "XM_027888595")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1596))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561775769|ref|XM_027888595.1|:265..444"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "G KDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 GQKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE
                  0 |.||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
AI021773.         0 GSKDSYVGDEAQSKRGILTLKYPIEHGIVTNWDDMEKIWHHTFYNELRVAPEEHPVLLTE

gi|156177        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[1]
        self.assertAlmostEqual(hsp.score, 174.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 82.6285)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.05624e-61)
        self.assertEqual(hsp.annotations["identity"], 33)
        self.assertEqual(hsp.annotations["positive"], 33)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:66..173")
        self.assertEqual(
            repr(hsp.target.seq), "Seq('GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK')"
        )
        self.assertEqual(hsp.target.id, "gi|1561775769|ref|XM_027888595.1|")
        self.assertEqual(hsp.target.name, "XM_027888595")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1596))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561775769|ref|XM_027888595.1|:166..273"
        )
        self.assertEqual(
            hsp.annotations["midline"], "G  K GFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 GMCKAGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
                  0 |..|.||||||||||||||||||||||||||||||| 36
AI021773.         0 GCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQK 36
""",
        )
        hsp = hit[2]
        self.assertAlmostEqual(hsp.score, 100.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 48.721)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.05624e-61)
        self.assertEqual(hsp.annotations["identity"], 19)
        self.assertEqual(hsp.annotations["positive"], 20)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 21],
                          [ 0, 21]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 21))
        self.assertEqual(repr(hsp.query.seq), "Seq('MADEEVQALVVDNGSGMCKAG')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(21))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:20..82")
        self.assertEqual(repr(hsp.target.seq), "Seq('MADEEIAALVVDNGSGMCKAG')")
        self.assertEqual(hsp.target.id, "gi|1561775769|ref|XM_027888595.1|")
        self.assertEqual(hsp.target.name, "XM_027888595")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1596))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561775769|ref|XM_027888595.1|:121..183"
        )
        self.assertEqual(hsp.annotations["midline"], "MADEE+ ALVVDNGSGMCKAG")
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 MADEEIAALVVDNGSGMCKAG 21
                  0 |||||..|||||||||||||| 21
AI021773.         0 MADEEVQALVVDNGSGMCKAG 21
""",
        )
        hsp = hit[3]
        self.assertAlmostEqual(hsp.score, 225.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 105.997)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.43809e-40)
        self.assertEqual(hsp.annotations["identity"], 46)
        self.assertEqual(hsp.annotations["positive"], 54)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 64],
                          [ 0, 64]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 64))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('IQWSSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCA...FDP')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(64))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:163..354)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('LRGASVSSTGCSSGATRSSL*KVWCQIFSMSSQLVTMPCSMGYLSVRMPLLLCA...FCP')",
        )
        self.assertEqual(hsp.target.id, "gi|1561775769|ref|XM_027888595.1|")
        self.assertEqual(hsp.target.name, "XM_027888595")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1596))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561775769|ref|XM_027888595.1|:264..455)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "++ +SV+ TGCSSGATR+SL* V CQIFSMSSQ VT+PCS+GY SVR+P   CASSPT*LSF P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 LRGASVSSTGCSSGATRSSL*KVWCQIFSMSSQLVTMPCSMGYLSVRMPLLLCASSPT*L
                  0 ....||..|||||||||.|||.|.|||||||||.||.|||.||.|||.|...||||||||
AI021773.         0 IQWSSVNRTGCSSGATRNSL*NV*CQIFSMSSQFVTIPCSIGYFSVRIPRFDCASSPT*L

gi|156177        60 SFCP 64
                 60 ||.| 64
AI021773.        60 SFDP 64
""",
        )
        hsp = hit[4]
        self.assertAlmostEqual(hsp.score, 143.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 68.424)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.43809e-40)
        self.assertEqual(hsp.annotations["identity"], 27)
        self.assertEqual(hsp.annotations["positive"], 30)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 36],
                          [ 0, 36]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 36))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(36))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:65..172)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('FCPMPTMTPWCRGRPTMEGNTARGASSPANPALHMP')"
        )
        self.assertEqual(hsp.target.id, "gi|1561775769|ref|XM_027888595.1|")
        self.assertEqual(hsp.target.name, "XM_027888595")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1596))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561775769|ref|XM_027888595.1|:165..272)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "F P+PT+TP CRGRPTMEGNTA GASSPANP+   P"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 FCPMPTMTPWCRGRPTMEGNTARGASSPANPALHMP 36
                  0 |.|.||.||.||||||||||||.||||||||....| 36
AI021773.         0 F*PIPTITP*CRGRPTMEGNTALGASSPANPSFAHP 36
""",
        )
        hsp = hit[5]
        self.assertAlmostEqual(hsp.score, 79.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 39.0986)
        self.assertAlmostEqual(hsp.annotations["evalue"], 1.43809e-40)
        self.assertEqual(hsp.annotations["identity"], 16)
        self.assertEqual(hsp.annotations["positive"], 19)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 21],
                          [ 0, 21]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 21))
        self.assertEqual(repr(hsp.query.seq), "Seq('PALHIPDPLSTTRA*TSSSAM')")
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(21))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:19..81)"
        )
        self.assertEqual(repr(hsp.target.seq), "Seq('PALHMPEPLSTTRAAISSSAI')")
        self.assertEqual(hsp.target.id, "gi|1561775769|ref|XM_027888595.1|")
        self.assertEqual(hsp.target.name, "XM_027888595")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1596))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561775769|ref|XM_027888595.1|:120..182)",
        )
        self.assertEqual(hsp.annotations["midline"], "PALH+P+PLSTTRA  SSSA+")
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 PALHMPEPLSTTRAAISSSAI 21
                  0 ||||.|.|||||||..||||. 21
AI021773.         0 PALHIPDPLSTTRA*TSSSAM 21
""",
        )
        hsp = hit[6]
        self.assertAlmostEqual(hsp.score, 141.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 67.5076)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.58672e-08)
        self.assertEqual(hsp.annotations["identity"], 35)
        self.assertEqual(hsp.annotations["positive"], 48)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[  0, 107],
                          [  0, 107]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 107))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('WPTKKFKPSLLIMDQGCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKTAT...C*P')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(107))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:21..341")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('WRTRRSLPWWWTTARACARRGSQGMTRPAPCSPPSWGGPGTRASWWAWGRRTAT...CSP')",
        )
        self.assertEqual(hsp.target.id, "gi|1561775769|ref|XM_027888595.1|")
        self.assertEqual(hsp.target.name, "XM_027888595")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1596))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561775769|ref|XM_027888595.1|:122..442"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "W T++  P      + CA+ G  G   P    P   G P  +      G++TAT   +       S  +T S+T    TG TWRRSG T ST +C W  ++T  C P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 WRTRRSLPWWWTTARACARRGSQGMTRPAPCSPPSWGGPGTRASWWAWGRRTATWGTRRR
                  0 |.|....|........||..|..|...|....|...|.|.........|..|||......
AI021773.         0 WPTKKFKPSLLIMDQGCAKLGFAGDDAPRAVFPSIVGRPRHQGVMVGMGQKTATSVMKHN

gi|156177        60 ARGASSRSSTPSSTASSPTGTTWRRSGTTPSTTSCAWPPRSTRCCSP 107
                 60 .....|...|.|.|....||.||||||.|.||..|.|....|..|.| 107
AI021773.        60 RNVVFSH*NTQSNTVL*RTGMTWRRSGITHSTMNCVWLQKNTLSC*P 107
""",
        )
        hsp = hit[7]
        self.assertAlmostEqual(hsp.score, 127.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 61.0927)
        self.assertAlmostEqual(hsp.annotations["evalue"], 3.06042e-06)
        self.assertEqual(hsp.annotations["identity"], 27)
        self.assertEqual(hsp.annotations["positive"], 35)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 60],
                          [ 0, 60]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 60))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('LGQQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF*P')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(60))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:164..343)"
        )
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('LGEQHRVLLGGHAQLVVEGVVPDLLHVVPVGDDAVLDGVLEREDAPLALRLVPHVAVLLP')",
        )
        self.assertEqual(hsp.target.id, "gi|1561775769|ref|XM_027888595.1|")
        self.assertEqual(hsp.target.name, "XM_027888595")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1596))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561775769|ref|XM_027888595.1|:265..444)",
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "LG+Q RV    H Q +VE V+PDLLHV+PV  + V D V + E+    L  +  VAV  P",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 LGEQHRVLLGGHAQLVVEGVVPDLLHVVPVGDDAVLDGVLEREDAPLALRLVPHVAVLLP
                  0 ||.|.||....|.|..||.|.||||||.||....|.|.|...|.....|.....|||..|
AI021773.         0 LGQQDRVFFWSHTQFIVECVMPDLLHVIPVRHNTVFDWVFQCENTTFRLCFITDVAVF*P

gi|156177        60 
                 60 
AI021773.        60 
""",
        )
        hsp = hit[8]
        self.assertAlmostEqual(hsp.score, 111.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 53.7613)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.000492871)
        self.assertEqual(hsp.annotations["identity"], 22)
        self.assertEqual(hsp.annotations["positive"], 30)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 50],
                          [ 0, 50]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 50))
        self.assertEqual(
            repr(hsp.query.seq),
            "Seq('YSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAPLYPK')",
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(50))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(feature.qualifiers["coded_by"], "AI021773.1:211..360")
        self.assertEqual(
            repr(hsp.target.seq),
            "Seq('HPHAQVPHRARHRHQLGRHGEDLAPHLLQRAARGPRGAPGAAHRGPPQPQ')",
        )
        self.assertEqual(hsp.target.id, "gi|1561775769|ref|XM_027888595.1|")
        self.assertEqual(hsp.target.name, "XM_027888595")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1596))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "gi|1561775769|ref|XM_027888595.1|:312..461"
        )
        self.assertEqual(
            hsp.annotations["midline"],
            "+ H ++P+R R+  +LG HGEDLA H+LQ  A G R  P    R P  P+",
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 HPHAQVPHRARHRHQLGRHGEDLAPHLLQRAARGPRGAPGAAHRGPPQPQ 50
                  0 ..|...|.|.|....||.||||||.|.||..|.|.|..|....|.|..|. 50
AI021773.         0 YSHTEIPNRTRYCDELG*HGEDLASHILQ*IACGSRRTPCPVDRAPLYPK 50
""",
        )
        hsp = hit[9]
        self.assertAlmostEqual(hsp.score, 88.0)
        self.assertAlmostEqual(hsp.annotations["bit score"], 43.2225)
        self.assertAlmostEqual(hsp.annotations["evalue"], 0.733207)
        self.assertEqual(hsp.annotations["identity"], 20)
        self.assertEqual(hsp.annotations["positive"], 22)
        self.assertEqual(hsp.annotations["gaps"], 0)
        self.assertTrue(
            np.array_equal(
                hsp.coordinates,
                # fmt: off
                np.array([[ 0, 44],
                          [ 0, 44]])
                # fmt: on
            )
        )
        self.assertEqual(hsp.shape, (2, 44))
        self.assertEqual(
            repr(hsp.query.seq), "Seq('FGYNGARSTGQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLG')"
        )
        self.assertEqual(hsp.query.id, "AI021773.1")
        self.assertEqual(
            hsp.query.description,
            "MAAD0534.RAR Schistosoma mansoni, adult worm (J.C.Parra) Schistosoma mansoni cDNA clone MAAD0534.RAR 5' end similar to S. mansoni actin mRNA, complete cds, mRNA sequence",
        )
        self.assertEqual(len(hsp.query.features), 1)
        feature = hsp.query.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(44))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"], "complement(AI021773.1:228..359)"
        )
        self.assertEqual(
            repr(hsp.target.seq), "Seq('WG*GGPR*AAPGAPRGPRAARCRRCGARSSPCRPSW*RCRARWG')"
        )
        self.assertEqual(hsp.target.id, "gi|1561775769|ref|XM_027888595.1|")
        self.assertEqual(hsp.target.name, "XM_027888595")
        self.assertEqual(
            hsp.target.description,
            "PREDICTED: Empidonax traillii actin, cytoplasmic type 5 (LOC114059764), transcript variant X2, mRNA",
        )
        self.assertEqual(len(hsp.target.features), 1)
        feature = hsp.target.features[0]
        self.assertEqual(
            repr(feature.location),
            "SimpleLocation(ExactPosition(0), ExactPosition(1596))",
        )
        self.assertEqual(feature.type, "CDS")
        self.assertEqual(len(feature.qualifiers), 1)
        self.assertEqual(
            feature.qualifiers["coded_by"],
            "complement(gi|1561775769|ref|XM_027888595.1|:329..460)",
        )
        self.assertEqual(
            hsp.annotations["midline"], "+G  G R    G    P A  CR C ARSSPC PS  + R R G"
        )
        self.assertEqual(
            str(hsp),
            """\
gi|156177         0 WG*GGPR*AAPGAPRGPRAARCRRCGARSSPCRPSW*RCRARWG 44
                  0 .|..|.|....|....|.|..||.|.||||||.||....|.|.| 44
AI021773.         0 FGYNGARSTGQGVLLEPHAIHCRMCDARSSPCHPSSSQYRVRLG 44
""",
        )


class TestBlastErrors(unittest.TestCase):
    """Tests if the Blast XML parser raises the appropriate Exception."""

    def test_not_xml(self):
        """Try to parse a FASTA file."""
        message = "Failed to parse the XML data (syntax error: line 1, column 0). Please make sure that the input data are in XML format."
        filename = "wisteria.nu"
        path = os.path.join("Fasta", filename)
        with open(path, "rb") as stream:
            with self.assertRaises(Blast.NotXMLError) as cm:
                records = Blast.parse(stream)
            self.assertEqual(str(cm.exception), message)
        with self.assertRaises(Blast.NotXMLError) as cm:
            records = Blast.parse(path)
        self.assertEqual(str(cm.exception), message)


if __name__ == "__main__":
    runner = unittest.TextTestRunner(verbosity=2)
    unittest.main(testRunner=runner)
