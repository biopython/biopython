# Copyright 2008 by Peter Cock.  All rights reserved.
# This code is part of the Biopython distribution and governed by its
# license.  Please see the LICENSE file that should have been included
# as part of this package.
"""Tests for Align.stockholm module."""
import unittest

from Bio.Align import stockholm


class TestAlignIO_reading(unittest.TestCase):

    def test_reading_alignments_globins45(self):
        """Test parsing hmmalign output."""
        # File generated by running
        # hmmalign -o globins45.ali globins4.hmm globins45.fa
        # in the HMMER 3.3.2 tutorial
        path = "Stockholm/globins45.ali"
        with open(path) as stream:
            alignments = stockholm.AlignmentIterator(path)
            alignment = next(alignments)
            self.assertRaises(StopIteration, next, alignments)
        self.assertEqual(alignment.sequences[0].id, "MYG_ESCGI")
        self.assertEqual(alignment.sequences[0].seq, "VLSDAEWQLVLNIWAKVEADVAGHGQDILIRLFKGHPETLEKFDKFKHLKTEAEMKASEDLKKHGNTVLTALGGILKKKGHHEAELKPLAQSHATKHKIPIKYLEFISDAIIHVLHSRHPGDFGADAQAAMNKALELFRKDIAAKYKelgfqg")
        self.assertEqual(alignment.sequences[0].letter_annotations['posterior_probability'], "69****************************************************************************99******************************************************************7******")
        self.assertEqual(alignment.sequences[1].id, "MYG_HORSE")
        self.assertEqual(alignment.sequences[1].seq, "gLSDGEWQQVLNVWGKVEADIAGHGQEVLIRLFTGHPETLEKFDKFKHLKTEAEMKASEDLKKHGTVVLTALGGILKKKGHHEAELKPLAQSHATKHKIPIKYLEFISDAIIHVLHSKHPGNFGADAQGAMTKALELFRNDIAAKYKelgfqg")
        self.assertEqual(alignment.sequences[1].letter_annotations['posterior_probability'], "889***************************************************************************99******************************************************************7******")
        self.assertEqual(alignment.sequences[2].id, "MYG_PROGU")
        self.assertEqual(alignment.sequences[2].seq, "gLSDGEWQLVLNVWGKVEGDLSGHGQEVLIRLFKGHPETLEKFDKFKHLKAEDEMRASEELKKHGTTVLTALGGILKKKGQHAAELAPLAQSHATKHKIPVKYLEFISEAIIQVLQSKHPGDFGADAQGAMSKALELFRNDIAAKYKelgfqg")
        self.assertEqual(alignment.sequences[2].letter_annotations['posterior_probability'], "889***************************************************************************99******************************************************************7******")
        self.assertEqual(alignment.sequences[3].id, "MYG_SAISC")
        self.assertEqual(alignment.sequences[3].seq, "gLSDGEWQLVLNIWGKVEADIPSHGQEVLISLFKGHPETLEKFDKFKHLKSEDEMKASEELKKHGTTVLTALGGILKKKGQHEAELKPLAQSHATKHKIPVKYLELISDAIVHVLQKKHPGDFGADAQGAMKKALELFRNDMAAKYKelgfqg")
        self.assertEqual(alignment.sequences[3].letter_annotations['posterior_probability'], "889***************************************************************************99******************************************************************7******")
        self.assertEqual(alignment.sequences[4].id, "MYG_LYCPI")
        self.assertEqual(alignment.sequences[4].seq, "gLSDGEWQIVLNIWGKVETDLAGHGQEVLIRLFKNHPETLDKFDKFKHLKTEDEMKGSEDLKKHGNTVLTALGGILKKKGHHEAELKPLAQSHATKHKIPVKYLEFISDAIIQVLQNKHSGDFHADTEAAMKKALELFRNDIAAKYKelgfqg")
        self.assertEqual(alignment.sequences[4].letter_annotations['posterior_probability'], "889***************************************************************************99******************************************************************7******")
        self.assertEqual(alignment.sequences[5].id, "MYG_MOUSE")
        self.assertEqual(alignment.sequences[5].seq, "gLSDGEWQLVLNVWGKVEADLAGHGQEVLIGLFKTHPETLDKFDKFKNLKSEEDMKGSEDLKKHGCTVLTALGTILKKKGQHAAEIQPLAQSHATKHKIPVKYLEFISEIIIEVLKKRHSGDFGADAQGAMSKALELFRNDIAAKYKelgfqg")
        self.assertEqual(alignment.sequences[5].letter_annotations['posterior_probability'], "889***************************************************************************99******************************************************************7******")
        self.assertEqual(alignment.sequences[6].id, "MYG_MUSAN")
        self.assertEqual(alignment.sequences[6].seq, "vDWEKVNSVWSAVESDLTAIGQNILLRLFEQYPESQNHFPKFKNKSLGELKDTADIKAQADTVLSALGNIVKKKGSHSQPVKALAATHITTHKIPPHYFTKITTIAVDVLSEMYPSEMNAQVQAAFSGAFKIICSDIEKEYKaanfqg")
        self.assertEqual(alignment.sequences[6].letter_annotations['posterior_probability'], "789***************************************987789*************************99****************************************************************997******")
        self.assertEqual(alignment.sequences[7].id, "HBA_AILME")
        self.assertEqual(alignment.sequences[7].seq, "VLSPADKTNVKATWDKIGGHAGEYGGEALERTFASFPTTKTYFPHFDLSPGSAQVKAHGKKVADALTTAVGHLDDLPGALSALSDLHAHKLRVDPVNFKLLSHCLLVTLASHHPAEFTPAVHASLDKFFSAVSTVLTSKYR")
        self.assertEqual(alignment.sequences[7].letter_annotations['posterior_probability'], "69********************************************9**9***********************9******************************************************************7")
        self.assertEqual(alignment.sequences[8].id, "HBA_PROLO")
        self.assertEqual(alignment.sequences[8].seq, "VLSPADKANIKATWDKIGGHAGEYGGEALERTFASFPTTKTYFPHFDLSPGSAQVKAHGKKVADALTLAVGHLDDLPGALSALSDLHAYKLRVDPVNFKLLSHCLLVTLACHHPAEFTPAVHASLDKFFTSVSTVLTSKYR")
        self.assertEqual(alignment.sequences[8].letter_annotations['posterior_probability'], "69********************************************9**9***********************9******************************************************************7")
        self.assertEqual(alignment.sequences[9].id, "HBA_PAGLA")
        self.assertEqual(alignment.sequences[9].seq, "VLSSADKNNIKATWDKIGSHAGEYGAEALERTFISFPTTKTYFPHFDLSHGSAQVKAHGKKVADALTLAVGHLEDLPNALSALSDLHAYKLRVDPVNFKLLSHCLLVTLACHHPAEFTPAVHSALDKFFSAVSTVLTSKYR")
        self.assertEqual(alignment.sequences[9].letter_annotations['posterior_probability'], "69**********************************************************************989*****************************************************************7")
        self.assertEqual(alignment.sequences[10].id, "HBA_MACFA")
        self.assertEqual(alignment.sequences[10].seq, "VLSPADKTNVKAAWGKVGGHAGEYGAEALERMFLSFPTTKTYFPHFDLSHGSAQVKGHGKKVADALTLAVGHVDDMPQALSALSDLHAHKLRVDPVNFKLLSHCLLVTLAAHLPAEFTPAVHASLDKFLASVSTVLTSKYR")
        self.assertEqual(alignment.sequences[10].letter_annotations['posterior_probability'], "69***********************************************************************9******************************************************************7")
        self.assertEqual(alignment.sequences[11].id, "HBA_MACSI")
        self.assertEqual(alignment.sequences[11].seq, "VLSPADKTNVKDAWGKVGGHAGEYGAEALERMFLSFPTTKTYFPHFDLSHGSAQVKGHGKKVADALTLAVGHVDDMPQALSALSDLHAHKLRVDPVNFKLLSHCLLVTLAAHLPAEFTPAVHASLDKFLASVSTVLTSKYR")
        self.assertEqual(alignment.sequences[11].letter_annotations['posterior_probability'], "69***********************************************************************9******************************************************************7")
        self.assertEqual(alignment.sequences[12].id, "HBA_PONPY")
        self.assertEqual(alignment.sequences[12].seq, "VLSPADKTNVKTAWGKVGAHAGDYGAEALERMFLSFPTTKTYFPHFDLSHGSAQVKDHGKKVADALTNAVAHVDDMPNALSALSDLHAHKLRVDPVNFKLLSHCLLVTLAAHLPAEFTPAVHASLDKFLASVSTVLTSKYR")
        self.assertEqual(alignment.sequences[12].letter_annotations['posterior_probability'], "69***********************************************************************9******************************************************************7")
        self.assertEqual(alignment.sequences[13].id, "HBA2_GALCR")
        self.assertEqual(alignment.sequences[13].seq, "VLSPTDKSNVKAAWEKVGAHAGDYGAEALERMFLSFPTTKTYFPHFDLSHGSTQVKGHGKKVADALTNAVLHVDDMPSALSALSDLHAHKLRVDPVNFKLLRHCLLVTLACHHPAEFTPAVHASLDKFMASVSTVLTSKYR")
        self.assertEqual(alignment.sequences[13].letter_annotations['posterior_probability'], "69***********************************************************************9******************************************************************7")
        self.assertEqual(alignment.sequences[14].id, "HBA_MESAU")
        self.assertEqual(alignment.sequences[14].seq, "VLSAKDKTNISEAWGKIGGHAGEYGAEALERMFFVYPTTKTYFPHFDVSHGSAQVKGHGKKVADALTNAVGHLDDLPGALSALSDLHAHKLRVDPVNFKLLSHCLLVTLANHHPADFTPAVHASLDKFFASVSTVLTSKYR")
        self.assertEqual(alignment.sequences[14].letter_annotations['posterior_probability'], "69********************************************888************************9******************************************************************7")
        self.assertEqual(alignment.sequences[15].id, "HBA2_BOSMU")
        self.assertEqual(alignment.sequences[15].seq, "VLSAADKGNVKAAWGKVGGHAAEYGAEALERMFLSFPTTKTYFPHFDLSHGSAQVKGHGAKVAAALTKAVGHLDDLPGALSELSDLHAHKLRVDPVNFKLLSHSLLVTLASHLPSDFTPAVHASLDKFLANVSTVLTSKYR")
        self.assertEqual(alignment.sequences[15].letter_annotations['posterior_probability'], "69***********************************************************************9******************************************************************7")
        self.assertEqual(alignment.sequences[16].id, "HBA_ERIEU")
        self.assertEqual(alignment.sequences[16].seq, "VLSATDKANVKTFWGKLGGHGGEYGGEALDRMFQAHPTTKTYFPHFDLNPGSAQVKGHGKKVADALTTAVNNLDDVPGALSALSDLHAHKLRVDPVNFKLLSHCLLVTLALHHPADFTPAVHASLDKFLATVATVLTSKYR")
        self.assertEqual(alignment.sequences[16].letter_annotations['posterior_probability'], "69********************************************9999***********************99*****************************************************************7")
        self.assertEqual(alignment.sequences[17].id, "HBA_FRAPO")
        self.assertEqual(alignment.sequences[17].seq, "VLSAADKNNVKGIFGKISSHAEDYGAEALERMFITYPSTKTYFPHFDLSHGSAQVKGHGKKVVAALIEAANHIDDIAGTLSKLSDLHAHKLRVDPVNFKLLGQCFLVVVAIHHPSALTPEVHASLDKFLCAVGNVLTAKYR")
        self.assertEqual(alignment.sequences[17].letter_annotations['posterior_probability'], "69***********************************************************************99*****************************************************************7")
        self.assertEqual(alignment.sequences[18].id, "HBA_PHACO")
        self.assertEqual(alignment.sequences[18].seq, "VLSAADKNNVKGIFTKIAGHAEEYGAEALERMFITYPSTKTYFPHFDLSHGSAQIKGHGKKVVAALIEAVNHIDDITGTLSKLSDLHAHKLRVDPVNFKLLGQCFLVVVAIHHPSALTPEVHASLDKFLCAVGTVLTAKYR")
        self.assertEqual(alignment.sequences[18].letter_annotations['posterior_probability'], "69***********************************************************************99*****************************************************************7")
        self.assertEqual(alignment.sequences[19].id, "HBA_TRIOC")
        self.assertEqual(alignment.sequences[19].seq, "VLSANDKTNVKTVFTKITGHAEDYGAETLERMFITYPPTKTYFPHFDLHHGSAQIKAHGKKVVGALIEAVNHIDDIAGALSKLSDLHAQKLRVDPVNFKLLGQCFLVVVAIHHPSVLTPEVHASLDKFLCAVGNVLSAKYR")
        self.assertEqual(alignment.sequences[19].letter_annotations['posterior_probability'], "69********************************************999************************99*****************************************************************7")
        self.assertEqual(alignment.sequences[20].id, "HBA_ANSSE")
        self.assertEqual(alignment.sequences[20].seq, "VLSAADKGNVKTVFGKIGGHAEEYGAETLQRMFQTFPQTKTYFPHFDLQPGSAQIKAHGKKVAAALVEAANHIDDIAGALSKLSDLHAQKLRVDPVNFKFLGHCFLVVLAIHHPSLLTPEVHASMDKFLCAVATVLTAKYR")
        self.assertEqual(alignment.sequences[20].letter_annotations['posterior_probability'], "69********************************************9999***********************99*****************************************************************7")
        self.assertEqual(alignment.sequences[21].id, "HBA_COLLI")
        self.assertEqual(alignment.sequences[21].seq, "VLSANDKSNVKAVFAKIGGQAGDLGGEALERLFITYPQTKTYFPHFDLSHGSAQIKGHGKKVAEALVEAANHIDDIAGALSKLSDLHAQKLRVDPVNFKLLGHCFLVVVAVHFPSLLTPEVHASLDKFVLAVGTVLTAKYR")
        self.assertEqual(alignment.sequences[21].letter_annotations['posterior_probability'], "69***********************************************************************99*****************************************************************7")
        self.assertEqual(alignment.sequences[22].id, "HBAD_CHLME")
        self.assertEqual(alignment.sequences[22].seq, "mLTADDKKLLTQLWEKVAGHQEEFGSEALQRMFLTYPQTKTYFPHFDLHPGSEQVRGHGKKVAAALGNAVKSLDNLSQALSELSNLHAYNLRVDPANFKLLAQCFQVVLATHLGKDYSPEMHAAFDKFLSAVAAVLAEKYR")
        self.assertEqual(alignment.sequences[22].letter_annotations['posterior_probability'], "689*******************************************9999******************************************************************************************7")
        self.assertEqual(alignment.sequences[23].id, "HBAD_PASMO")
        self.assertEqual(alignment.sequences[23].seq, "mLTAEDKKLIQQIWGKLGGAEEEIGADALWRMFHSYPSTKTYFPHFDLSQGSDQIRGHGKKVVAALSNAIKNLDNLSQALSELSNLHAYNLRVDPVNFKFLSQCLQVSLATRLGKEYSPEVHSAVDKFMSAVASVLAEKYR")
        self.assertEqual(alignment.sequences[23].letter_annotations['posterior_probability'], "699*******************************************9**9******************************************************************************************7")
        self.assertEqual(alignment.sequences[24].id, "HBAZ_HORSE")
        self.assertEqual(alignment.sequences[24].seq, "sLTKAERTMVVSIWGKISMQADAVGTEALQRLFSSYPQTKTYFPHFDLHEGSPQLRAHGSKVAAAVGDAVKSIDNVAGALAKLSELHAYILRVDPVNFKFLSHCLLVTLASRLPADFTADAHAAWDKFLSIVSSVLTEKYR")
        self.assertEqual(alignment.sequences[24].letter_annotations['posterior_probability'], "689*******************************************9999******************************************************************************************7")
        self.assertEqual(alignment.sequences[25].id, "HBA4_SALIR")
        self.assertEqual(alignment.sequences[25].seq, "sLSAKDKANVKAIWGKILPKSDEIGEQALSRMLVVYPQTKAYFSHWASVAPGSAPVKKHGITIMNQIDDCVGHMDDLFGFLTKLSELHATKLRVDPTNFKILAHNLIVVIAAYFPAEFTPEIHLSVDKFLQQLALALAEKYR")
        self.assertEqual(alignment.sequences[25].letter_annotations['posterior_probability'], "69********************************************77769************************9*****************************************************************7")
        self.assertEqual(alignment.sequences[26].id, "HBB_ORNAN")
        self.assertEqual(alignment.sequences[26].seq, "VHLSGGEKSAVTNLWGKVNINELGGEALGRLLVVYPWTQRFFEAFGDLSSAGAVMGNPKVKAHGAKVLTSFGDALKNLDDLKGTFAKLSELHCDKLHVDPENFNRLGNVLIVVLARHFSKDFSPEVQAAWQKLVSGVAHALGHKYH")
        self.assertEqual(alignment.sequences[26].letter_annotations['posterior_probability'], "69****************************************************************************9******************************************************************7")
        self.assertEqual(alignment.sequences[27].id, "HBB_TACAC")
        self.assertEqual(alignment.sequences[27].seq, "VHLSGSEKTAVTNLWGHVNVNELGGEALGRLLVVYPWTQRFFESFGDLSSADAVMGNAKVKAHGAKVLTSFGDALKNLDNLKGTFAKLSELHCDKLHVDPENFNRLGNVLVVVLARHFSKEFTPEAQAAWQKLVSGVSHALAHKYH")
        self.assertEqual(alignment.sequences[27].letter_annotations['posterior_probability'], "69***********************************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[28].id, "HBE_PONPY")
        self.assertEqual(alignment.sequences[28].seq, "VHFTAEEKAAVTSLWSKMNVEEAGGEALGRLLVVYPWTQRFFDSFGNLSSPSAILGNPKVKAHGKKVLTSFGDAIKNMDNLKTTFAKLSELHCDKLHVDPENFKLLGNVMVIILATHFGKEFTPEVQAAWQKLVSAVAIALAHKYH")
        self.assertEqual(alignment.sequences[28].letter_annotations['posterior_probability'], "5789*********************************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[29].id, "HBB_SPECI")
        self.assertEqual(alignment.sequences[29].seq, "VHLSDGEKNAISTAWGKVHAAEVGAEALGRLLVVYPWTQRFFDSFGDLSSASAVMGNAKVKAHGKKVIDSFSNGLKHLDNLKGTFASLSELHCDKLHVDPENFKLLGNMIVIVMAHHLGKDFTPEAQAAFQKVVAGVANALAHKYH")
        self.assertEqual(alignment.sequences[29].letter_annotations['posterior_probability'], "69****************99*****************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[30].id, "HBB_SPETO")
        self.assertEqual(alignment.sequences[30].seq, "VHLTDGEKNAISTAWGKVNAAEIGAEALGRLLVVYPWTQRFFDSFGDLSSASAVMGNAKVKAHGKKVIDSFSNGLKHLDNLKGTFASLSELHCDKLHVDPENFKLLGNMIVIVMAHHLGKDFTPEAQAAFQKVVAGVANALSHKYH")
        self.assertEqual(alignment.sequences[30].letter_annotations['posterior_probability'], "69****************99*****************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[31].id, "HBB_EQUHE")
        self.assertEqual(alignment.sequences[31].seq, "vQLSGEEKAAVLALWDKVNEEEVGGEALGRLLVVYPWTQRFFDSFGDLSNPAAVMGNPKVKAHGKKVLHSFGEGVHHLDNLKGTFAQLSELHCDKLHVDPENFRLLGNVLVVVLARHFGKDFTPELQASYQKVVAGVANALAHKYH")
        self.assertEqual(alignment.sequences[31].letter_annotations['posterior_probability'], "579***************99*****************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[32].id, "HBB_SUNMU")
        self.assertEqual(alignment.sequences[32].seq, "VHLSGEEKACVTGLWGKVNEDEVGAEALGRLLVVYPWTQRFFDSFGDLSSASAVMGNPKVKAHGKKVLHSLGEGVANLDNLKGTFAKLSELHCDKLHVDPENFRLLGNVLVVVLASKFGKEFTPPVQAAFQKVVAGVANALAHKYH")
        self.assertEqual(alignment.sequences[32].letter_annotations['posterior_probability'], "69****************99*****************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[33].id, "HBB_CALAR")
        self.assertEqual(alignment.sequences[33].seq, "VHLTGEEKSAVTALWGKVNVDEVGGEALGRLLVVYPWTQRFFESFGDLSTPDAVMNNPKVKAHGKKVLGAFSDGLTHLDNLKGTFAHLSELHCDKLHVDPENFRLLGNVLVCVLAHHFGKEFTPVVQAAYQKVVAGVANALAHKYH")
        self.assertEqual(alignment.sequences[33].letter_annotations['posterior_probability'], "689**********************************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[34].id, "HBB_MANSP")
        self.assertEqual(alignment.sequences[34].seq, "VHLTPEEKTAVTTLWGKVNVDEVGGEALGRLLVVYPWTQRFFDSFGDLSSPDAVMGNPKVKAHGKKVLGAFSDGLNHLDNLKGTFAQLSELHCDKLHVDPENFKLLGNVLVCVLAHHFGKEFTPQVQAAYQKVVAGVANALAHKYH")
        self.assertEqual(alignment.sequences[34].letter_annotations['posterior_probability'], "69***********************************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[35].id, "HBB_URSMA")
        self.assertEqual(alignment.sequences[35].seq, "VHLTGEEKSLVTGLWGKVNVDEVGGEALGRLLVVYPWTQRFFDSFGDLSSADAIMNNPKVKAHGKKVLNSFSDGLKNLDNLKGTFAKLSELHCDKLHVDPENFKLLGNVLVCVLAHHFGKEFTPQVQAAYQKVVAGVANALAHKYH")
        self.assertEqual(alignment.sequences[35].letter_annotations['posterior_probability'], "689**********************************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[36].id, "HBB_RABIT")
        self.assertEqual(alignment.sequences[36].seq, "VHLSSEEKSAVTALWGKVNVEEVGGEALGRLLVVYPWTQRFFESFGDLSSANAVMNNPKVKAHGKKVLAAFSEGLSHLDNLKGTFAKLSELHCDKLHVDPENFRLLGNVLVIVLSHHFGKEFTPQVQAAYQKVVAGVANALAHKYH")
        self.assertEqual(alignment.sequences[36].letter_annotations['posterior_probability'], "69***********************************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[37].id, "HBB_TUPGL")
        self.assertEqual(alignment.sequences[37].seq, "VHLSGEEKAAVTGLWGKVDLEKVGGQSLGSLLIVYPWTQRFFDSFGDLSSPSAVMSNPKVKAHGKKVLTSFSDGLNHLDNLKGTFAKLSELHCDKLHVDPENFRLLGNVLVRVLACNFGPEFTPQVQAAFQKVVAGVANALAHKYH")
        self.assertEqual(alignment.sequences[37].letter_annotations['posterior_probability'], "69***********************************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[38].id, "HBB_TRIIN")
        self.assertEqual(alignment.sequences[38].seq, "VHLTPEEKALVIGLWAKVNVKEYGGEALGRLLVVYPWTQRFFEHFGDLSSASAIMNNPKVKAHGEKVFTSFGDGLKHLEDLKGAFAELSELHCDKLHVDPENFRLLGNVLVCVLARHFGKEFSPEAQAAYQKVVAGVANALAHKYH")
        self.assertEqual(alignment.sequences[38].letter_annotations['posterior_probability'], "69***************************************************************************989*****************************************************************7")
        self.assertEqual(alignment.sequences[39].id, "HBB_COLLI")
        self.assertEqual(alignment.sequences[39].seq, "vHWSAEEKQLITSIWGKVNVADCGAEALARLLIVYPWTQRFFSSFGNLSSATAISGNPNVKAHGKKVLTSFGDAVKNLDNIKGTFAQLSELHCDKLHVDPENFRLLGDILVIILAAHFGKDFTPECQAAWQKLVRVVAHALARKYH")
        self.assertEqual(alignment.sequences[39].letter_annotations['posterior_probability'], "5779*********************************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[40].id, "HBB_LARRI")
        self.assertEqual(alignment.sequences[40].seq, "vHWSAEEKQLITGLWGKVNVADCGAEALARLLIVYPWTQRFFASFGNLSSPTAINGNPMVRAHGKKVLTSFGEAVKNLDNIKNTFAQLSELHCDKLHVDPENFRLLGDILIIVLAAHFAKDFTPDSQAAWQKLVRVVAHALARKYH")
        self.assertEqual(alignment.sequences[40].letter_annotations['posterior_probability'], "5779*********************************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[41].id, "HBB1_VAREX")
        self.assertEqual(alignment.sequences[41].seq, "vHWTAEEKQLICSLWGKIDVGLIGGETLAGLLVIYPWTQRQFSHFGNLSSPTAIAGNPRVKAHGKKVLTSFGDAIKNLDNIKDTFAKLSELHCDKLHVDPTNFKLLGNVLVIVLADHHGKEFTPAHHAAYQKLVNVVSHSLARRYH")
        self.assertEqual(alignment.sequences[41].letter_annotations['posterior_probability'], "66799********************************************************************************************************************************************7")
        self.assertEqual(alignment.sequences[42].id, "HBB2_XENTR")
        self.assertEqual(alignment.sequences[42].seq, "vHWTAEEKATIASVWGKVDIEQDGHDALSRLLVVYPWTQRYFSSFGNLSNVSAVSGNVKVKAHGNKVLSAVGSAIQHLDDVKSHLKGLSKSHAEDLHVDPENFKRLADVLVIVLAAKLGSAFTPQVQAVWEKLNATLVAALSHGYf")
        self.assertEqual(alignment.sequences[42].letter_annotations['posterior_probability'], "66799*************************************************************************99*************************************************************99889")
        self.assertEqual(alignment.sequences[43].id, "HBBL_RANCA")
        self.assertEqual(alignment.sequences[43].seq, "vHWTAEEKAVINSVWQKVDVEQDGHEALTRLFIVYPWTQRYFSTFGDLSSPAAIAGNPKVHAHGKKILGAIDNAIHNLDDVKGTLHDLSEEHANELHVDPENFRRLGEVLIVVLGAKLGKAFSPQVQHVWEKFIAVLVDALSHSYH")
        self.assertEqual(alignment.sequences[43].letter_annotations['posterior_probability'], "66799*************************************************************************99*****************************************************************7")
        self.assertEqual(alignment.sequences[44].id, "HBB2_TRICR")
        self.assertEqual(alignment.sequences[44].seq, "VHLTAEDRKEIAAILGKVNVDSLGGQCLARLIVVNPWSRRYFHDFGDLSSCDAICRNPKVLAHGAKVMRSIVEATKHLDNLREYYADLSVTHSLKFYVDPENFKLFSGIVIVCLALTLQTDFSCHKQLAFEKLMKGVSHALGHGY")
        self.assertEqual(alignment.sequences[44].letter_annotations['posterior_probability'], "69*******************************************************************************************************************************************9988")
        self.assertEqual(alignment.column_annotations["reference_coordinate_annotation"], ".xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx......")
        self.assertEqual(alignment.column_annotations["consensus_posterior_probability"], ".679*****************************************************************************99******************************************************************7......")


if __name__ == "__main__":
    runner = unittest.TextTestRunner(verbosity=2)
    unittest.main(testRunner=runner)
